{"version":3,"file":"amll-core.js","sources":["../src/bg-render/base.ts","../../../node_modules/.pnpm/gl-matrix@4.0.0-beta.2/node_modules/gl-matrix/dist/esm/common.js","../../../node_modules/.pnpm/gl-matrix@4.0.0-beta.2/node_modules/gl-matrix/dist/esm/mat4.js","../../../node_modules/.pnpm/gl-matrix@4.0.0-beta.2/node_modules/gl-matrix/dist/esm/vec3.js","../../../node_modules/.pnpm/gl-matrix@4.0.0-beta.2/node_modules/gl-matrix/dist/esm/vec4.js","../../../node_modules/.pnpm/gl-matrix@4.0.0-beta.2/node_modules/gl-matrix/dist/esm/vec2.js","../src/utils/resource.ts","../src/bg-render/img.ts","../src/bg-render/mesh-renderer/cp-presets.ts","../src/bg-render/mesh-renderer/cp-generate.ts","../src/bg-render/mesh-renderer/mesh.frag.glsl?raw","../src/bg-render/mesh-renderer/mesh.vert.glsl?raw","../src/bg-render/mesh-renderer/index.ts","../src/bg-render/pixi-renderer.ts","../src/bg-render/index.ts","../../../node_modules/.pnpm/@ungap+structured-clone@1.3.0/node_modules/@ungap/structured-clone/esm/types.js","../../../node_modules/.pnpm/@ungap+structured-clone@1.3.0/node_modules/@ungap/structured-clone/esm/deserialize.js","../../../node_modules/.pnpm/@ungap+structured-clone@1.3.0/node_modules/@ungap/structured-clone/esm/serialize.js","../../../node_modules/.pnpm/@ungap+structured-clone@1.3.0/node_modules/@ungap/structured-clone/esm/index.js","../src/utils/eq-set.ts","../src/utils/is-cjk.ts","../src/utils/derivative.ts","../src/utils/spring.ts","../src/utils/schedule.ts","../src/lyric-player/bottom-line.ts","../src/lyric-player/dom/interlude-dots.ts","../src/lyric-player/base.ts","../../../node_modules/.pnpm/bezier-easing@2.1.0/node_modules/bezier-easing/src/index.js","../src/utils/lyric-split-words.ts","../src/utils/matrix.ts","../src/lyric-player/dom/lyric-line.ts","../src/lyric-player/dom/index.ts","../src/lyric-player/canvas/text-layout.ts","../src/lyric-player/canvas/lyric-line.ts","../src/lyric-player/canvas/index.ts","../src/utils/debounce.ts","../src/utils/mutex.ts","../src/lyric-player/dom-slim/lyric-line.ts","../src/lyric-player/dom-slim/index.ts"],"sourcesContent":["import type { Disposable, HasElement } from \"../interfaces.ts\";\n\nexport abstract class AbstractBaseRenderer implements Disposable, HasElement {\n\t/**\n\t * 修改背景的流动速度，数字越大越快，默认为 8\n\t * @param speed 背景的流动速度，默认为 8\n\t */\n\tabstract setFlowSpeed(speed: number): void;\n\t/**\n\t * 修改背景的渲染比例，默认是 0.5\n\t *\n\t * 一般情况下这个程度既没有明显瑕疵也不会特别吃性能\n\t * @param scale 背景的渲染比例\n\t */\n\tabstract setRenderScale(scale: number): void;\n\t/**\n\t * 是否启用静态模式，即图片在更换后就会保持静止状态并禁用更新，以节省性能\n\t * @param enable 是否启用静态模式\n\t */\n\tabstract setStaticMode(enable: boolean): void;\n\t/**\n\t * 修改背景动画帧率，默认是 30 FPS\n\t *\n\t * 如果设置成 0 则会停止动画\n\t * @param fps 目标帧率，默认 30 FPS\n\t */\n\tabstract setFPS(fps: number): void;\n\t/**\n\t * 暂停背景动画，画面即便是更新了图片也不会发生变化\n\t */\n\tabstract pause(): void;\n\t/**\n\t * 恢复播放背景动画\n\t */\n\tabstract resume(): void;\n\t/**\n\t * 设置背景专辑资源，纹理加载并设置完成后会返回\n\t * @param albumSource 专辑的资源链接，可以是图片或视频链接，抑或是任意 img/video 元素，如果提供字符串链接且为视频则需要指定第二个参数\n\t */\n\tabstract setAlbum(\n\t\talbumSource: string | HTMLImageElement | HTMLVideoElement,\n\t\tisVideo?: boolean,\n\t): Promise<void>;\n\t/**\n\t * 设置低频的音量大小，范围在 80hz-120hz 之间为宜，取值范围在 [0.0-1.0] 之间\n\t *\n\t * 部分渲染器会根据音量大小调整背景效果（例如根据鼓点跳动）\n\t *\n\t * 如果无法获取到类似的数据，请传入 1.0 作为默认值，或不做任何处理（默认值即 1.0）\n\t * @param volume 低频的音量大小，范围在 50hz-120hz 之间为宜，取值范围在 [0.0-1.0] 之间\n\t */\n\tabstract setLowFreqVolume(volume: number): void;\n\t/**\n\t * 设置背景是否根据“是否有歌词”这个特征调整自身效果，例如有歌词时会变得更加活跃\n\t *\n\t * 部分渲染器会根据这个特征调整自身效果\n\t *\n\t * 如果不确定是否需要赋值或无法知晓是否包含歌词，请传入 true 或不做任何处理（默认值为 true）\n\t *\n\t * @param hasLyric 是否有歌词，如不确定是否需要赋值，请传入 true 或不做任何处理（默认值为 true）\n\t */\n\tabstract setHasLyric(hasLyric: boolean): void;\n\tabstract dispose(): void;\n\tabstract getElement(): HTMLElement;\n}\n\nexport abstract class BaseRenderer extends AbstractBaseRenderer {\n\tprivate observer: ResizeObserver;\n\tprotected flowSpeed = 4;\n\tprotected currerntRenderScale = 0.75;\n\tconstructor(protected canvas: HTMLCanvasElement) {\n\t\tsuper();\n\t\tthis.observer = new ResizeObserver(() => {\n\t\t\tconst width = Math.max(\n\t\t\t\t1,\n\t\t\t\tcanvas.clientWidth * window.devicePixelRatio * this.currerntRenderScale,\n\t\t\t);\n\t\t\tconst height = Math.max(\n\t\t\t\t1,\n\t\t\t\tcanvas.clientHeight *\n\t\t\t\t\twindow.devicePixelRatio *\n\t\t\t\t\tthis.currerntRenderScale,\n\t\t\t);\n\t\t\tthis.onResize(width, height);\n\t\t});\n\t\tthis.observer.observe(canvas);\n\t}\n\tsetRenderScale(scale: number) {\n\t\tthis.currerntRenderScale = scale;\n\t\tthis.onResize(\n\t\t\tthis.canvas.clientWidth *\n\t\t\t\twindow.devicePixelRatio *\n\t\t\t\tthis.currerntRenderScale,\n\t\t\tthis.canvas.clientHeight *\n\t\t\t\twindow.devicePixelRatio *\n\t\t\t\tthis.currerntRenderScale,\n\t\t);\n\t}\n\t/**\n\t * 当画板元素大小发生变化时此函数会被调用\n\t * 可以在此处重设和渲染器相关的尺寸设置\n\t * 考虑到初始化的时候元素不一定在文档中或出于某些特殊样式状态，尺寸长宽有可能会为 0，请注意进行特判处理\n\t * @param width 画板元素实际的物理像素宽度，有可能为 0\n\t * @param height 画板元素实际的物理像素高度，有可能为 0\n\t */\n\tprotected onResize(width: number, height: number): void {\n\t\tthis.canvas.width = width;\n\t\tthis.canvas.height = height;\n\t}\n\t/**\n\t * 修改背景的流动速度，数字越大越快，默认为 4\n\t * @param speed 背景的流动速度，默认为 4\n\t */\n\tsetFlowSpeed(speed: number) {\n\t\tthis.flowSpeed = speed;\n\t}\n\t/**\n\t * 是否启用静态模式，即图片在更换后就会保持静止状态并禁用更新，以节省性能\n\t * @param enable 是否启用静态模式\n\t */\n\tabstract override setStaticMode(enable: boolean): void;\n\t/**\n\t * 修改背景动画帧率，默认是 30 FPS\n\t *\n\t * 如果设置成 0 则会停止动画\n\t * @param fps 目标帧率，默认 30 FPS\n\t */\n\tabstract override setFPS(fps: number): void;\n\t/**\n\t * 暂停背景动画，画面即便是更新了图片也不会发生变化\n\t */\n\tabstract override pause(): void;\n\t/**\n\t * 恢复播放背景动画\n\t */\n\tabstract override resume(): void;\n\t/**\n\t * 设置背景专辑资源，纹理加载并设置完成后会返回\n\t * @param albumSource 专辑的资源链接，可以是图片或视频链接，抑或是任意 img/video 元素，如果提供字符串链接且为视频则需要指定第二个参数\n\t */\n\tabstract override setAlbum(\n\t\talbumSource: string | HTMLImageElement | HTMLVideoElement,\n\t\tisVideo?: boolean,\n\t): Promise<void>;\n\tdispose(): void {\n\t\tthis.observer.disconnect();\n\t\tthis.canvas.remove();\n\t}\n\toverride getElement(): HTMLElement {\n\t\treturn this.canvas;\n\t}\n}\n","export const EPSILON = 0.000001;\nexport const ANGLE_ORDER = \"zyx\";\nconst DEG_TO_RAD = Math.PI / 180;\nconst RAD_TO_DEG = 180 / Math.PI;\n/**\n * Convert Degrees To Radians\n *\n * @param value - Angle in Degrees\n * @returns Angle in Radians\n */\nexport function toRadian(value) {\n    return value * DEG_TO_RAD;\n}\n/**\n * Convert Radians To Degrees\n *\n * @param value - Angle in Radians\n * @returns Angle in Degrees\n */\nexport function toDegree(value) {\n    return value * RAD_TO_DEG;\n}\n//# sourceMappingURL=common.js.map","import { EPSILON } from './common.js';\nconst IDENTITY_4X4 = new Float32Array([\n    1, 0, 0, 0,\n    0, 1, 0, 0,\n    0, 0, 1, 0,\n    0, 0, 0, 1,\n]);\n/**\n * A 4x4 Matrix\n */\nclass Mat4 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Mat4}.\n     */\n    static BYTE_LENGTH = 16 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Mat4}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 16:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 16);\n                break;\n            case 1:\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([\n                        v, v, v, v,\n                        v, v, v, v,\n                        v, v, v, v,\n                        v, v, v, v\n                    ]);\n                }\n                else {\n                    super(v, 0, 16);\n                }\n                break;\n            default:\n                super(IDENTITY_4X4);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    /**\n     * A string representation of `this`\n     * Equivalent to `Mat4.str(this);`\n     */\n    get str() {\n        return Mat4.str(this);\n    }\n    //===================\n    // Instance methods\n    //===================\n    /**\n     * Copy the values from another {@link Mat4} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Set `this` to the identity matrix\n     * Equivalent to Mat4.identity(this)\n     *\n     * @returns `this`\n     */\n    identity() {\n        this.set(IDENTITY_4X4);\n        return this;\n    }\n    /**\n     * Multiplies this {@link Mat4} against another one\n     * Equivalent to `Mat4.multiply(this, this, b);`\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `this`\n     */\n    multiply(b) {\n        return Mat4.multiply(this, this, b);\n    }\n    /**\n     * Alias for {@link Mat4.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Transpose this {@link Mat4}\n     * Equivalent to `Mat4.transpose(this, this);`\n     *\n     * @returns `this`\n     */\n    transpose() {\n        return Mat4.transpose(this, this);\n    }\n    /**\n     * Inverts this {@link Mat4}\n     * Equivalent to `Mat4.invert(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        return Mat4.invert(this, this);\n    }\n    /**\n     * Translate this {@link Mat4} by the given vector\n     * Equivalent to `Mat4.translate(this, this, v);`\n     *\n     * @param v - The {@link Vec3} to translate by\n     * @returns `this`\n     */\n    translate(v) {\n        return Mat4.translate(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the given axis\n     * Equivalent to `Mat4.rotate(this, this, rad, axis);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @param axis - the axis to rotate around\n     * @returns `out`\n     */\n    rotate(rad, axis) {\n        return Mat4.rotate(this, this, rad, axis);\n    }\n    /**\n     * Scales this {@link Mat4} by the dimensions in the given vec3 not using vectorization\n     * Equivalent to `Mat4.scale(this, this, v);`\n     *\n     * @param v - The {@link Vec3} to scale the matrix by\n     * @returns `this`\n     */\n    scale(v) {\n        return Mat4.scale(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the X axis\n     * Equivalent to `Mat4.rotateX(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `this`\n     */\n    rotateX(rad) {\n        return Mat4.rotateX(this, this, rad);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the Y axis\n     * Equivalent to `Mat4.rotateY(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `this`\n     */\n    rotateY(rad) {\n        return Mat4.rotateY(this, this, rad);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the Z axis\n     * Equivalent to `Mat4.rotateZ(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `this`\n     */\n    rotateZ(rad) {\n        return Mat4.rotateZ(this, this, rad);\n    }\n    /**\n     * Generates a perspective projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * Equivalent to `Mat4.perspectiveNO(this, fovy, aspect, near, far);`\n     *\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `this`\n     */\n    perspectiveNO(fovy, aspect, near, far) {\n        return Mat4.perspectiveNO(this, fovy, aspect, near, far);\n    }\n    /**\n     * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * Equivalent to `Mat4.perspectiveZO(this, fovy, aspect, near, far);`\n     *\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `this`\n     */\n    perspectiveZO(fovy, aspect, near, far) {\n        return Mat4.perspectiveZO(this, fovy, aspect, near, far);\n    }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * Equivalent to `Mat4.orthoNO(this, left, right, bottom, top, near, far);`\n     *\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `this`\n     */\n    orthoNO(left, right, bottom, top, near, far) {\n        return Mat4.orthoNO(this, left, right, bottom, top, near, far);\n    }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * Equivalent to `Mat4.orthoZO(this, left, right, bottom, top, near, far);`\n     *\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `this`\n     */\n    orthoZO(left, right, bottom, top, near, far) {\n        return Mat4.orthoZO(this, left, right, bottom, top, near, far);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, identity {@link Mat4}\n     * @category Static\n     *\n     * @returns A new {@link Mat4}\n     */\n    static create() {\n        return new Mat4();\n    }\n    /**\n     * Creates a new {@link Mat4} initialized with values from an existing matrix\n     * @category Static\n     *\n     * @param a - Matrix to clone\n     * @returns A new {@link Mat4}\n     */\n    static clone(a) {\n        return new Mat4(a);\n    }\n    /**\n     * Copy the values from one {@link Mat4} to another\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - Matrix to copy\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[4] = a[4];\n        out[5] = a[5];\n        out[6] = a[6];\n        out[7] = a[7];\n        out[8] = a[8];\n        out[9] = a[9];\n        out[10] = a[10];\n        out[11] = a[11];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n        return out;\n    }\n    /**\n     * Create a new mat4 with the given values\n     * @category Static\n     *\n     * @param values - Matrix components\n     * @returns A new {@link Mat4}\n     */\n    static fromValues(...values) {\n        return new Mat4(...values);\n    }\n    /**\n     * Set the components of a mat4 to the given values\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @param values - Matrix components\n     * @returns `out`\n     */\n    static set(out, ...values) {\n        out[0] = values[0];\n        out[1] = values[1];\n        out[2] = values[2];\n        out[3] = values[3];\n        out[4] = values[4];\n        out[5] = values[5];\n        out[6] = values[6];\n        out[7] = values[7];\n        out[8] = values[8];\n        out[9] = values[9];\n        out[10] = values[10];\n        out[11] = values[11];\n        out[12] = values[12];\n        out[13] = values[13];\n        out[14] = values[14];\n        out[15] = values[15];\n        return out;\n    }\n    /**\n     * Set a {@link Mat4} to the identity matrix\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = 1;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 1;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Transpose the values of a {@link Mat4}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static transpose(out, a) {\n        // If we are transposing ourselves we can skip a few steps but have to cache some values\n        if (out === a) {\n            const a01 = a[1], a02 = a[2], a03 = a[3];\n            const a12 = a[6], a13 = a[7];\n            const a23 = a[11];\n            out[1] = a[4];\n            out[2] = a[8];\n            out[3] = a[12];\n            out[4] = a01;\n            out[6] = a[9];\n            out[7] = a[13];\n            out[8] = a02;\n            out[9] = a12;\n            out[11] = a[14];\n            out[12] = a03;\n            out[13] = a13;\n            out[14] = a23;\n        }\n        else {\n            out[0] = a[0];\n            out[1] = a[4];\n            out[2] = a[8];\n            out[3] = a[12];\n            out[4] = a[1];\n            out[5] = a[5];\n            out[6] = a[9];\n            out[7] = a[13];\n            out[8] = a[2];\n            out[9] = a[6];\n            out[10] = a[10];\n            out[11] = a[14];\n            out[12] = a[3];\n            out[13] = a[7];\n            out[14] = a[11];\n            out[15] = a[15];\n        }\n        return out;\n    }\n    /**\n     * Inverts a {@link Mat4}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out` or `null` if the matrix is not invertable\n     */\n    static invert(out, a) {\n        const a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\n        const a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\n        const a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\n        const a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n        const b00 = a00 * a11 - a01 * a10;\n        const b01 = a00 * a12 - a02 * a10;\n        const b02 = a00 * a13 - a03 * a10;\n        const b03 = a01 * a12 - a02 * a11;\n        const b04 = a01 * a13 - a03 * a11;\n        const b05 = a02 * a13 - a03 * a12;\n        const b06 = a20 * a31 - a21 * a30;\n        const b07 = a20 * a32 - a22 * a30;\n        const b08 = a20 * a33 - a23 * a30;\n        const b09 = a21 * a32 - a22 * a31;\n        const b10 = a21 * a33 - a23 * a31;\n        const b11 = a22 * a33 - a23 * a32;\n        // Calculate the determinant\n        let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n        out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n        out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n        out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n        out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n        out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n        out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n        out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n        out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n        out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n        out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n        out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n        out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n        out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n        out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n        out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n        return out;\n    }\n    /**\n     * Calculates the adjugate of a {@link Mat4}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static adjoint(out, a) {\n        const a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\n        const a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\n        const a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\n        const a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n        const b00 = a00 * a11 - a01 * a10;\n        const b01 = a00 * a12 - a02 * a10;\n        const b02 = a00 * a13 - a03 * a10;\n        const b03 = a01 * a12 - a02 * a11;\n        const b04 = a01 * a13 - a03 * a11;\n        const b05 = a02 * a13 - a03 * a12;\n        const b06 = a20 * a31 - a21 * a30;\n        const b07 = a20 * a32 - a22 * a30;\n        const b08 = a20 * a33 - a23 * a30;\n        const b09 = a21 * a32 - a22 * a31;\n        const b10 = a21 * a33 - a23 * a31;\n        const b11 = a22 * a33 - a23 * a32;\n        out[0] = a11 * b11 - a12 * b10 + a13 * b09;\n        out[1] = a02 * b10 - a01 * b11 - a03 * b09;\n        out[2] = a31 * b05 - a32 * b04 + a33 * b03;\n        out[3] = a22 * b04 - a21 * b05 - a23 * b03;\n        out[4] = a12 * b08 - a10 * b11 - a13 * b07;\n        out[5] = a00 * b11 - a02 * b08 + a03 * b07;\n        out[6] = a32 * b02 - a30 * b05 - a33 * b01;\n        out[7] = a20 * b05 - a22 * b02 + a23 * b01;\n        out[8] = a10 * b10 - a11 * b08 + a13 * b06;\n        out[9] = a01 * b08 - a00 * b10 - a03 * b06;\n        out[10] = a30 * b04 - a31 * b02 + a33 * b00;\n        out[11] = a21 * b02 - a20 * b04 - a23 * b00;\n        out[12] = a11 * b07 - a10 * b09 - a12 * b06;\n        out[13] = a00 * b09 - a01 * b07 + a02 * b06;\n        out[14] = a31 * b01 - a30 * b03 - a32 * b00;\n        out[15] = a20 * b03 - a21 * b01 + a22 * b00;\n        return out;\n    }\n    /**\n     * Calculates the determinant of a {@link Mat4}\n     * @category Static\n     *\n     * @param a - the source matrix\n     * @returns determinant of a\n     */\n    static determinant(a) {\n        const a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\n        const a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\n        const a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\n        const a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n        const b0 = a00 * a11 - a01 * a10;\n        const b1 = a00 * a12 - a02 * a10;\n        const b2 = a01 * a12 - a02 * a11;\n        const b3 = a20 * a31 - a21 * a30;\n        const b4 = a20 * a32 - a22 * a30;\n        const b5 = a21 * a32 - a22 * a31;\n        const b6 = a00 * b5 - a01 * b4 + a02 * b3;\n        const b7 = a10 * b5 - a11 * b4 + a12 * b3;\n        const b8 = a20 * b2 - a21 * b1 + a22 * b0;\n        const b9 = a30 * b2 - a31 * b1 + a32 * b0;\n        // Calculate the determinant\n        return a13 * b6 - a03 * b7 + a33 * b8 - a23 * b9;\n    }\n    /**\n     * Multiplies two {@link Mat4}s\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a03 = a[3];\n        const a10 = a[4];\n        const a11 = a[5];\n        const a12 = a[6];\n        const a13 = a[7];\n        const a20 = a[8];\n        const a21 = a[9];\n        const a22 = a[10];\n        const a23 = a[11];\n        const a30 = a[12];\n        const a31 = a[13];\n        const a32 = a[14];\n        const a33 = a[15];\n        // Cache only the current line of the second matrix\n        let b0 = b[0];\n        let b1 = b[1];\n        let b2 = b[2];\n        let b3 = b[3];\n        out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        b0 = b[4];\n        b1 = b[5];\n        b2 = b[6];\n        b3 = b[7];\n        out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        b0 = b[8];\n        b1 = b[9];\n        b2 = b[10];\n        b3 = b[11];\n        out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        b0 = b[12];\n        b1 = b[13];\n        b2 = b[14];\n        b3 = b[15];\n        out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Translate a {@link Mat4} by the given vector\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to translate\n     * @param v - vector to translate by\n     * @returns `out`\n     */\n    static translate(out, a, v) {\n        const x = v[0];\n        const y = v[1];\n        const z = v[2];\n        if (a === out) {\n            out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n            out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n            out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n            out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n        }\n        else {\n            const a00 = a[0];\n            const a01 = a[1];\n            const a02 = a[2];\n            const a03 = a[3];\n            const a10 = a[4];\n            const a11 = a[5];\n            const a12 = a[6];\n            const a13 = a[7];\n            const a20 = a[8];\n            const a21 = a[9];\n            const a22 = a[10];\n            const a23 = a[11];\n            out[0] = a00;\n            out[1] = a01;\n            out[2] = a02;\n            out[3] = a03;\n            out[4] = a10;\n            out[5] = a11;\n            out[6] = a12;\n            out[7] = a13;\n            out[8] = a20;\n            out[9] = a21;\n            out[10] = a22;\n            out[11] = a23;\n            out[12] = a00 * x + a10 * y + a20 * z + a[12];\n            out[13] = a01 * x + a11 * y + a21 * z + a[13];\n            out[14] = a02 * x + a12 * y + a22 * z + a[14];\n            out[15] = a03 * x + a13 * y + a23 * z + a[15];\n        }\n        return out;\n    }\n    /**\n     * Scales the {@link Mat4} by the dimensions in the given {@link Vec3} not using vectorization\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param v - the {@link Vec3} to scale the matrix by\n     * @returns `out`\n     **/\n    static scale(out, a, v) {\n        const x = v[0];\n        const y = v[1];\n        const z = v[2];\n        out[0] = a[0] * x;\n        out[1] = a[1] * x;\n        out[2] = a[2] * x;\n        out[3] = a[3] * x;\n        out[4] = a[4] * y;\n        out[5] = a[5] * y;\n        out[6] = a[6] * y;\n        out[7] = a[7] * y;\n        out[8] = a[8] * z;\n        out[9] = a[9] * z;\n        out[10] = a[10] * z;\n        out[11] = a[11] * z;\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n        return out;\n    }\n    /**\n     * Rotates a {@link Mat4} by the given angle around the given axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @param axis - the axis to rotate around\n     * @returns `out` or `null` if axis has a length of 0\n     */\n    static rotate(out, a, rad, axis) {\n        let x = axis[0];\n        let y = axis[1];\n        let z = axis[2];\n        let len = Math.sqrt(x * x + y * y + z * z);\n        if (len < EPSILON) {\n            return null;\n        }\n        len = 1 / len;\n        x *= len;\n        y *= len;\n        z *= len;\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        const t = 1 - c;\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a03 = a[3];\n        const a10 = a[4];\n        const a11 = a[5];\n        const a12 = a[6];\n        const a13 = a[7];\n        const a20 = a[8];\n        const a21 = a[9];\n        const a22 = a[10];\n        const a23 = a[11];\n        // Construct the elements of the rotation matrix\n        const b00 = x * x * t + c;\n        const b01 = y * x * t + z * s;\n        const b02 = z * x * t - y * s;\n        const b10 = x * y * t - z * s;\n        const b11 = y * y * t + c;\n        const b12 = z * y * t + x * s;\n        const b20 = x * z * t + y * s;\n        const b21 = y * z * t - x * s;\n        const b22 = z * z * t + c;\n        // Perform rotation-specific matrix multiplication\n        out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n        out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n        out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n        out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n        out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n        out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n        out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n        out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n        out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n        out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n        out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n        out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged last row\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        return out;\n    }\n    /**\n     * Rotates a matrix by the given angle around the X axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotateX(out, a, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        let a10 = a[4];\n        let a11 = a[5];\n        let a12 = a[6];\n        let a13 = a[7];\n        let a20 = a[8];\n        let a21 = a[9];\n        let a22 = a[10];\n        let a23 = a[11];\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged rows\n            out[0] = a[0];\n            out[1] = a[1];\n            out[2] = a[2];\n            out[3] = a[3];\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        // Perform axis-specific matrix multiplication\n        out[4] = a10 * c + a20 * s;\n        out[5] = a11 * c + a21 * s;\n        out[6] = a12 * c + a22 * s;\n        out[7] = a13 * c + a23 * s;\n        out[8] = a20 * c - a10 * s;\n        out[9] = a21 * c - a11 * s;\n        out[10] = a22 * c - a12 * s;\n        out[11] = a23 * c - a13 * s;\n        return out;\n    }\n    /**\n     * Rotates a matrix by the given angle around the Y axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotateY(out, a, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        let a00 = a[0];\n        let a01 = a[1];\n        let a02 = a[2];\n        let a03 = a[3];\n        let a20 = a[8];\n        let a21 = a[9];\n        let a22 = a[10];\n        let a23 = a[11];\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged rows\n            out[4] = a[4];\n            out[5] = a[5];\n            out[6] = a[6];\n            out[7] = a[7];\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        // Perform axis-specific matrix multiplication\n        out[0] = a00 * c - a20 * s;\n        out[1] = a01 * c - a21 * s;\n        out[2] = a02 * c - a22 * s;\n        out[3] = a03 * c - a23 * s;\n        out[8] = a00 * s + a20 * c;\n        out[9] = a01 * s + a21 * c;\n        out[10] = a02 * s + a22 * c;\n        out[11] = a03 * s + a23 * c;\n        return out;\n    }\n    /**\n     * Rotates a matrix by the given angle around the Z axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotateZ(out, a, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        let a00 = a[0];\n        let a01 = a[1];\n        let a02 = a[2];\n        let a03 = a[3];\n        let a10 = a[4];\n        let a11 = a[5];\n        let a12 = a[6];\n        let a13 = a[7];\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged last row\n            out[8] = a[8];\n            out[9] = a[9];\n            out[10] = a[10];\n            out[11] = a[11];\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        // Perform axis-specific matrix multiplication\n        out[0] = a00 * c + a10 * s;\n        out[1] = a01 * c + a11 * s;\n        out[2] = a02 * c + a12 * s;\n        out[3] = a03 * c + a13 * s;\n        out[4] = a10 * c - a00 * s;\n        out[5] = a11 * c - a01 * s;\n        out[6] = a12 * c - a02 * s;\n        out[7] = a13 * c - a03 * s;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat4} from a vector translation\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat4} receiving operation result\n     * @param v - Translation vector\n     * @returns `out`\n     */\n    static fromTranslation(out, v) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = 1;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 1;\n        out[11] = 0;\n        out[12] = v[0];\n        out[13] = v[1];\n        out[14] = v[2];\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat4} from a vector scaling\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.scale(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat4} receiving operation result\n     * @param v - Scaling vector\n     * @returns `out`\n     */\n    static fromScaling(out, v) {\n        out[0] = v[0];\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = v[1];\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = v[2];\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat4} from a given angle around a given axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotate(dest, dest, rad, axis);\n     * @category Static\n     *\n     * @param out - {@link Mat4} receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @param axis - the axis to rotate around\n     * @returns `out` or `null` if `axis` has a length of 0\n     */\n    static fromRotation(out, rad, axis) {\n        let x = axis[0];\n        let y = axis[1];\n        let z = axis[2];\n        let len = Math.sqrt(x * x + y * y + z * z);\n        if (len < EPSILON) {\n            return null;\n        }\n        len = 1 / len;\n        x *= len;\n        y *= len;\n        z *= len;\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        const t = 1 - c;\n        // Perform rotation-specific matrix multiplication\n        out[0] = x * x * t + c;\n        out[1] = y * x * t + z * s;\n        out[2] = z * x * t - y * s;\n        out[3] = 0;\n        out[4] = x * y * t - z * s;\n        out[5] = y * y * t + c;\n        out[6] = z * y * t + x * s;\n        out[7] = 0;\n        out[8] = x * z * t + y * s;\n        out[9] = y * z * t - x * s;\n        out[10] = z * z * t + c;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from the given angle around the X axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotateX(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromXRotation(out, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        // Perform axis-specific matrix multiplication\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = c;\n        out[6] = s;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = -s;\n        out[10] = c;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from the given angle around the Y axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotateY(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromYRotation(out, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        // Perform axis-specific matrix multiplication\n        out[0] = c;\n        out[1] = 0;\n        out[2] = -s;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = 1;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = s;\n        out[9] = 0;\n        out[10] = c;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from the given angle around the Z axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotateZ(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromZRotation(out, rad) {\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        // Perform axis-specific matrix multiplication\n        out[0] = c;\n        out[1] = s;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = -s;\n        out[5] = c;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 1;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from a quaternion rotation and vector translation\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, vec);\n     *     let quatMat = mat4.create();\n     *     quat4.toMat4(quat, quatMat);\n     *     mat4.multiply(dest, quatMat);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Rotation quaternion\n     * @param v - Translation vector\n     * @returns `out`\n     */\n    static fromRotationTranslation(out, q, v) {\n        // Quaternion math\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        out[0] = 1 - (yy + zz);\n        out[1] = xy + wz;\n        out[2] = xz - wy;\n        out[3] = 0;\n        out[4] = xy - wz;\n        out[5] = 1 - (xx + zz);\n        out[6] = yz + wx;\n        out[7] = 0;\n        out[8] = xz + wy;\n        out[9] = yz - wx;\n        out[10] = 1 - (xx + yy);\n        out[11] = 0;\n        out[12] = v[0];\n        out[13] = v[1];\n        out[14] = v[2];\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Sets a {@link Mat4} from a {@link Quat2}.\n     * @category Static\n     *\n     * @param out - Matrix\n     * @param a - Dual Quaternion\n     * @returns `out`\n     */\n    static fromQuat2(out, a) {\n        const bx = -a[0];\n        const by = -a[1];\n        const bz = -a[2];\n        const bw = a[3];\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        let magnitude = bx * bx + by * by + bz * bz + bw * bw;\n        //Only scale if it makes sense\n        if (magnitude > 0) {\n            tmpVec3[0] = ((ax * bw + aw * bx + ay * bz - az * by) * 2) / magnitude;\n            tmpVec3[1] = ((ay * bw + aw * by + az * bx - ax * bz) * 2) / magnitude;\n            tmpVec3[2] = ((az * bw + aw * bz + ax * by - ay * bx) * 2) / magnitude;\n        }\n        else {\n            tmpVec3[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n            tmpVec3[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n            tmpVec3[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n        }\n        Mat4.fromRotationTranslation(out, a, tmpVec3);\n        return out;\n    }\n    /**\n     * Calculates a {@link Mat4} normal matrix (transpose inverse) from a {@link Mat4}\n     * @category Static\n     *\n     * @param out - Matrix receiving operation result\n     * @param a - Mat4 to derive the normal matrix from\n     * @returns `out` or `null` if the matrix is not invertable\n     */\n    static normalFromMat4(out, a) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a03 = a[3];\n        const a10 = a[4];\n        const a11 = a[5];\n        const a12 = a[6];\n        const a13 = a[7];\n        const a20 = a[8];\n        const a21 = a[9];\n        const a22 = a[10];\n        const a23 = a[11];\n        const a30 = a[12];\n        const a31 = a[13];\n        const a32 = a[14];\n        const a33 = a[15];\n        const b00 = a00 * a11 - a01 * a10;\n        const b01 = a00 * a12 - a02 * a10;\n        const b02 = a00 * a13 - a03 * a10;\n        const b03 = a01 * a12 - a02 * a11;\n        const b04 = a01 * a13 - a03 * a11;\n        const b05 = a02 * a13 - a03 * a12;\n        const b06 = a20 * a31 - a21 * a30;\n        const b07 = a20 * a32 - a22 * a30;\n        const b08 = a20 * a33 - a23 * a30;\n        const b09 = a21 * a32 - a22 * a31;\n        const b10 = a21 * a33 - a23 * a31;\n        const b11 = a22 * a33 - a23 * a32;\n        // Calculate the determinant\n        let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n        out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n        out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n        out[3] = 0;\n        out[4] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n        out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n        out[6] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n        out[7] = 0;\n        out[8] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n        out[9] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n        out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n        out[11] = 0;\n        // No translation\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Calculates a {@link Mat4} normal matrix (transpose inverse) from a {@link Mat4}\n     * This version omits the calculation of the constant factor (1/determinant), so\n     * any normals transformed with it will need to be renormalized.\n     * From https://stackoverflow.com/a/27616419/25968\n     * @category Static\n     *\n     * @param out - Matrix receiving operation result\n     * @param a - Mat4 to derive the normal matrix from\n     * @returns `out`\n     */\n    static normalFromMat4Fast(out, a) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const bx = a[4];\n        const by = a[5];\n        const bz = a[6];\n        const cx = a[8];\n        const cy = a[9];\n        const cz = a[10];\n        out[0] = by * cz - cz * cy;\n        out[1] = bz * cx - cx * cz;\n        out[2] = bx * cy - cy * cx;\n        out[3] = 0;\n        out[4] = cy * az - cz * ay;\n        out[5] = cz * ax - cx * az;\n        out[6] = cx * ay - cy * ax;\n        out[7] = 0;\n        out[8] = ay * bz - az * by;\n        out[9] = az * bx - ax * bz;\n        out[10] = ax * by - ay * bx;\n        out[11] = 0;\n        // No translation\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Returns the translation vector component of a transformation\n     * matrix. If a matrix is built with fromRotationTranslation,\n     * the returned vector will be the same as the translation vector\n     * originally supplied.\n     * @category Static\n     *\n     * @param  {vec3} out Vector to receive translation component\n     * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n     * @return {vec3} out\n     */\n    static getTranslation(out, mat) {\n        out[0] = mat[12];\n        out[1] = mat[13];\n        out[2] = mat[14];\n        return out;\n    }\n    /**\n     * Returns the scaling factor component of a transformation\n     * matrix. If a matrix is built with fromRotationTranslationScale\n     * with a normalized Quaternion parameter, the returned vector will be\n     * the same as the scaling vector\n     * originally supplied.\n     * @category Static\n     *\n     * @param  {vec3} out Vector to receive scaling factor component\n     * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n     * @return {vec3} out\n     */\n    static getScaling(out, mat) {\n        const m11 = mat[0];\n        const m12 = mat[1];\n        const m13 = mat[2];\n        const m21 = mat[4];\n        const m22 = mat[5];\n        const m23 = mat[6];\n        const m31 = mat[8];\n        const m32 = mat[9];\n        const m33 = mat[10];\n        out[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n        out[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n        out[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n        return out;\n    }\n    /**\n     * Returns a quaternion representing the rotational component\n     * of a transformation matrix. If a matrix is built with\n     * fromRotationTranslation, the returned quaternion will be the\n     * same as the quaternion originally supplied.\n     * @category Static\n     *\n     * @param out - Quaternion to receive the rotation component\n     * @param mat - Matrix to be decomposed (input)\n     * @return `out`\n     */\n    static getRotation(out, mat) {\n        Mat4.getScaling(tmpVec3, mat);\n        const is1 = 1 / tmpVec3[0];\n        const is2 = 1 / tmpVec3[1];\n        const is3 = 1 / tmpVec3[2];\n        const sm11 = mat[0] * is1;\n        const sm12 = mat[1] * is2;\n        const sm13 = mat[2] * is3;\n        const sm21 = mat[4] * is1;\n        const sm22 = mat[5] * is2;\n        const sm23 = mat[6] * is3;\n        const sm31 = mat[8] * is1;\n        const sm32 = mat[9] * is2;\n        const sm33 = mat[10] * is3;\n        const trace = sm11 + sm22 + sm33;\n        let S = 0;\n        if (trace > 0) {\n            S = Math.sqrt(trace + 1.0) * 2;\n            out[3] = 0.25 * S;\n            out[0] = (sm23 - sm32) / S;\n            out[1] = (sm31 - sm13) / S;\n            out[2] = (sm12 - sm21) / S;\n        }\n        else if (sm11 > sm22 && sm11 > sm33) {\n            S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n            out[3] = (sm23 - sm32) / S;\n            out[0] = 0.25 * S;\n            out[1] = (sm12 + sm21) / S;\n            out[2] = (sm31 + sm13) / S;\n        }\n        else if (sm22 > sm33) {\n            S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n            out[3] = (sm31 - sm13) / S;\n            out[0] = (sm12 + sm21) / S;\n            out[1] = 0.25 * S;\n            out[2] = (sm23 + sm32) / S;\n        }\n        else {\n            S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n            out[3] = (sm12 - sm21) / S;\n            out[0] = (sm31 + sm13) / S;\n            out[1] = (sm23 + sm32) / S;\n            out[2] = 0.25 * S;\n        }\n        return out;\n    }\n    /**\n     * Decomposes a transformation matrix into its rotation, translation\n     * and scale components. Returns only the rotation component\n     * @category Static\n     *\n     * @param out_r - Quaternion to receive the rotation component\n     * @param out_t - Vector to receive the translation vector\n     * @param out_s - Vector to receive the scaling factor\n     * @param mat - Matrix to be decomposed (input)\n     * @returns `out_r`\n     */\n    static decompose(out_r, out_t, out_s, mat) {\n        out_t[0] = mat[12];\n        out_t[1] = mat[13];\n        out_t[2] = mat[14];\n        const m11 = mat[0];\n        const m12 = mat[1];\n        const m13 = mat[2];\n        const m21 = mat[4];\n        const m22 = mat[5];\n        const m23 = mat[6];\n        const m31 = mat[8];\n        const m32 = mat[9];\n        const m33 = mat[10];\n        out_s[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n        out_s[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n        out_s[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n        const is1 = 1 / out_s[0];\n        const is2 = 1 / out_s[1];\n        const is3 = 1 / out_s[2];\n        const sm11 = m11 * is1;\n        const sm12 = m12 * is2;\n        const sm13 = m13 * is3;\n        const sm21 = m21 * is1;\n        const sm22 = m22 * is2;\n        const sm23 = m23 * is3;\n        const sm31 = m31 * is1;\n        const sm32 = m32 * is2;\n        const sm33 = m33 * is3;\n        const trace = sm11 + sm22 + sm33;\n        let S = 0;\n        if (trace > 0) {\n            S = Math.sqrt(trace + 1.0) * 2;\n            out_r[3] = 0.25 * S;\n            out_r[0] = (sm23 - sm32) / S;\n            out_r[1] = (sm31 - sm13) / S;\n            out_r[2] = (sm12 - sm21) / S;\n        }\n        else if (sm11 > sm22 && sm11 > sm33) {\n            S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n            out_r[3] = (sm23 - sm32) / S;\n            out_r[0] = 0.25 * S;\n            out_r[1] = (sm12 + sm21) / S;\n            out_r[2] = (sm31 + sm13) / S;\n        }\n        else if (sm22 > sm33) {\n            S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n            out_r[3] = (sm31 - sm13) / S;\n            out_r[0] = (sm12 + sm21) / S;\n            out_r[1] = 0.25 * S;\n            out_r[2] = (sm23 + sm32) / S;\n        }\n        else {\n            S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n            out_r[3] = (sm12 - sm21) / S;\n            out_r[0] = (sm31 + sm13) / S;\n            out_r[1] = (sm23 + sm32) / S;\n            out_r[2] = 0.25 * S;\n        }\n        return out_r;\n    }\n    /**\n     * Creates a matrix from a quaternion rotation, vector translation and vector scale\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, vec);\n     *     let quatMat = mat4.create();\n     *     quat4.toMat4(quat, quatMat);\n     *     mat4.multiply(dest, quatMat);\n     *     mat4.scale(dest, scale);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Rotation quaternion\n     * @param v - Translation vector\n     * @param s - Scaling vector\n     * @returns `out`\n     */\n    static fromRotationTranslationScale(out, q, v, s) {\n        // Quaternion math\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        const sx = s[0];\n        const sy = s[1];\n        const sz = s[2];\n        out[0] = (1 - (yy + zz)) * sx;\n        out[1] = (xy + wz) * sx;\n        out[2] = (xz - wy) * sx;\n        out[3] = 0;\n        out[4] = (xy - wz) * sy;\n        out[5] = (1 - (xx + zz)) * sy;\n        out[6] = (yz + wx) * sy;\n        out[7] = 0;\n        out[8] = (xz + wy) * sz;\n        out[9] = (yz - wx) * sz;\n        out[10] = (1 - (xx + yy)) * sz;\n        out[11] = 0;\n        out[12] = v[0];\n        out[13] = v[1];\n        out[14] = v[2];\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, vec);\n     *     mat4.translate(dest, origin);\n     *     let quatMat = mat4.create();\n     *     quat4.toMat4(quat, quatMat);\n     *     mat4.multiply(dest, quatMat);\n     *     mat4.scale(dest, scale)\n     *     mat4.translate(dest, negativeOrigin);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Rotation quaternion\n     * @param v - Translation vector\n     * @param s - Scaling vector\n     * @param o - The origin vector around which to scale and rotate\n     * @returns `out`\n     */\n    static fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n        // Quaternion math\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        const sx = s[0];\n        const sy = s[1];\n        const sz = s[2];\n        const ox = o[0];\n        const oy = o[1];\n        const oz = o[2];\n        const out0 = (1 - (yy + zz)) * sx;\n        const out1 = (xy + wz) * sx;\n        const out2 = (xz - wy) * sx;\n        const out4 = (xy - wz) * sy;\n        const out5 = (1 - (xx + zz)) * sy;\n        const out6 = (yz + wx) * sy;\n        const out8 = (xz + wy) * sz;\n        const out9 = (yz - wx) * sz;\n        const out10 = (1 - (xx + yy)) * sz;\n        out[0] = out0;\n        out[1] = out1;\n        out[2] = out2;\n        out[3] = 0;\n        out[4] = out4;\n        out[5] = out5;\n        out[6] = out6;\n        out[7] = 0;\n        out[8] = out8;\n        out[9] = out9;\n        out[10] = out10;\n        out[11] = 0;\n        out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n        out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n        out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Calculates a 4x4 matrix from the given quaternion\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Quaternion to create matrix from\n     * @returns `out`\n     */\n    static fromQuat(out, q) {\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const yx = y * x2;\n        const yy = y * y2;\n        const zx = z * x2;\n        const zy = z * y2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        out[0] = 1 - yy - zz;\n        out[1] = yx + wz;\n        out[2] = zx - wy;\n        out[3] = 0;\n        out[4] = yx - wz;\n        out[5] = 1 - xx - zz;\n        out[6] = zy + wx;\n        out[7] = 0;\n        out[8] = zx + wy;\n        out[9] = zy - wx;\n        out[10] = 1 - xx - yy;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Generates a frustum matrix with the given bounds\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far -  Far bound of the frustum, can be null or Infinity\n     * @returns `out`\n     */\n    static frustumNO(out, left, right, bottom, top, near, far = Infinity) {\n        const rl = 1 / (right - left);\n        const tb = 1 / (top - bottom);\n        out[0] = near * 2 * rl;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = near * 2 * tb;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = (right + left) * rl;\n        out[9] = (top + bottom) * tb;\n        out[11] = -1;\n        out[12] = 0;\n        out[13] = 0;\n        out[15] = 0;\n        if (far != null && far !== Infinity) {\n            const nf = 1 / (near - far);\n            out[10] = (far + near) * nf;\n            out[14] = 2 * far * near * nf;\n        }\n        else {\n            out[10] = -1;\n            out[14] = -2 * near;\n        }\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.frustumNO}\n     * @category Static\n     * @deprecated Use {@link Mat4.frustumNO} or {@link Mat4.frustumZO} explicitly\n     */\n    static frustum(out, left, right, bottom, top, near, far = Infinity) { return out; }\n    /**\n     * Generates a frustum matrix with the given bounds\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `out`\n     */\n    static frustumZO(out, left, right, bottom, top, near, far = Infinity) {\n        const rl = 1 / (right - left);\n        const tb = 1 / (top - bottom);\n        out[0] = near * 2 * rl;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = near * 2 * tb;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = (right + left) * rl;\n        out[9] = (top + bottom) * tb;\n        out[11] = -1;\n        out[12] = 0;\n        out[13] = 0;\n        out[15] = 0;\n        if (far != null && far !== Infinity) {\n            const nf = 1 / (near - far);\n            out[10] = far * nf;\n            out[14] = far * near * nf;\n        }\n        else {\n            out[10] = -1;\n            out[14] = -near;\n        }\n        return out;\n    }\n    /**\n     * Generates a perspective projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `out`\n     */\n    static perspectiveNO(out, fovy, aspect, near, far = Infinity) {\n        const f = 1.0 / Math.tan(fovy / 2);\n        out[0] = f / aspect;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = f;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[11] = -1;\n        out[12] = 0;\n        out[13] = 0;\n        out[15] = 0;\n        if (far != null && far !== Infinity) {\n            const nf = 1 / (near - far);\n            out[10] = (far + near) * nf;\n            out[14] = 2 * far * near * nf;\n        }\n        else {\n            out[10] = -1;\n            out[14] = -2 * near;\n        }\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.perspectiveNO}\n     * @category Static\n     * @deprecated Use {@link Mat4.perspectiveNO} or {@link Mat4.perspectiveZO} explicitly\n     */\n    static perspective(out, fovy, aspect, near, far = Infinity) { return out; }\n    /**\n     * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `out`\n     */\n    static perspectiveZO(out, fovy, aspect, near, far = Infinity) {\n        const f = 1.0 / Math.tan(fovy / 2);\n        out[0] = f / aspect;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = f;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[11] = -1;\n        out[12] = 0;\n        out[13] = 0;\n        out[15] = 0;\n        if (far != null && far !== Infinity) {\n            const nf = 1 / (near - far);\n            out[10] = far * nf;\n            out[14] = far * near * nf;\n        }\n        else {\n            out[10] = -1;\n            out[14] = -near;\n        }\n        return out;\n    }\n    /**\n     * Generates a perspective projection matrix with the given field of view.\n     * This is primarily useful for generating projection matrices to be used\n     * with the still experiemental WebVR API.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param fov - Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `out`\n     * @deprecated\n     */\n    static perspectiveFromFieldOfView(out, fov, near, far) {\n        const upTan = Math.tan((fov.upDegrees * Math.PI) / 180.0);\n        const downTan = Math.tan((fov.downDegrees * Math.PI) / 180.0);\n        const leftTan = Math.tan((fov.leftDegrees * Math.PI) / 180.0);\n        const rightTan = Math.tan((fov.rightDegrees * Math.PI) / 180.0);\n        const xScale = 2.0 / (leftTan + rightTan);\n        const yScale = 2.0 / (upTan + downTan);\n        out[0] = xScale;\n        out[1] = 0.0;\n        out[2] = 0.0;\n        out[3] = 0.0;\n        out[4] = 0.0;\n        out[5] = yScale;\n        out[6] = 0.0;\n        out[7] = 0.0;\n        out[8] = -((leftTan - rightTan) * xScale * 0.5);\n        out[9] = (upTan - downTan) * yScale * 0.5;\n        out[10] = far / (near - far);\n        out[11] = -1.0;\n        out[12] = 0.0;\n        out[13] = 0.0;\n        out[14] = (far * near) / (near - far);\n        out[15] = 0.0;\n        return out;\n    }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `out`\n     */\n    static orthoNO(out, left, right, bottom, top, near, far) {\n        const lr = 1 / (left - right);\n        const bt = 1 / (bottom - top);\n        const nf = 1 / (near - far);\n        out[0] = -2 * lr;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = -2 * bt;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 2 * nf;\n        out[11] = 0;\n        out[12] = (left + right) * lr;\n        out[13] = (top + bottom) * bt;\n        out[14] = (far + near) * nf;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.orthoNO}\n     * @category Static\n     * @deprecated Use {@link Mat4.orthoNO} or {@link Mat4.orthoZO} explicitly\n     */\n    static ortho(out, left, right, bottom, top, near, far) { return out; }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `out`\n     */\n    static orthoZO(out, left, right, bottom, top, near, far) {\n        const lr = 1 / (left - right);\n        const bt = 1 / (bottom - top);\n        const nf = 1 / (near - far);\n        out[0] = -2 * lr;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = -2 * bt;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = nf;\n        out[11] = 0;\n        out[12] = (left + right) * lr;\n        out[13] = (top + bottom) * bt;\n        out[14] = near * nf;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Generates a look-at matrix with the given eye position, focal point, and up axis.\n     * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param eye - Position of the viewer\n     * @param center - Point the viewer is looking at\n     * @param up - vec3 pointing up\n     * @returns `out`\n     */\n    static lookAt(out, eye, center, up) {\n        const eyex = eye[0];\n        const eyey = eye[1];\n        const eyez = eye[2];\n        const upx = up[0];\n        const upy = up[1];\n        const upz = up[2];\n        const centerx = center[0];\n        const centery = center[1];\n        const centerz = center[2];\n        if (Math.abs(eyex - centerx) < EPSILON &&\n            Math.abs(eyey - centery) < EPSILON &&\n            Math.abs(eyez - centerz) < EPSILON) {\n            return Mat4.identity(out);\n        }\n        let z0 = eyex - centerx;\n        let z1 = eyey - centery;\n        let z2 = eyez - centerz;\n        let len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n        z0 *= len;\n        z1 *= len;\n        z2 *= len;\n        let x0 = upy * z2 - upz * z1;\n        let x1 = upz * z0 - upx * z2;\n        let x2 = upx * z1 - upy * z0;\n        len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n        if (!len) {\n            x0 = 0;\n            x1 = 0;\n            x2 = 0;\n        }\n        else {\n            len = 1 / len;\n            x0 *= len;\n            x1 *= len;\n            x2 *= len;\n        }\n        let y0 = z1 * x2 - z2 * x1;\n        let y1 = z2 * x0 - z0 * x2;\n        let y2 = z0 * x1 - z1 * x0;\n        len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n        if (!len) {\n            y0 = 0;\n            y1 = 0;\n            y2 = 0;\n        }\n        else {\n            len = 1 / len;\n            y0 *= len;\n            y1 *= len;\n            y2 *= len;\n        }\n        out[0] = x0;\n        out[1] = y0;\n        out[2] = z0;\n        out[3] = 0;\n        out[4] = x1;\n        out[5] = y1;\n        out[6] = z1;\n        out[7] = 0;\n        out[8] = x2;\n        out[9] = y2;\n        out[10] = z2;\n        out[11] = 0;\n        out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n        out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n        out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Generates a matrix that makes something look at something else.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param eye - Position of the viewer\n     * @param target - Point the viewer is looking at\n     * @param up - vec3 pointing up\n     * @returns `out`\n     */\n    static targetTo(out, eye, target, up) {\n        const eyex = eye[0];\n        const eyey = eye[1];\n        const eyez = eye[2];\n        const upx = up[0];\n        const upy = up[1];\n        const upz = up[2];\n        let z0 = eyex - target[0];\n        let z1 = eyey - target[1];\n        let z2 = eyez - target[2];\n        let len = z0 * z0 + z1 * z1 + z2 * z2;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n            z0 *= len;\n            z1 *= len;\n            z2 *= len;\n        }\n        let x0 = upy * z2 - upz * z1;\n        let x1 = upz * z0 - upx * z2;\n        let x2 = upx * z1 - upy * z0;\n        len = x0 * x0 + x1 * x1 + x2 * x2;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n            x0 *= len;\n            x1 *= len;\n            x2 *= len;\n        }\n        out[0] = x0;\n        out[1] = x1;\n        out[2] = x2;\n        out[3] = 0;\n        out[4] = z1 * x2 - z2 * x1;\n        out[5] = z2 * x0 - z0 * x2;\n        out[6] = z0 * x1 - z1 * x0;\n        out[7] = 0;\n        out[8] = z0;\n        out[9] = z1;\n        out[10] = z2;\n        out[11] = 0;\n        out[12] = eyex;\n        out[13] = eyey;\n        out[14] = eyez;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Returns Frobenius norm of a {@link Mat4}\n     * @category Static\n     *\n     * @param a - the matrix to calculate Frobenius norm of\n     * @returns Frobenius norm\n     */\n    static frob(a) {\n        return Math.sqrt(a[0] * a[0] +\n            a[1] * a[1] +\n            a[2] * a[2] +\n            a[3] * a[3] +\n            a[4] * a[4] +\n            a[5] * a[5] +\n            a[6] * a[6] +\n            a[7] * a[7] +\n            a[8] * a[8] +\n            a[9] * a[9] +\n            a[10] * a[10] +\n            a[11] * a[11] +\n            a[12] * a[12] +\n            a[13] * a[13] +\n            a[14] * a[14] +\n            a[15] * a[15]);\n    }\n    /**\n     * Adds two {@link Mat4}'s\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        out[4] = a[4] + b[4];\n        out[5] = a[5] + b[5];\n        out[6] = a[6] + b[6];\n        out[7] = a[7] + b[7];\n        out[8] = a[8] + b[8];\n        out[9] = a[9] + b[9];\n        out[10] = a[10] + b[10];\n        out[11] = a[11] + b[11];\n        out[12] = a[12] + b[12];\n        out[13] = a[13] + b[13];\n        out[14] = a[14] + b[14];\n        out[15] = a[15] + b[15];\n        return out;\n    }\n    /**\n     * Subtracts matrix b from matrix a\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        out[4] = a[4] - b[4];\n        out[5] = a[5] - b[5];\n        out[6] = a[6] - b[6];\n        out[7] = a[7] - b[7];\n        out[8] = a[8] - b[8];\n        out[9] = a[9] - b[9];\n        out[10] = a[10] - b[10];\n        out[11] = a[11] - b[11];\n        out[12] = a[12] - b[12];\n        out[13] = a[13] - b[13];\n        out[14] = a[14] - b[14];\n        out[15] = a[15] - b[15];\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiply each element of the matrix by a scalar.\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param b - amount to scale the matrix's elements by\n     * @returns `out`\n     */\n    static multiplyScalar(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        out[2] = a[2] * b;\n        out[3] = a[3] * b;\n        out[4] = a[4] * b;\n        out[5] = a[5] * b;\n        out[6] = a[6] * b;\n        out[7] = a[7] * b;\n        out[8] = a[8] * b;\n        out[9] = a[9] * b;\n        out[10] = a[10] * b;\n        out[11] = a[11] * b;\n        out[12] = a[12] * b;\n        out[13] = a[13] * b;\n        out[14] = a[14] * b;\n        out[15] = a[15] * b;\n        return out;\n    }\n    /**\n     * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b's elements by before adding\n     * @returns `out`\n     */\n    static multiplyScalarAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        out[4] = a[4] + b[4] * scale;\n        out[5] = a[5] + b[5] * scale;\n        out[6] = a[6] + b[6] * scale;\n        out[7] = a[7] + b[7] * scale;\n        out[8] = a[8] + b[8] * scale;\n        out[9] = a[9] + b[9] * scale;\n        out[10] = a[10] + b[10] * scale;\n        out[11] = a[11] + b[11] * scale;\n        out[12] = a[12] + b[12] * scale;\n        out[13] = a[13] + b[13] * scale;\n        out[14] = a[14] + b[14] * scale;\n        out[15] = a[15] + b[15] * scale;\n        return out;\n    }\n    /**\n     * Returns whether or not two {@link Mat4}s have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return (a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3] &&\n            a[4] === b[4] &&\n            a[5] === b[5] &&\n            a[6] === b[6] &&\n            a[7] === b[7] &&\n            a[8] === b[8] &&\n            a[9] === b[9] &&\n            a[10] === b[10] &&\n            a[11] === b[11] &&\n            a[12] === b[12] &&\n            a[13] === b[13] &&\n            a[14] === b[14] &&\n            a[15] === b[15]);\n    }\n    /**\n     * Returns whether or not two {@link Mat4}s have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const a6 = a[6];\n        const a7 = a[7];\n        const a8 = a[8];\n        const a9 = a[9];\n        const a10 = a[10];\n        const a11 = a[11];\n        const a12 = a[12];\n        const a13 = a[13];\n        const a14 = a[14];\n        const a15 = a[15];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        const b4 = b[4];\n        const b5 = b[5];\n        const b6 = b[6];\n        const b7 = b[7];\n        const b8 = b[8];\n        const b9 = b[9];\n        const b10 = b[10];\n        const b11 = b[11];\n        const b12 = b[12];\n        const b13 = b[13];\n        const b14 = b[14];\n        const b15 = b[15];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= EPSILON * Math.max(1, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= EPSILON * Math.max(1, Math.abs(a5), Math.abs(b5)) &&\n            Math.abs(a6 - b6) <= EPSILON * Math.max(1, Math.abs(a6), Math.abs(b6)) &&\n            Math.abs(a7 - b7) <= EPSILON * Math.max(1, Math.abs(a7), Math.abs(b7)) &&\n            Math.abs(a8 - b8) <= EPSILON * Math.max(1, Math.abs(a8), Math.abs(b8)) &&\n            Math.abs(a9 - b9) <= EPSILON * Math.max(1, Math.abs(a9), Math.abs(b9)) &&\n            Math.abs(a10 - b10) <= EPSILON * Math.max(1, Math.abs(a10), Math.abs(b10)) &&\n            Math.abs(a11 - b11) <= EPSILON * Math.max(1, Math.abs(a11), Math.abs(b11)) &&\n            Math.abs(a12 - b12) <= EPSILON * Math.max(1, Math.abs(a12), Math.abs(b12)) &&\n            Math.abs(a13 - b13) <= EPSILON * Math.max(1, Math.abs(a13), Math.abs(b13)) &&\n            Math.abs(a14 - b14) <= EPSILON * Math.max(1, Math.abs(a14), Math.abs(b14)) &&\n            Math.abs(a15 - b15) <= EPSILON * Math.max(1, Math.abs(a15), Math.abs(b15)));\n    }\n    /**\n     * Returns a string representation of a {@link Mat4}\n     * @category Static\n     *\n     * @param a - matrix to represent as a string\n     * @returns string representation of the matrix\n     */\n    static str(a) {\n        return `Mat4(${a.join(', ')})`;\n    }\n}\nexport { Mat4 };\n// Temporary variables to prevent repeated allocations in the algorithms above.\n// These are declared as TypedArrays to aid in tree-shaking.\nconst tmpVec3 = new Float32Array(3);\n// Instance method alias assignments\nMat4.prototype.mul = Mat4.prototype.multiply;\n// Static method alias assignments\nMat4.sub = Mat4.subtract;\nMat4.mul = Mat4.multiply;\nMat4.frustum = Mat4.frustumNO;\nMat4.perspective = Mat4.perspectiveNO;\nMat4.ortho = Mat4.orthoNO;\n/**\n * Mat4 alias for backwards compatibility\n */\nexport const mat4 = Mat4;\n//# sourceMappingURL=mat4.js.map","import { EPSILON } from './common.js';\n/**\n * 3 Dimensional Vector\n */\nclass Vec3 extends Float32Array {\n    /**\n    * The number of bytes in a {@link Vec3}.\n    */\n    static BYTE_LENGTH = 3 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n    * Create a {@link Vec3}.\n    */\n    constructor(...values) {\n        switch (values.length) {\n            case 3:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 3);\n                break;\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v, v]);\n                }\n                else {\n                    super(v, 0, 3);\n                }\n                break;\n            }\n            default:\n                super(3);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    // Getters and setters to make component access read better.\n    // These are likely to be a little bit slower than direct array access.\n    /**\n     * The x component of the vector. Equivalent to `this[0];`\n     * @category Vector components\n     */\n    get x() { return this[0]; }\n    set x(value) { this[0] = value; }\n    /**\n     * The y component of the vector. Equivalent to `this[1];`\n     * @category Vector components\n     */\n    get y() { return this[1]; }\n    set y(value) { this[1] = value; }\n    /**\n     * The z component of the vector. Equivalent to `this[2];`\n     * @category Vector components\n     */\n    get z() { return this[2]; }\n    set z(value) { this[2] = value; }\n    // Alternate set of getters and setters in case this is being used to define\n    // a color.\n    /**\n     * The r component of the vector. Equivalent to `this[0];`\n     * @category Color components\n     */\n    get r() { return this[0]; }\n    set r(value) { this[0] = value; }\n    /**\n     * The g component of the vector. Equivalent to `this[1];`\n     * @category Color components\n     */\n    get g() { return this[1]; }\n    set g(value) { this[1] = value; }\n    /**\n     * The b component of the vector. Equivalent to `this[2];`\n     * @category Color components\n     */\n    get b() { return this[2]; }\n    set b(value) { this[2] = value; }\n    /**\n     * The magnitude (length) of this.\n     * Equivalent to `Vec3.magnitude(this);`\n     *\n     * Magnitude is used because the `length` attribute is already defined by\n     * TypedArrays to mean the number of elements in the array.\n     */\n    get magnitude() {\n        const x = this[0];\n        const y = this[1];\n        const z = this[2];\n        return Math.sqrt(x * x + y * y + z * z);\n    }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     */\n    get mag() { return this.magnitude; }\n    /**\n     * The squared magnitude (length) of `this`.\n     * Equivalent to `Vec3.squaredMagnitude(this);`\n     */\n    get squaredMagnitude() {\n        const x = this[0];\n        const y = this[1];\n        const z = this[2];\n        return x * x + y * y + z * z;\n    }\n    /**\n     * Alias for {@link Vec3.squaredMagnitude}\n     */\n    get sqrMag() { return this.squaredMagnitude; }\n    /**\n     * A string representation of `this`\n     * Equivalent to `Vec3.str(this);`\n     */\n    get str() {\n        return Vec3.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Vec3} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Adds a {@link Vec3} to `this`.\n     * Equivalent to `Vec3.add(this, this, b);`\n     *\n     * @param b - The vector to add to `this`\n     * @returns `this`\n     */\n    add(b) {\n        this[0] += b[0];\n        this[1] += b[1];\n        this[2] += b[2];\n        return this;\n    }\n    /**\n     * Subtracts a {@link Vec3} from `this`.\n     * Equivalent to `Vec3.subtract(this, this, b);`\n     *\n     * @param b - The vector to subtract from `this`\n     * @returns `this`\n     */\n    subtract(b) {\n        this[0] -= b[0];\n        this[1] -= b[1];\n        this[2] -= b[2];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec3.subtract}\n     */\n    sub(b) { return this; }\n    /**\n     * Multiplies `this` by a {@link Vec3}.\n     * Equivalent to `Vec3.multiply(this, this, b);`\n     *\n     * @param b - The vector to multiply `this` by\n     * @returns `this`\n     */\n    multiply(b) {\n        this[0] *= b[0];\n        this[1] *= b[1];\n        this[2] *= b[2];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec3.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Divides `this` by a {@link Vec3}.\n     * Equivalent to `Vec3.divide(this, this, b);`\n     *\n     * @param b - The vector to divide `this` by\n     * @returns `this`\n     */\n    divide(b) {\n        this[0] /= b[0];\n        this[1] /= b[1];\n        this[2] /= b[2];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec3.divide}\n     */\n    div(b) { return this; }\n    /**\n     * Scales `this` by a scalar number.\n     * Equivalent to `Vec3.scale(this, this, b);`\n     *\n     * @param b - Amount to scale `this` by\n     * @returns `this`\n     */\n    scale(b) {\n        this[0] *= b;\n        this[1] *= b;\n        this[2] *= b;\n        return this;\n    }\n    /**\n     * Calculates `this` scaled by a scalar value then adds the result to `this`.\n     * Equivalent to `Vec3.scaleAndAdd(this, this, b, scale);`\n     *\n     * @param b - The vector to add to `this`\n     * @param scale - The amount to scale `b` by before adding\n     * @returns `this`\n     */\n    scaleAndAdd(b, scale) {\n        this[0] += b[0] * scale;\n        this[1] += b[1] * scale;\n        this[2] += b[2] * scale;\n        return this;\n    }\n    /**\n     * Calculates the euclidian distance between another {@link Vec3} and `this`.\n     * Equivalent to `Vec3.distance(this, b);`\n     *\n     * @param b - The vector to calculate the distance to\n     * @returns Distance between `this` and `b`\n     */\n    distance(b) {\n        return Vec3.distance(this, b);\n    }\n    /**\n     * Alias for {@link Vec3.distance}\n     */\n    dist(b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between another {@link Vec3} and `this`.\n     * Equivalent to `Vec3.squaredDistance(this, b);`\n     *\n     * @param b The vector to calculate the squared distance to\n     * @returns Squared distance between `this` and `b`\n     */\n    squaredDistance(b) {\n        return Vec3.squaredDistance(this, b);\n    }\n    /**\n     * Alias for {@link Vec3.squaredDistance}\n     */\n    sqrDist(b) { return 0; }\n    /**\n     * Negates the components of `this`.\n     * Equivalent to `Vec3.negate(this, this);`\n     *\n     * @returns `this`\n     */\n    negate() {\n        this[0] *= -1;\n        this[1] *= -1;\n        this[2] *= -1;\n        return this;\n    }\n    /**\n     * Inverts the components of `this`.\n     * Equivalent to `Vec3.inverse(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        this[0] = 1.0 / this[0];\n        this[1] = 1.0 / this[1];\n        this[2] = 1.0 / this[2];\n        return this;\n    }\n    /**\n     * Sets each component of `this` to it's absolute value.\n     * Equivalent to `Vec3.abs(this, this);`\n     *\n     * @returns `this`\n     */\n    abs() {\n        this[0] = Math.abs(this[0]);\n        this[1] = Math.abs(this[1]);\n        this[2] = Math.abs(this[2]);\n        return this;\n    }\n    /**\n     * Calculates the dot product of this and another {@link Vec3}.\n     * Equivalent to `Vec3.dot(this, b);`\n     *\n     * @param b - The second operand\n     * @returns Dot product of `this` and `b`\n     */\n    dot(b) {\n        return this[0] * b[0] + this[1] * b[1] + this[2] * b[2];\n    }\n    /**\n     * Normalize `this`.\n     * Equivalent to `Vec3.normalize(this, this);`\n     *\n     * @returns `this`\n     */\n    normalize() {\n        return Vec3.normalize(this, this);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, empty vec3\n     * @category Static\n     *\n     * @returns a new 3D vector\n     */\n    static create() {\n        return new Vec3();\n    }\n    /**\n     * Creates a new vec3 initialized with values from an existing vector\n     * @category Static\n     *\n     * @param a - vector to clone\n     * @returns a new 3D vector\n     */\n    static clone(a) {\n        return new Vec3(a);\n    }\n    /**\n     * Calculates the magnitude (length) of a {@link Vec3}\n     * @category Static\n     *\n     * @param a - Vector to calculate magnitude of\n     * @returns Magnitude of a\n     */\n    static magnitude(a) {\n        let x = a[0];\n        let y = a[1];\n        let z = a[2];\n        return Math.sqrt(x * x + y * y + z * z);\n    }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec3.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     *\n     * @param a - vector to calculate length of\n     * @returns length of a\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec3.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Creates a new vec3 initialized with the given values\n     * @category Static\n     *\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @returns a new 3D vector\n     */\n    static fromValues(x, y, z) {\n        return new Vec3(x, y, z);\n    }\n    /**\n     * Copy the values from one vec3 to another\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the source vector\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        return out;\n    }\n    /**\n     * Set the components of a vec3 to the given values\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @returns `out`\n     */\n    static set(out, x, y, z) {\n        out[0] = x;\n        out[1] = y;\n        out[2] = z;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec3}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        return out;\n    }\n    /**\n     * Subtracts vector b from vector a\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec3.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return [0, 0, 0]; }\n    ;\n    /**\n     * Multiplies two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        out[0] = a[0] * b[0];\n        out[1] = a[1] * b[1];\n        out[2] = a[2] * b[2];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec3.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return [0, 0, 0]; }\n    /**\n     * Divides two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static divide(out, a, b) {\n        out[0] = a[0] / b[0];\n        out[1] = a[1] / b[1];\n        out[2] = a[2] / b[2];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec3.divide}\n     * @category Static\n     */\n    static div(out, a, b) { return [0, 0, 0]; }\n    ;\n    /**\n     * Math.ceil the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to ceil\n     * @returns `out`\n     */\n    static ceil(out, a) {\n        out[0] = Math.ceil(a[0]);\n        out[1] = Math.ceil(a[1]);\n        out[2] = Math.ceil(a[2]);\n        return out;\n    }\n    /**\n     * Math.floor the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to floor\n     * @returns `out`\n     */\n    static floor(out, a) {\n        out[0] = Math.floor(a[0]);\n        out[1] = Math.floor(a[1]);\n        out[2] = Math.floor(a[2]);\n        return out;\n    }\n    /**\n     * Returns the minimum of two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static min(out, a, b) {\n        out[0] = Math.min(a[0], b[0]);\n        out[1] = Math.min(a[1], b[1]);\n        out[2] = Math.min(a[2], b[2]);\n        return out;\n    }\n    /**\n     * Returns the maximum of two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static max(out, a, b) {\n        out[0] = Math.max(a[0], b[0]);\n        out[1] = Math.max(a[1], b[1]);\n        out[2] = Math.max(a[2], b[2]);\n        return out;\n    }\n    /**\n     * symmetric round the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to round\n     * @returns `out`\n     */\n    /*static round(out: Vec3Like, a: Readonly<Vec3Like>): Vec3Like {\n      out[0] = glMatrix.round(a[0]);\n      out[1] = glMatrix.round(a[1]);\n      out[2] = glMatrix.round(a[2]);\n      return out;\n    }*/\n    /**\n     * Scales a vec3 by a scalar number\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to scale\n     * @param scale - amount to scale the vector by\n     * @returns `out`\n     */\n    static scale(out, a, scale) {\n        out[0] = a[0] * scale;\n        out[1] = a[1] * scale;\n        out[2] = a[2] * scale;\n        return out;\n    }\n    /**\n     * Adds two vec3's after scaling the second operand by a scalar value\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b by before adding\n     * @returns `out`\n     */\n    static scaleAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        return out;\n    }\n    /**\n     * Calculates the euclidian distance between two vec3's\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns distance between a and b\n     */\n    static distance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        return Math.sqrt(x * x + y * y + z * z);\n    }\n    /**\n     * Alias for {@link Vec3.distance}\n     */\n    static dist(a, b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between two vec3's\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns squared distance between a and b\n     */\n    static squaredDistance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        return x * x + y * y + z * z;\n    }\n    /**\n     * Alias for {@link Vec3.squaredDistance}\n     */\n    static sqrDist(a, b) { return 0; }\n    /**\n     * Calculates the squared length of a vec3\n     * @category Static\n     *\n     * @param a - vector to calculate squared length of\n     * @returns squared length of a\n     */\n    static squaredLength(a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        return x * x + y * y + z * z;\n    }\n    /**\n     * Alias for {@link Vec3.squaredLength}\n     */\n    static sqrLen(a, b) { return 0; }\n    /**\n     * Negates the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to negate\n     * @returns `out`\n     */\n    static negate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        return out;\n    }\n    /**\n     * Returns the inverse of the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to invert\n     * @returns `out`\n     */\n    static inverse(out, a) {\n        out[0] = 1.0 / a[0];\n        out[1] = 1.0 / a[1];\n        out[2] = 1.0 / a[2];\n        return out;\n    }\n    /**\n     * Returns the absolute value of the components of a {@link Vec3}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to compute the absolute values of\n     * @returns `out`\n     */\n    static abs(out, a) {\n        out[0] = Math.abs(a[0]);\n        out[1] = Math.abs(a[1]);\n        out[2] = Math.abs(a[2]);\n        return out;\n    }\n    /**\n     * Normalize a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        let len = x * x + y * y + z * z;\n        if (len > 0) {\n            //TODO: evaluate use of glm_invsqrt here?\n            len = 1 / Math.sqrt(len);\n        }\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        out[2] = a[2] * len;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two vec3's\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns dot product of a and b\n     */\n    static dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n    }\n    /**\n     * Computes the cross product of two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static cross(out, a, b) {\n        const ax = a[0], ay = a[1], az = a[2];\n        const bx = b[0], by = b[1], bz = b[2];\n        out[0] = ay * bz - az * by;\n        out[1] = az * bx - ax * bz;\n        out[2] = ax * by - ay * bx;\n        return out;\n    }\n    /**\n     * Performs a linear interpolation between two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        out[0] = ax + t * (b[0] - ax);\n        out[1] = ay + t * (b[1] - ay);\n        out[2] = az + t * (b[2] - az);\n        return out;\n    }\n    /**\n     * Performs a spherical linear interpolation between two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static slerp(out, a, b, t) {\n        const angle = Math.acos(Math.min(Math.max(Vec3.dot(a, b), -1), 1));\n        const sinTotal = Math.sin(angle);\n        const ratioA = Math.sin((1 - t) * angle) / sinTotal;\n        const ratioB = Math.sin(t * angle) / sinTotal;\n        out[0] = ratioA * a[0] + ratioB * b[0];\n        out[1] = ratioA * a[1] + ratioB * b[1];\n        out[2] = ratioA * a[2] + ratioB * b[2];\n        return out;\n    }\n    /**\n     * Performs a hermite interpolation with two control points\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param c - the third operand\n     * @param d - the fourth operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static hermite(out, a, b, c, d, t) {\n        const factorTimes2 = t * t;\n        const factor1 = factorTimes2 * (2 * t - 3) + 1;\n        const factor2 = factorTimes2 * (t - 2) + t;\n        const factor3 = factorTimes2 * (t - 1);\n        const factor4 = factorTimes2 * (3 - 2 * t);\n        out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n        out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n        out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n        return out;\n    }\n    /**\n     * Performs a bezier interpolation with two control points\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param c - the third operand\n     * @param d - the fourth operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static bezier(out, a, b, c, d, t) {\n        const inverseFactor = 1 - t;\n        const inverseFactorTimesTwo = inverseFactor * inverseFactor;\n        const factorTimes2 = t * t;\n        const factor1 = inverseFactorTimesTwo * inverseFactor;\n        const factor2 = 3 * t * inverseFactorTimesTwo;\n        const factor3 = 3 * factorTimes2 * inverseFactor;\n        const factor4 = factorTimes2 * t;\n        out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n        out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n        out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n        return out;\n    }\n    /**\n     * Generates a random vector with the given scale\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n     * @returns `out`\n     */\n    /*static random(out: Vec3Like, scale) {\n      scale = scale === undefined ? 1.0 : scale;\n  \n      let r = glMatrix.RANDOM() * 2.0 * Math.PI;\n      let z = glMatrix.RANDOM() * 2.0 - 1.0;\n      let zScale = Math.sqrt(1.0 - z * z) * scale;\n  \n      out[0] = Math.cos(r) * zScale;\n      out[1] = Math.sin(r) * zScale;\n      out[2] = z * scale;\n      return out;\n    }*/\n    /**\n     * Transforms the vec3 with a mat4.\n     * 4th vector component is implicitly '1'\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param m - matrix to transform with\n     * @returns `out`\n     */\n    static transformMat4(out, a, m) {\n        const x = a[0], y = a[1], z = a[2];\n        const w = (m[3] * x + m[7] * y + m[11] * z + m[15]) || 1.0;\n        out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n        out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n        out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n        return out;\n    }\n    /**\n     * Transforms the vec3 with a mat3.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param m - the 3x3 matrix to transform with\n     * @returns `out`\n     */\n    static transformMat3(out, a, m) {\n        let x = a[0], y = a[1], z = a[2];\n        out[0] = x * m[0] + y * m[3] + z * m[6];\n        out[1] = x * m[1] + y * m[4] + z * m[7];\n        out[2] = x * m[2] + y * m[5] + z * m[8];\n        return out;\n    }\n    /**\n     * Transforms the vec3 with a quat\n     * Can also be used for dual quaternions. (Multiply it with the real part)\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param q - quaternion to transform with\n     * @returns `out`\n     */\n    static transformQuat(out, a, q) {\n        // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const w2 = q[3] * 2;\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        // var qvec = [qx, qy, qz];\n        // var uv = vec3.cross([], qvec, a);\n        const uvx = (qy * z - qz * y);\n        const uvy = (qz * x - qx * z);\n        const uvz = (qx * y - qy * x);\n        // var uuv = vec3.cross([], qvec, uv);\n        // vec3.scale(uuv, uuv, 2);\n        const uuvx = (qy * uvz - qz * uvy) * 2;\n        const uuvy = (qz * uvx - qx * uvz) * 2;\n        const uuvz = (qx * uvy - qy * uvx) * 2;\n        // vec3.scale(uv, uv, 2 * w);\n        // return vec3.add(out, a, vec3.add(out, uv, uuv));\n        out[0] = x + (uvx * w2) + uuvx;\n        out[1] = y + (uvy * w2) + uuvy;\n        out[2] = z + (uvz * w2) + uuvz;\n        return out;\n    }\n    /**\n     * Rotate a 3D vector around the x-axis\n     * @param out - The receiving vec3\n     * @param a - The vec3 point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotateX(out, a, b, rad) {\n        const by = b[1];\n        const bz = b[2];\n        //Translate point to the origin\n        const py = a[1] - by;\n        const pz = a[2] - bz;\n        //perform rotation\n        //translate to correct position\n        out[0] = a[0];\n        out[1] = (py * Math.cos(rad) - pz * Math.sin(rad)) + by;\n        out[2] = (py * Math.sin(rad) + pz * Math.cos(rad)) + bz;\n        return out;\n    }\n    /**\n     * Rotate a 3D vector around the y-axis\n     * @param out - The receiving vec3\n     * @param a - The vec3 point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotateY(out, a, b, rad) {\n        const bx = b[0];\n        const bz = b[2];\n        //Translate point to the origin\n        const px = a[0] - bx;\n        const pz = a[2] - bz;\n        //perform rotation\n        //translate to correct position\n        out[0] = (pz * Math.sin(rad) + px * Math.cos(rad)) + bx;\n        out[1] = a[1];\n        out[2] = (pz * Math.cos(rad) - px * Math.sin(rad)) + bz;\n        return out;\n    }\n    /**\n     * Rotate a 3D vector around the z-axis\n     * @param out - The receiving vec3\n     * @param a - The vec3 point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotateZ(out, a, b, rad) {\n        const bx = b[0];\n        const by = b[1];\n        //Translate point to the origin\n        const px = a[0] - bx;\n        const py = a[1] - by;\n        //perform rotation\n        //translate to correct position\n        out[0] = (px * Math.cos(rad) - py * Math.sin(rad)) + bx;\n        out[1] = (px * Math.sin(rad) + py * Math.cos(rad)) + by;\n        out[2] = b[2];\n        return out;\n    }\n    /**\n     * Get the angle between two 3D vectors\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns The angle in radians\n     */\n    static angle(a, b) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const bx = b[0];\n        const by = b[1];\n        const bz = b[2];\n        const mag = Math.sqrt((ax * ax + ay * ay + az * az) * (bx * bx + by * by + bz * bz));\n        const cosine = mag && Vec3.dot(a, b) / mag;\n        return Math.acos(Math.min(Math.max(cosine, -1), 1));\n    }\n    /**\n     * Set the components of a vec3 to zero\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @returns `out`\n     */\n    static zero(out) {\n        out[0] = 0.0;\n        out[1] = 0.0;\n        out[2] = 0.0;\n        return out;\n    }\n    /**\n     * Returns a string representation of a vector\n     * @category Static\n     *\n     * @param a - vector to represent as a string\n     * @returns string representation of the vector\n     */\n    static str(a) {\n        return `Vec3(${a.join(', ')})`;\n    }\n    /**\n     * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n    }\n    /**\n     * Returns whether or not the vectors have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)));\n    }\n}\nexport { Vec3 };\n// Instance method alias assignments\nVec3.prototype.sub = Vec3.prototype.subtract;\nVec3.prototype.mul = Vec3.prototype.multiply;\nVec3.prototype.div = Vec3.prototype.divide;\nVec3.prototype.dist = Vec3.prototype.distance;\nVec3.prototype.sqrDist = Vec3.prototype.squaredDistance;\n// Static method alias assignments\nVec3.sub = Vec3.subtract;\nVec3.mul = Vec3.multiply;\nVec3.div = Vec3.divide;\nVec3.dist = Vec3.distance;\nVec3.sqrDist = Vec3.squaredDistance;\nVec3.sqrLen = Vec3.squaredLength;\nVec3.mag = Vec3.magnitude;\nVec3.length = Vec3.magnitude;\nVec3.len = Vec3.magnitude;\n/**\n * Vec3 alias for backwards compatibility\n */\nexport const vec3 = Vec3;\n//# sourceMappingURL=vec3.js.map","import { EPSILON } from './common.js';\n/**\n * 4 Dimensional Vector\n */\nclass Vec4 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Vec4}.\n     */\n    static BYTE_LENGTH = 4 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Vec4}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 4:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 4);\n                break;\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v, v, v]);\n                }\n                else {\n                    super(v, 0, 4);\n                }\n                break;\n            }\n            default:\n                super(4);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    // Getters and setters to make component access read better.\n    // These are likely to be a little bit slower than direct array access.\n    /**\n     * The x component of the vector. Equivalent to `this[0];`\n     * @category Vector components\n     */\n    get x() { return this[0]; }\n    set x(value) { this[0] = value; }\n    /**\n     * The y component of the vector. Equivalent to `this[1];`\n     * @category Vector components\n     */\n    get y() { return this[1]; }\n    set y(value) { this[1] = value; }\n    /**\n     * The z component of the vector. Equivalent to `this[2];`\n     * @category Vector components\n     */\n    get z() { return this[2]; }\n    set z(value) { this[2] = value; }\n    /**\n     * The w component of the vector. Equivalent to `this[3];`\n     * @category Vector components\n     */\n    get w() { return this[3]; }\n    set w(value) { this[3] = value; }\n    // Alternate set of getters and setters in case this is being used to define\n    // a color.\n    /**\n     * The r component of the vector. Equivalent to `this[0];`\n     * @category Color components\n     */\n    get r() { return this[0]; }\n    set r(value) { this[0] = value; }\n    /**\n     * The g component of the vector. Equivalent to `this[1];`\n     * @category Color components\n     */\n    get g() { return this[1]; }\n    set g(value) { this[1] = value; }\n    /**\n     * The b component of the vector. Equivalent to `this[2];`\n     * @category Color components\n     */\n    get b() { return this[2]; }\n    set b(value) { this[2] = value; }\n    /**\n     * The a component of the vector. Equivalent to `this[3];`\n     * @category Color components\n     */\n    get a() { return this[3]; }\n    set a(value) { this[3] = value; }\n    /**\n     * The magnitude (length) of this.\n     * Equivalent to `Vec4.magnitude(this);`\n     *\n     * Magnitude is used because the `length` attribute is already defined by\n     * TypedArrays to mean the number of elements in the array.\n     */\n    get magnitude() {\n        const x = this[0];\n        const y = this[1];\n        const z = this[2];\n        const w = this[3];\n        return Math.sqrt(x * x + y * y + z * z + w * w);\n    }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     */\n    get mag() { return this.magnitude; }\n    /**\n     * A string representation of `this`\n     * Equivalent to `Vec4.str(this);`\n     */\n    get str() {\n        return Vec4.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Vec4} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        super.set(a);\n        return this;\n    }\n    /**\n     * Adds a {@link Vec4} to `this`.\n     * Equivalent to `Vec4.add(this, this, b);`\n     *\n     * @param b - The vector to add to `this`\n     * @returns `this`\n     */\n    add(b) {\n        this[0] += b[0];\n        this[1] += b[1];\n        this[2] += b[2];\n        this[3] += b[3];\n        return this;\n    }\n    /**\n     * Subtracts a {@link Vec4} from `this`.\n     * Equivalent to `Vec4.subtract(this, this, b);`\n     *\n     * @param b - The vector to subtract from `this`\n     * @returns `this`\n     */\n    subtract(b) {\n        this[0] -= b[0];\n        this[1] -= b[1];\n        this[2] -= b[2];\n        this[3] -= b[3];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec4.subtract}\n     */\n    sub(b) { return this; }\n    /**\n     * Multiplies `this` by a {@link Vec4}.\n     * Equivalent to `Vec4.multiply(this, this, b);`\n     *\n     * @param b - The vector to multiply `this` by\n     * @returns `this`\n     */\n    multiply(b) {\n        this[0] *= b[0];\n        this[1] *= b[1];\n        this[2] *= b[2];\n        this[3] *= b[3];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec4.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Divides `this` by a {@link Vec4}.\n     * Equivalent to `Vec4.divide(this, this, b);`\n     *\n     * @param b - The vector to divide `this` by\n     * @returns `this`\n     */\n    divide(b) {\n        this[0] /= b[0];\n        this[1] /= b[1];\n        this[2] /= b[2];\n        this[3] /= b[3];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec4.divide}\n     */\n    div(b) { return this; }\n    /**\n     * Scales `this` by a scalar number.\n     * Equivalent to `Vec4.scale(this, this, b);`\n     *\n     * @param b - Amount to scale `this` by\n     * @returns `this`\n     */\n    scale(b) {\n        this[0] *= b;\n        this[1] *= b;\n        this[2] *= b;\n        this[3] *= b;\n        return this;\n    }\n    /**\n     * Calculates `this` scaled by a scalar value then adds the result to `this`.\n     * Equivalent to `Vec4.scaleAndAdd(this, this, b, scale);`\n     *\n     * @param b - The vector to add to `this`\n     * @param scale - The amount to scale `b` by before adding\n     * @returns `this`\n     */\n    scaleAndAdd(b, scale) {\n        this[0] += b[0] * scale;\n        this[1] += b[1] * scale;\n        this[2] += b[2] * scale;\n        this[3] += b[3] * scale;\n        return this;\n    }\n    /**\n     * Calculates the euclidian distance between another {@link Vec4} and `this`.\n     * Equivalent to `Vec4.distance(this, b);`\n     *\n     * @param b - The vector to calculate the distance to\n     * @returns Distance between `this` and `b`\n     */\n    distance(b) {\n        return Vec4.distance(this, b);\n    }\n    /**\n     * Alias for {@link Vec4.distance}\n     */\n    dist(b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between another {@link Vec4} and `this`.\n     * Equivalent to `Vec4.squaredDistance(this, b);`\n     *\n     * @param b The vector to calculate the squared distance to\n     * @returns Squared distance between `this` and `b`\n     */\n    squaredDistance(b) {\n        return Vec4.squaredDistance(this, b);\n    }\n    /**\n     * Alias for {@link Vec4.squaredDistance}\n     */\n    sqrDist(b) { return 0; }\n    /**\n     * Negates the components of `this`.\n     * Equivalent to `Vec4.negate(this, this);`\n     *\n     * @returns `this`\n     */\n    negate() {\n        this[0] *= -1;\n        this[1] *= -1;\n        this[2] *= -1;\n        this[3] *= -1;\n        return this;\n    }\n    /**\n     * Inverts the components of `this`.\n     * Equivalent to `Vec4.inverse(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        this[0] = 1.0 / this[0];\n        this[1] = 1.0 / this[1];\n        this[2] = 1.0 / this[2];\n        this[3] = 1.0 / this[3];\n        return this;\n    }\n    /**\n     * Sets each component of `this` to it's absolute value.\n     * Equivalent to `Vec4.abs(this, this);`\n     *\n     * @returns `this`\n     */\n    abs() {\n        this[0] = Math.abs(this[0]);\n        this[1] = Math.abs(this[1]);\n        this[2] = Math.abs(this[2]);\n        this[3] = Math.abs(this[3]);\n        return this;\n    }\n    /**\n     * Calculates the dot product of this and another {@link Vec4}.\n     * Equivalent to `Vec4.dot(this, b);`\n     *\n     * @param b - The second operand\n     * @returns Dot product of `this` and `b`\n     */\n    dot(b) {\n        return this[0] * b[0] + this[1] * b[1] + this[2] * b[2] + this[3] * b[3];\n    }\n    /**\n     * Normalize `this`.\n     * Equivalent to `Vec4.normalize(this, this);`\n     *\n     * @returns `this`\n     */\n    normalize() {\n        return Vec4.normalize(this, this);\n    }\n    //===================\n    // Static methods\n    //===================\n    /**\n     * Creates a new, empty {@link Vec4}\n     * @category Static\n     *\n     * @returns a new 4D vector\n     */\n    static create() {\n        return new Vec4();\n    }\n    /**\n     * Creates a new {@link Vec4} initialized with values from an existing vector\n     * @category Static\n     *\n     * @param a - vector to clone\n     * @returns a new 4D vector\n     */\n    static clone(a) {\n        return new Vec4(a);\n    }\n    /**\n     * Creates a new {@link Vec4} initialized with the given values\n     * @category Static\n     *\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @param w - W component\n     * @returns a new 4D vector\n     */\n    static fromValues(x, y, z, w) {\n        return new Vec4(x, y, z, w);\n    }\n    /**\n     * Copy the values from one {@link Vec4} to another\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the source vector\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Set the components of a {@link Vec4} to the given values\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @param w - W component\n     * @returns `out`\n     */\n    static set(out, x, y, z, w) {\n        out[0] = x;\n        out[1] = y;\n        out[2] = z;\n        out[3] = w;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec4}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        return out;\n    }\n    /**\n     * Subtracts vector b from vector a\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec4.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiplies two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        out[0] = a[0] * b[0];\n        out[1] = a[1] * b[1];\n        out[2] = a[2] * b[2];\n        out[3] = a[3] * b[3];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec4.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Divides two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static divide(out, a, b) {\n        out[0] = a[0] / b[0];\n        out[1] = a[1] / b[1];\n        out[2] = a[2] / b[2];\n        out[3] = a[3] / b[3];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec4.divide}\n     * @category Static\n     */\n    static div(out, a, b) { return out; }\n    /**\n     * Math.ceil the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to ceil\n     * @returns `out`\n     */\n    static ceil(out, a) {\n        out[0] = Math.ceil(a[0]);\n        out[1] = Math.ceil(a[1]);\n        out[2] = Math.ceil(a[2]);\n        out[3] = Math.ceil(a[3]);\n        return out;\n    }\n    /**\n     * Math.floor the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to floor\n     * @returns `out`\n     */\n    static floor(out, a) {\n        out[0] = Math.floor(a[0]);\n        out[1] = Math.floor(a[1]);\n        out[2] = Math.floor(a[2]);\n        out[3] = Math.floor(a[3]);\n        return out;\n    }\n    /**\n     * Returns the minimum of two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static min(out, a, b) {\n        out[0] = Math.min(a[0], b[0]);\n        out[1] = Math.min(a[1], b[1]);\n        out[2] = Math.min(a[2], b[2]);\n        out[3] = Math.min(a[3], b[3]);\n        return out;\n    }\n    /**\n     * Returns the maximum of two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static max(out, a, b) {\n        out[0] = Math.max(a[0], b[0]);\n        out[1] = Math.max(a[1], b[1]);\n        out[2] = Math.max(a[2], b[2]);\n        out[3] = Math.max(a[3], b[3]);\n        return out;\n    }\n    /**\n     * Math.round the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to round\n     * @returns `out`\n     */\n    static round(out, a) {\n        out[0] = Math.round(a[0]);\n        out[1] = Math.round(a[1]);\n        out[2] = Math.round(a[2]);\n        out[3] = Math.round(a[3]);\n        return out;\n    }\n    /**\n     * Scales a {@link Vec4} by a scalar number\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to scale\n     * @param scale - amount to scale the vector by\n     * @returns `out`\n     */\n    static scale(out, a, scale) {\n        out[0] = a[0] * scale;\n        out[1] = a[1] * scale;\n        out[2] = a[2] * scale;\n        out[3] = a[3] * scale;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec4}'s after scaling the second operand by a scalar value\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b by before adding\n     * @returns `out`\n     */\n    static scaleAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        return out;\n    }\n    /**\n     * Calculates the euclidian distance between two {@link Vec4}'s\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns distance between a and b\n     */\n    static distance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        const w = b[3] - a[3];\n        return Math.hypot(x, y, z, w);\n    }\n    /**\n     * Alias for {@link Vec4.distance}\n     * @category Static\n     */\n    static dist(a, b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between two {@link Vec4}'s\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns squared distance between a and b\n     */\n    static squaredDistance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        const w = b[3] - a[3];\n        return x * x + y * y + z * z + w * w;\n    }\n    /**\n     * Alias for {@link Vec4.squaredDistance}\n     * @category Static\n     */\n    static sqrDist(a, b) { return 0; }\n    /**\n     * Calculates the magnitude (length) of a {@link Vec4}\n     * @category Static\n     *\n     * @param a - vector to calculate length of\n     * @returns length of `a`\n     */\n    static magnitude(a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        return Math.sqrt(x * x + y * y + z * z + w * w);\n    }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec4.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec4.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Calculates the squared length of a {@link Vec4}\n     * @category Static\n     *\n     * @param a - vector to calculate squared length of\n     * @returns squared length of a\n     */\n    static squaredLength(a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        return x * x + y * y + z * z + w * w;\n    }\n    /**\n     * Alias for {@link Vec4.squaredLength}\n     * @category Static\n     */\n    static sqrLen(a) { return 0; }\n    /**\n     * Negates the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to negate\n     * @returns `out`\n     */\n    static negate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        out[3] = -a[3];\n        return out;\n    }\n    /**\n     * Returns the inverse of the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to invert\n     * @returns `out`\n     */\n    static inverse(out, a) {\n        out[0] = 1.0 / a[0];\n        out[1] = 1.0 / a[1];\n        out[2] = 1.0 / a[2];\n        out[3] = 1.0 / a[3];\n        return out;\n    }\n    /**\n     * Returns the absolute value of the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to compute the absolute values of\n     * @returns `out`\n     */\n    static abs(out, a) {\n        out[0] = Math.abs(a[0]);\n        out[1] = Math.abs(a[1]);\n        out[2] = Math.abs(a[2]);\n        out[3] = Math.abs(a[3]);\n        return out;\n    }\n    /**\n     * Normalize a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        let len = x * x + y * y + z * z + w * w;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n        }\n        out[0] = x * len;\n        out[1] = y * len;\n        out[2] = z * len;\n        out[3] = w * len;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two {@link Vec4}'s\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns dot product of a and b\n     */\n    static dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n    }\n    /**\n     * Returns the cross-product of three vectors in a 4-dimensional space\n     * @category Static\n     *\n     * @param out the receiving vector\n     * @param u - the first vector\n     * @param v - the second vector\n     * @param w - the third vector\n     * @returns result\n     */\n    static cross(out, u, v, w) {\n        const a = v[0] * w[1] - v[1] * w[0];\n        const b = v[0] * w[2] - v[2] * w[0];\n        const c = v[0] * w[3] - v[3] * w[0];\n        const d = v[1] * w[2] - v[2] * w[1];\n        const e = v[1] * w[3] - v[3] * w[1];\n        const f = v[2] * w[3] - v[3] * w[2];\n        const g = u[0];\n        const h = u[1];\n        const i = u[2];\n        const j = u[3];\n        out[0] = h * f - i * e + j * d;\n        out[1] = -(g * f) + i * c - j * b;\n        out[2] = g * e - h * c + j * a;\n        out[3] = -(g * d) + h * b - i * a;\n        return out;\n    }\n    /**\n     * Performs a linear interpolation between two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        out[0] = ax + t * (b[0] - ax);\n        out[1] = ay + t * (b[1] - ay);\n        out[2] = az + t * (b[2] - az);\n        out[3] = aw + t * (b[3] - aw);\n        return out;\n    }\n    /**\n     * Generates a random vector with the given scale\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param [scale] - Length of the resulting vector. If ommitted, a unit vector will be returned\n     * @returns `out`\n     */\n    /*static random(out: Vec4Like, scale): Vec4Like {\n      scale = scale || 1.0;\n  \n      // Marsaglia, George. Choosing a Point from the Surface of a\n      // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n      // http://projecteuclid.org/euclid.aoms/1177692644;\n      var v1, v2, v3, v4;\n      var s1, s2;\n      do {\n        v1 = glMatrix.RANDOM() * 2 - 1;\n        v2 = glMatrix.RANDOM() * 2 - 1;\n        s1 = v1 * v1 + v2 * v2;\n      } while (s1 >= 1);\n      do {\n        v3 = glMatrix.RANDOM() * 2 - 1;\n        v4 = glMatrix.RANDOM() * 2 - 1;\n        s2 = v3 * v3 + v4 * v4;\n      } while (s2 >= 1);\n  \n      var d = Math.sqrt((1 - s1) / s2);\n      out[0] = scale * v1;\n      out[1] = scale * v2;\n      out[2] = scale * v3 * d;\n      out[3] = scale * v4 * d;\n      return out;\n    }*/\n    /**\n     * Transforms the {@link Vec4} with a {@link Mat4}.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param m - matrix to transform with\n     * @returns `out`\n     */\n    static transformMat4(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n        out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n        out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n        out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec4} with a {@link Quat}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param q - quaternion to transform with\n     * @returns `out`\n     */\n    static transformQuat(out, a, q) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const qw = q[3];\n        // calculate quat * vec\n        const ix = qw * x + qy * z - qz * y;\n        const iy = qw * y + qz * x - qx * z;\n        const iz = qw * z + qx * y - qy * x;\n        const iw = -qx * x - qy * y - qz * z;\n        // calculate result * inverse quat\n        out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n        out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n        out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Set the components of a {@link Vec4} to zero\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @returns `out`\n     */\n    static zero(out) {\n        out[0] = 0.0;\n        out[1] = 0.0;\n        out[2] = 0.0;\n        out[3] = 0.0;\n        return out;\n    }\n    /**\n     * Returns a string representation of a {@link Vec4}\n     * @category Static\n     *\n     * @param a - vector to represent as a string\n     * @returns string representation of the vector\n     */\n    static str(a) {\n        return `Vec4(${a.join(', ')})`;\n    }\n    /**\n     * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n    }\n    /**\n     * Returns whether or not the vectors have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)));\n    }\n}\nexport { Vec4 };\n// Instance method alias assignments\nVec4.prototype.sub = Vec4.prototype.subtract;\nVec4.prototype.mul = Vec4.prototype.multiply;\nVec4.prototype.div = Vec4.prototype.divide;\nVec4.prototype.dist = Vec4.prototype.distance;\nVec4.prototype.sqrDist = Vec4.prototype.squaredDistance;\n// Static method alias assignments\nVec4.sub = Vec4.subtract;\nVec4.mul = Vec4.multiply;\nVec4.div = Vec4.divide;\nVec4.dist = Vec4.distance;\nVec4.sqrDist = Vec4.squaredDistance;\nVec4.sqrLen = Vec4.squaredLength;\nVec4.mag = Vec4.magnitude;\nVec4.length = Vec4.magnitude;\nVec4.len = Vec4.magnitude;\n/**\n * Vec4 alias for backwards compatibility\n */\nexport const vec4 = Vec4;\n//# sourceMappingURL=vec4.js.map","import { EPSILON } from './common.js';\n/**\n * 2 Dimensional Vector\n */\nclass Vec2 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Vec2}.\n     */\n    static BYTE_LENGTH = 2 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Vec2}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 2: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, values[1]]);\n                }\n                else {\n                    super(v, values[1], 2);\n                }\n                break;\n            }\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v]);\n                }\n                else {\n                    super(v, 0, 2);\n                }\n                break;\n            }\n            default:\n                super(2);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    // Getters and setters to make component access read better.\n    // These are likely to be a little bit slower than direct array access.\n    /**\n     * The x component of the vector. Equivalent to `this[0];`\n     * @category Vector components\n     */\n    get x() { return this[0]; }\n    set x(value) { this[0] = value; }\n    /**\n     * The y component of the vector. Equivalent to `this[1];`\n     * @category Vector components\n     */\n    get y() { return this[1]; }\n    set y(value) { this[1] = value; }\n    // Alternate set of getters and setters in case this is being used to define\n    // a color.\n    /**\n     * The r component of the vector. Equivalent to `this[0];`\n     * @category Color components\n     */\n    get r() { return this[0]; }\n    set r(value) { this[0] = value; }\n    /**\n     * The g component of the vector. Equivalent to `this[1];`\n     * @category Color components\n     */\n    get g() { return this[1]; }\n    set g(value) { this[1] = value; }\n    /**\n     * The magnitude (length) of this.\n     * Equivalent to `Vec2.magnitude(this);`\n     *\n     * Magnitude is used because the `length` attribute is already defined by\n     * TypedArrays to mean the number of elements in the array.\n     */\n    get magnitude() {\n        return Math.hypot(this[0], this[1]);\n    }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     */\n    get mag() { return this.magnitude; }\n    /**\n     * The squared magnitude (length) of `this`.\n     * Equivalent to `Vec2.squaredMagnitude(this);`\n     */\n    get squaredMagnitude() {\n        const x = this[0];\n        const y = this[1];\n        return x * x + y * y;\n    }\n    /**\n     * Alias for {@link Vec2.squaredMagnitude}\n     */\n    get sqrMag() { return this.squaredMagnitude; }\n    /**\n     * A string representation of `this`\n     * Equivalent to `Vec2.str(this);`\n     */\n    get str() {\n        return Vec2.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Vec2} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    // Instead of zero(), use a.fill(0) for instances;\n    /**\n     * Adds a {@link Vec2} to `this`.\n     * Equivalent to `Vec2.add(this, this, b);`\n     *\n     * @param b - The vector to add to `this`\n     * @returns `this`\n     */\n    add(b) {\n        this[0] += b[0];\n        this[1] += b[1];\n        return this;\n    }\n    /**\n     * Subtracts a {@link Vec2} from `this`.\n     * Equivalent to `Vec2.subtract(this, this, b);`\n     *\n     * @param b - The vector to subtract from `this`\n     * @returns `this`\n     */\n    subtract(b) {\n        this[0] -= b[0];\n        this[1] -= b[1];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec2.subtract}\n     */\n    sub(b) { return this; }\n    /**\n     * Multiplies `this` by a {@link Vec2}.\n     * Equivalent to `Vec2.multiply(this, this, b);`\n     *\n     * @param b - The vector to multiply `this` by\n     * @returns `this`\n     */\n    multiply(b) {\n        this[0] *= b[0];\n        this[1] *= b[1];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec2.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Divides `this` by a {@link Vec2}.\n     * Equivalent to `Vec2.divide(this, this, b);`\n     *\n     * @param b - The vector to divide `this` by\n     * @returns {Vec2} `this`\n     */\n    divide(b) {\n        this[0] /= b[0];\n        this[1] /= b[1];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec2.divide}\n     */\n    div(b) { return this; }\n    /**\n     * Scales `this` by a scalar number.\n     * Equivalent to `Vec2.scale(this, this, b);`\n     *\n     * @param b - Amount to scale `this` by\n     * @returns `this`\n     */\n    scale(b) {\n        this[0] *= b;\n        this[1] *= b;\n        return this;\n    }\n    /**\n     * Calculates `this` scaled by a scalar value then adds the result to `this`.\n     * Equivalent to `Vec2.scaleAndAdd(this, this, b, scale);`\n     *\n     * @param b - The vector to add to `this`\n     * @param scale - The amount to scale `b` by before adding\n     * @returns `this`\n     */\n    scaleAndAdd(b, scale) {\n        this[0] += b[0] * scale;\n        this[1] += b[1] * scale;\n        return this;\n    }\n    /**\n     * Calculates the euclidian distance between another {@link Vec2} and `this`.\n     * Equivalent to `Vec2.distance(this, b);`\n     *\n     * @param b - The vector to calculate the distance to\n     * @returns Distance between `this` and `b`\n     */\n    distance(b) {\n        return Vec2.distance(this, b);\n    }\n    /**\n     * Alias for {@link Vec2.distance}\n     */\n    dist(b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between another {@link Vec2} and `this`.\n     * Equivalent to `Vec2.squaredDistance(this, b);`\n     *\n     * @param b The vector to calculate the squared distance to\n     * @returns Squared distance between `this` and `b`\n     */\n    squaredDistance(b) {\n        return Vec2.squaredDistance(this, b);\n    }\n    /**\n     * Alias for {@link Vec2.squaredDistance}\n     */\n    sqrDist(b) { return 0; }\n    /**\n     * Negates the components of `this`.\n     * Equivalent to `Vec2.negate(this, this);`\n     *\n     * @returns `this`\n     */\n    negate() {\n        this[0] *= -1;\n        this[1] *= -1;\n        return this;\n    }\n    /**\n     * Inverts the components of `this`.\n     * Equivalent to `Vec2.inverse(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        this[0] = 1.0 / this[0];\n        this[1] = 1.0 / this[1];\n        return this;\n    }\n    /**\n     * Sets each component of `this` to it's absolute value.\n     * Equivalent to `Vec2.abs(this, this);`\n     *\n     * @returns `this`\n     */\n    abs() {\n        this[0] = Math.abs(this[0]);\n        this[1] = Math.abs(this[1]);\n        return this;\n    }\n    /**\n     * Calculates the dot product of this and another {@link Vec2}.\n     * Equivalent to `Vec2.dot(this, b);`\n     *\n     * @param b - The second operand\n     * @returns Dot product of `this` and `b`\n     */\n    dot(b) {\n        return this[0] * b[0] + this[1] * b[1];\n    }\n    /**\n     * Normalize `this`.\n     * Equivalent to `Vec2.normalize(this, this);`\n     *\n     * @returns `this`\n     */\n    normalize() {\n        return Vec2.normalize(this, this);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, empty {@link Vec2}\n     * @category Static\n     *\n     * @returns A new 2D vector\n     */\n    static create() {\n        return new Vec2();\n    }\n    /**\n     * Creates a new {@link Vec2} initialized with values from an existing vector\n     * @category Static\n     *\n     * @param a - Vector to clone\n     * @returns A new 2D vector\n     */\n    static clone(a) {\n        return new Vec2(a);\n    }\n    /**\n     * Creates a new {@link Vec2} initialized with the given values\n     * @category Static\n     *\n     * @param x - X component\n     * @param y - Y component\n     * @returns A new 2D vector\n     */\n    static fromValues(x, y) {\n        return new Vec2(x, y);\n    }\n    /**\n     * Copy the values from one {@link Vec2} to another\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - The source vector\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        return out;\n    }\n    /**\n     * Set the components of a {@link Vec2} to the given values\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param x - X component\n     * @param y - Y component\n     * @returns `out`\n     */\n    static set(out, x, y) {\n        out[0] = x;\n        out[1] = y;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        return out;\n    }\n    /**\n     * Subtracts vector b from vector a\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec2.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return [0, 0]; }\n    /**\n     * Multiplies two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        out[0] = a[0] * b[0];\n        out[1] = a[1] * b[1];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec2.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return [0, 0]; }\n    /**\n     * Divides two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static divide(out, a, b) {\n        out[0] = a[0] / b[0];\n        out[1] = a[1] / b[1];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec2.divide}\n     * @category Static\n     */\n    static div(out, a, b) { return [0, 0]; }\n    /**\n     * Math.ceil the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to ceil\n     * @returns `out`\n     */\n    static ceil(out, a) {\n        out[0] = Math.ceil(a[0]);\n        out[1] = Math.ceil(a[1]);\n        return out;\n    }\n    /**\n     * Math.floor the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to floor\n     * @returns `out`\n     */\n    static floor(out, a) {\n        out[0] = Math.floor(a[0]);\n        out[1] = Math.floor(a[1]);\n        return out;\n    }\n    /**\n     * Returns the minimum of two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static min(out, a, b) {\n        out[0] = Math.min(a[0], b[0]);\n        out[1] = Math.min(a[1], b[1]);\n        return out;\n    }\n    /**\n     * Returns the maximum of two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static max(out, a, b) {\n        out[0] = Math.max(a[0], b[0]);\n        out[1] = Math.max(a[1], b[1]);\n        return out;\n    }\n    /**\n     * Math.round the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to round\n     * @returns `out`\n     */\n    static round(out, a) {\n        out[0] = Math.round(a[0]);\n        out[1] = Math.round(a[1]);\n        return out;\n    }\n    /**\n     * Scales a {@link Vec2} by a scalar number\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to scale\n     * @param b - Amount to scale the vector by\n     * @returns `out`\n     */\n    static scale(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        return out;\n    }\n    /**\n     * Adds two Vec2's after scaling the second operand by a scalar value\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @param scale - The amount to scale b by before adding\n     * @returns `out`\n     */\n    static scaleAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        return out;\n    }\n    /**\n     * Calculates the euclidian distance between two {@link Vec2}s\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns distance between `a` and `b`\n     */\n    static distance(a, b) {\n        return Math.hypot(b[0] - a[0], b[1] - a[1]);\n    }\n    /**\n     * Alias for {@link Vec2.distance}\n     * @category Static\n     */\n    static dist(a, b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between two {@link Vec2}s\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns Squared distance between `a` and `b`\n     */\n    static squaredDistance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        return x * x + y * y;\n    }\n    /**\n     * Alias for {@link Vec2.distance}\n     * @category Static\n     */\n    static sqrDist(a, b) { return 0; }\n    /**\n     * Calculates the magnitude (length) of a {@link Vec2}\n     * @category Static\n     *\n     * @param a - Vector to calculate magnitude of\n     * @returns Magnitude of a\n     */\n    static magnitude(a) {\n        let x = a[0];\n        let y = a[1];\n        return Math.sqrt(x * x + y * y);\n    }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec2.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     *\n     * @param a - vector to calculate length of\n     * @returns length of a\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec2.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Calculates the squared length of a {@link Vec2}\n     * @category Static\n     *\n     * @param a - Vector to calculate squared length of\n     * @returns Squared length of a\n     */\n    static squaredLength(a) {\n        const x = a[0];\n        const y = a[1];\n        return x * x + y * y;\n    }\n    /**\n     * Alias for {@link Vec2.squaredLength}\n     */\n    static sqrLen(a, b) { return 0; }\n    /**\n     * Negates the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to negate\n     * @returns `out`\n     */\n    static negate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        return out;\n    }\n    /**\n     * Returns the inverse of the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to invert\n     * @returns `out`\n     */\n    static inverse(out, a) {\n        out[0] = 1.0 / a[0];\n        out[1] = 1.0 / a[1];\n        return out;\n    }\n    /**\n     * Returns the absolute value of the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to compute the absolute values of\n     * @returns `out`\n     */\n    static abs(out, a) {\n        out[0] = Math.abs(a[0]);\n        out[1] = Math.abs(a[1]);\n        return out;\n    }\n    /**\n     * Normalize a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) {\n        const x = a[0];\n        const y = a[1];\n        let len = x * x + y * y;\n        if (len > 0) {\n            //TODO: evaluate use of glm_invsqrt here?\n            len = 1 / Math.sqrt(len);\n        }\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two {@link Vec2}s\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns Dot product of `a` and `b`\n     */\n    static dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1];\n    }\n    /**\n     * Computes the cross product of two {@link Vec2}s\n     * Note that the cross product must by definition produce a 3D vector.\n     * For this reason there is also not instance equivalent for this function.\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static cross(out, a, b) {\n        const z = a[0] * b[1] - a[1] * b[0];\n        out[0] = out[1] = 0;\n        out[2] = z;\n        return out;\n    }\n    /**\n     * Performs a linear interpolation between two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @param t - Interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) {\n        const ax = a[0];\n        const ay = a[1];\n        out[0] = ax + t * (b[0] - ax);\n        out[1] = ay + t * (b[1] - ay);\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat2}\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat2(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[2] * y;\n        out[1] = m[1] * x + m[3] * y;\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat2d}\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat2d(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[2] * y + m[4];\n        out[1] = m[1] * x + m[3] * y + m[5];\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat3}\n     * 3rd vector component is implicitly '1'\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat3(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[3] * y + m[6];\n        out[1] = m[1] * x + m[4] * y + m[7];\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat4}\n     * 3rd vector component is implicitly '0'\n     * 4th vector component is implicitly '1'\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat4(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[4] * y + m[12];\n        out[1] = m[1] * x + m[5] * y + m[13];\n        return out;\n    }\n    /**\n     * Rotate a 2D vector\n     * @category Static\n     *\n     * @param out - The receiving {@link Vec2}\n     * @param a - The {@link Vec2} point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotate(out, a, b, rad) {\n        //Translate point to the origin\n        const p0 = a[0] - b[0];\n        const p1 = a[1] - b[1];\n        const sinC = Math.sin(rad);\n        const cosC = Math.cos(rad);\n        //perform rotation and translate to correct position\n        out[0] = p0 * cosC - p1 * sinC + b[0];\n        out[1] = p0 * sinC + p1 * cosC + b[1];\n        return out;\n    }\n    /**\n     * Get the angle between two 2D vectors\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns The angle in radians\n     */\n    static angle(a, b) {\n        const x1 = a[0];\n        const y1 = a[1];\n        const x2 = b[0];\n        const y2 = b[1];\n        // mag is the product of the magnitudes of a and b\n        const mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2);\n        // mag &&.. short circuits if mag == 0\n        const cosine = mag && (x1 * x2 + y1 * y2) / mag;\n        // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n        return Math.acos(Math.min(Math.max(cosine, -1), 1));\n    }\n    /**\n     * Set the components of a {@link Vec2} to zero\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @returns `out`\n     */\n    static zero(out) {\n        out[0] = 0.0;\n        out[1] = 0.0;\n        return out;\n    }\n    /**\n     * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns `true` if the vectors components are ===, `false` otherwise.\n     */\n    static exactEquals(a, b) {\n        return a[0] === b[0] && a[1] === b[1];\n    }\n    /**\n     * Returns whether or not the vectors have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns `true` if the vectors are approximately equal, `false` otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const b0 = b[0];\n        const b1 = b[1];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)));\n    }\n    /**\n     * Returns a string representation of a vector\n     * @category Static\n     *\n     * @param a - Vector to represent as a string\n     * @returns String representation of the vector\n     */\n    static str(a) {\n        return `Vec2(${a.join(', ')})`;\n    }\n}\nexport { Vec2 };\n// Instance method alias assignments\nVec2.prototype.sub = Vec2.prototype.subtract;\nVec2.prototype.mul = Vec2.prototype.multiply;\nVec2.prototype.div = Vec2.prototype.divide;\nVec2.prototype.dist = Vec2.prototype.distance;\nVec2.prototype.sqrDist = Vec2.prototype.squaredDistance;\n// Static method alias assignments\nVec2.sub = Vec2.subtract;\nVec2.mul = Vec2.multiply;\nVec2.div = Vec2.divide;\nVec2.dist = Vec2.distance;\nVec2.sqrDist = Vec2.squaredDistance;\nVec2.sqrLen = Vec2.squaredLength;\nVec2.mag = Vec2.magnitude;\nVec2.length = Vec2.magnitude;\nVec2.len = Vec2.magnitude;\n/**\n * Vec2 alias for backwards compatibility\n */\nexport const vec2 = Vec2;\n//# sourceMappingURL=vec2.js.map","export function loadImage(imageUrl: string): Promise<HTMLImageElement> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst img = document.createElement(\"img\");\n\t\timg.onload = () => resolve(img);\n\t\timg.onerror = reject;\n\t\timg.src = imageUrl;\n\t\timg.crossOrigin = \"anonymous\";\n\t\timg.loading = \"eager\";\n\t});\n}\n\nexport function loadVideo(videoUrl: string): Promise<HTMLVideoElement> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst video = document.createElement(\"video\");\n\t\tlet playing = false;\n\t\tlet timeupdate = false;\n\t\tlet rejected = false;\n\t\tvideo.addEventListener(\n\t\t\t\"playing\",\n\t\t\t() => {\n\t\t\t\tplaying = true;\n\t\t\t\tcheckReady();\n\t\t\t},\n\t\t\ttrue,\n\t\t);\n\t\tvideo.addEventListener(\n\t\t\t\"timeupdate\",\n\t\t\t() => {\n\t\t\t\ttimeupdate = true;\n\t\t\t\tcheckReady();\n\t\t\t},\n\t\t\ttrue,\n\t\t);\n\t\tvideo.addEventListener(\n\t\t\t\"error\",\n\t\t\t(err) => {\n\t\t\t\trejected = true;\n\t\t\t\treject(err);\n\t\t\t},\n\t\t\ttrue,\n\t\t);\n\t\tfunction checkReady() {\n\t\t\tif (playing && timeupdate && !rejected) {\n\t\t\t\tresolve(video);\n\t\t\t}\n\t\t}\n\t\tvideo.src = videoUrl;\n\t\tvideo.playsInline = true;\n\t\tvideo.crossOrigin = \"anonymous\";\n\t\tvideo.autoplay = true;\n\t\tvideo.loop = true;\n\t\tvideo.muted = true;\n\t\tvideo.play();\n\t});\n}\n\nexport function loadResourceFromUrl(\n\turl: string,\n\tisVideo = false,\n): Promise<HTMLImageElement | HTMLVideoElement> {\n\treturn isVideo ? loadVideo(url) : loadImage(url);\n}\n\nexport function loadResourceFromElement(\n\telement: HTMLImageElement | HTMLVideoElement,\n): Promise<HTMLImageElement | HTMLVideoElement> {\n\treturn new Promise((resolve, reject) => {\n\t\tif (\n\t\t\telement instanceof HTMLImageElement\n\t\t\t\t? element.complete\n\t\t\t\t: element.readyState >= 3\n\t\t) {\n\t\t\tresolve(element);\n\t\t} else {\n\t\t\telement.onload = () => resolve(element);\n\t\t\telement.onerror = reject;\n\t\t}\n\t});\n}\n","export function blurImage(\n\timageData: ImageData,\n\tradius: number,\n\tquality: number,\n) {\n\tconst pixels = imageData.data;\n\tconst width = imageData.width;\n\tconst height = imageData.height;\n\n\tlet rsum: number;\n\tlet gsum: number;\n\tlet bsum: number;\n\tlet asum: number;\n\tlet x: number;\n\tlet y: number;\n\tlet i: number;\n\tlet p: number;\n\tlet p1: number;\n\tlet p2: number;\n\tlet yp: number;\n\tlet yi: number;\n\tlet yw: number;\n\tconst wm = width - 1;\n\tconst hm = height - 1;\n\tconst rad1x = radius + 1;\n\tconst divx = radius + rad1x;\n\tconst rad1y = radius + 1;\n\tconst divy = radius + rad1y;\n\tconst div2 = 1 / (divx * divy);\n\n\tconst r: number[] = [];\n\tconst g: number[] = [];\n\tconst b: number[] = [];\n\tconst a: number[] = [];\n\n\tconst vmin: number[] = [];\n\tconst vmax: number[] = [];\n\n\twhile (quality-- > 0) {\n\t\tyw = yi = 0;\n\n\t\tfor (y = 0; y < height; y++) {\n\t\t\trsum = pixels[yw] * rad1x;\n\t\t\tgsum = pixels[yw + 1] * rad1x;\n\t\t\tbsum = pixels[yw + 2] * rad1x;\n\t\t\tasum = pixels[yw + 3] * rad1x;\n\n\t\t\tfor (i = 1; i <= radius; i++) {\n\t\t\t\tp = yw + ((i > wm ? wm : i) << 2);\n\t\t\t\trsum += pixels[p++];\n\t\t\t\tgsum += pixels[p++];\n\t\t\t\tbsum += pixels[p++];\n\t\t\t\tasum += pixels[p];\n\t\t\t}\n\n\t\t\tfor (x = 0; x < width; x++) {\n\t\t\t\tr[yi] = rsum;\n\t\t\t\tg[yi] = gsum;\n\t\t\t\tb[yi] = bsum;\n\t\t\t\ta[yi] = asum;\n\n\t\t\t\tif (y === 0) {\n\t\t\t\t\tvmin[x] = Math.min(x + rad1x, wm) << 2;\n\t\t\t\t\tvmax[x] = Math.max(x - radius, 0) << 2;\n\t\t\t\t}\n\n\t\t\t\tp1 = yw + vmin[x];\n\t\t\t\tp2 = yw + vmax[x];\n\n\t\t\t\trsum += pixels[p1++] - pixels[p2++];\n\t\t\t\tgsum += pixels[p1++] - pixels[p2++];\n\t\t\t\tbsum += pixels[p1++] - pixels[p2++];\n\t\t\t\tasum += pixels[p1] - pixels[p2];\n\n\t\t\t\tyi++;\n\t\t\t}\n\t\t\tyw += width << 2;\n\t\t}\n\n\t\tfor (x = 0; x < width; x++) {\n\t\t\typ = x;\n\t\t\trsum = r[yp] * rad1y;\n\t\t\tgsum = g[yp] * rad1y;\n\t\t\tbsum = b[yp] * rad1y;\n\t\t\tasum = a[yp] * rad1y;\n\n\t\t\tfor (i = 1; i <= radius; i++) {\n\t\t\t\typ += i > hm ? 0 : width;\n\t\t\t\trsum += r[yp];\n\t\t\t\tgsum += g[yp];\n\t\t\t\tbsum += b[yp];\n\t\t\t\tasum += a[yp];\n\t\t\t}\n\n\t\t\tyi = x << 2;\n\t\t\tfor (y = 0; y < height; y++) {\n\t\t\t\tpixels[yi] = (rsum * div2 + 0.5) | 0;\n\t\t\t\tpixels[yi + 1] = (gsum * div2 + 0.5) | 0;\n\t\t\t\tpixels[yi + 2] = (bsum * div2 + 0.5) | 0;\n\t\t\t\tpixels[yi + 3] = (asum * div2 + 0.5) | 0;\n\n\t\t\t\tif (x === 0) {\n\t\t\t\t\tvmin[y] = Math.min(y + rad1y, hm) * width;\n\t\t\t\t\tvmax[y] = Math.max(y - radius, 0) * width;\n\t\t\t\t}\n\n\t\t\t\tp1 = x + vmin[y];\n\t\t\t\tp2 = x + vmax[y];\n\n\t\t\t\trsum += r[p1] - r[p2];\n\t\t\t\tgsum += g[p1] - g[p2];\n\t\t\t\tbsum += b[p1] - b[p2];\n\t\t\t\tasum += a[p1] - a[p2];\n\n\t\t\t\tyi += width << 2;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function saturateImage(imageData: ImageData, saturation: number) {\n\tconst pixels = imageData.data;\n\n\tfor (let i = 0; i < pixels.length; i += 4) {\n\t\tconst r = pixels[i];\n\t\tconst g = pixels[i + 1];\n\t\tconst b = pixels[i + 2];\n\t\tconst a = pixels[i + 3];\n\t\tconst gray = r * 0.3 + g * 0.59 + b * 0.11;\n\t\tpixels[i] = gray * (1 - saturation) + r * saturation;\n\t\tpixels[i + 1] = gray * (1 - saturation) + g * saturation;\n\t\tpixels[i + 2] = gray * (1 - saturation) + b * saturation;\n\t\tpixels[i + 3] = a;\n\t}\n}\n\nexport function brightnessImage(imageData: ImageData, brightness: number) {\n\tconst pixels = imageData.data;\n\n\tfor (let i = 0; i < pixels.length; i += 4) {\n\t\tconst r = pixels[i];\n\t\tconst g = pixels[i + 1];\n\t\tconst b = pixels[i + 2];\n\t\tconst a = pixels[i + 3];\n\t\tpixels[i] = r * brightness;\n\t\tpixels[i + 1] = g * brightness;\n\t\tpixels[i + 2] = b * brightness;\n\t\tpixels[i + 3] = a;\n\t}\n}\n\nexport function contrastImage(imageData: ImageData, contrast: number) {\n\tconst pixels = imageData.data;\n\n\tfor (let i = 0; i < pixels.length; i += 4) {\n\t\tconst r = pixels[i];\n\t\tconst g = pixels[i + 1];\n\t\tconst b = pixels[i + 2];\n\t\tconst a = pixels[i + 3];\n\t\tpixels[i] = (r - 128) * contrast + 128;\n\t\tpixels[i + 1] = (g - 128) * contrast + 128;\n\t\tpixels[i + 2] = (b - 128) * contrast + 128;\n\t\tpixels[i + 3] = a;\n\t}\n}\n","/** @internal */\nexport interface ControlPointConf {\n\tcx: number;\n\tcy: number;\n\tx: number;\n\ty: number;\n\tur: number;\n\tvr: number;\n\tup: number;\n\tvp: number;\n}\n\n/** @internal */\nexport interface ControlPointPreset {\n\twidth: number;\n\theight: number;\n\tconf: ControlPointConf[];\n}\n\n/** @internal */\nexport const p = (\n\tcx: number,\n\tcy: number,\n\tx: number,\n\ty: number,\n\tur = 0,\n\tvr = 0,\n\tup = 1,\n\tvp = 1,\n) => Object.freeze({ cx, cy, x, y, ur, vr, up, vp }) as ControlPointConf;\n/** @internal */\nexport const preset = (\n\twidth: number,\n\theight: number,\n\tconf: ControlPointConf[],\n) => Object.freeze({ width, height, conf }) as ControlPointPreset;\n\nexport const CONTROL_POINT_PRESETS = [\n\t// TODO: 竖屏推荐\n\tpreset(5, 5, [\n\t\tp(0, 0, -1, -1, 0, 0, 1, 1),\n\t\tp(1, 0, -0.5, -1, 0, 0, 1, 1),\n\t\tp(2, 0, 0, -1, 0, 0, 1, 1),\n\t\tp(3, 0, 0.5, -1, 0, 0, 1, 1),\n\t\tp(4, 0, 1, -1, 0, 0, 1, 1),\n\t\tp(0, 1, -1, -0.5, 0, 0, 1, 1),\n\t\tp(1, 1, -0.5, -0.5, 0, 0, 1, 1),\n\t\tp(2, 1, -0.0052029684413368305, -0.6131420587090777, 0, 0, 1, 1),\n\t\tp(3, 1, 0.5884227308309977, -0.3990805107556692, 0, 0, 1, 1),\n\t\tp(4, 1, 1, -0.5, 0, 0, 1, 1),\n\t\tp(0, 2, -1, 0, 0, 0, 1, 1),\n\t\tp(1, 2, -0.4210024670505933, -0.11895058380429502, 0, 0, 1, 1),\n\t\tp(2, 2, -0.1019613423315412, -0.023812118047224606, 0, -47, 0.629, 0.849),\n\t\tp(3, 2, 0.40275125660925437, -0.06345314544600389, 0, 0, 1, 1),\n\t\tp(4, 2, 1, 0, 0, 0, 1, 1),\n\t\tp(0, 3, -1, 0.5, 0, 0, 1, 1),\n\t\tp(1, 3, 0.06801958477287173, 0.5205913248960121, -31, -45, 1, 1),\n\t\tp(2, 3, 0.21446469120128908, 0.29331610114301043, 6, -56, 0.566, 1.321),\n\t\tp(3, 3, 0.5, 0.5, 0, 0, 1, 1),\n\t\tp(4, 3, 1, 0.5, 0, 0, 1, 1),\n\t\tp(0, 4, -1, 1, 0, 0, 1, 1),\n\t\tp(1, 4, -0.31378372841550195, 1, 0, 0, 1, 1),\n\t\tp(2, 4, 0.26153633255328046, 1, 0, 0, 1, 1),\n\t\tp(3, 4, 0.5, 1, 0, 0, 1, 1),\n\t\tp(4, 4, 1, 1, 0, 0, 1, 1),\n\t]),\n\t// TODO: 横屏推荐\n\tpreset(4, 4, [\n\t\tp(0, 0, -1, -1, 0, 0, 1, 1),\n\t\tp(1, 0, -0.33333333333333337, -1, 0, 0, 1, 1),\n\t\tp(2, 0, 0.33333333333333326, -1, 0, 0, 1, 1),\n\t\tp(3, 0, 1, -1, 0, 0, 1, 1),\n\t\tp(0, 1, -1, -0.04495399932657351, 0, 0, 1, 1),\n\t\tp(1, 1, -0.24056117520129328, -0.22465999020104, 0, 0, 1, 1),\n\t\tp(2, 1, 0.334758885767489, -0.00531297192779423, 0, 0, 1, 1),\n\t\tp(3, 1, 0.9989920470678106, -0.3382976020775408, 8, 0, 0.566, 1.792),\n\t\tp(0, 2, -1, 0.33333333333333326, 0, 0, 1, 1),\n\t\tp(1, 2, -0.3425497314639411, -0.000027501607956947893, 0, 0, 1, 1),\n\t\tp(2, 2, 0.3321437945812673, 0.1981776353859399, 0, 0, 1, 1),\n\t\tp(3, 2, 1, 0.0766118180296832, 0, 0, 1, 1),\n\t\tp(0, 3, -1, 1, 0, 0, 1, 1),\n\t\tp(1, 3, -0.33333333333333337, 1, 0, 0, 1, 1),\n\t\tp(2, 3, 0.33333333333333326, 1, 0, 0, 1, 1),\n\t\tp(3, 3, 1, 1, 0, 0, 1, 1),\n\t]),\n\tpreset(4, 4, [\n\t\tp(0, 0, -1, -1, 0, 0, 1, 2.075),\n\t\tp(1, 0, -0.33333333333333337, -1, 0, 0, 1, 1),\n\t\tp(2, 0, 0.33333333333333326, -1, 0, 0, 1, 1),\n\t\tp(3, 0, 1, -1, 0, 0, 1, 1),\n\t\tp(0, 1, -1, -0.4545779491139603, 0, 0, 1, 1),\n\t\tp(1, 1, -0.33333333333333337, -0.33333333333333337, 0, 0, 1, 1),\n\t\tp(2, 1, 0.0889403142626457, -0.6025711180694033, -32, 45, 1, 1),\n\t\tp(3, 1, 1, -0.33333333333333337, 0, 0, 1, 1),\n\t\tp(0, 2, -1, -0.07402408608567845, 1, 0, 1, 0.094),\n\t\tp(1, 2, -0.2719422694359541, 0.09775369930903222, 25, -18, 1.321, 0),\n\t\tp(2, 2, 0.19877414408395877, 0.4307383294587789, 48, -40, 0.755, 0.975),\n\t\tp(3, 2, 1, 0.33333333333333326, -37, 0, 1, 1),\n\t\tp(0, 3, -1, 1, 0, 0, 1, 1),\n\t\tp(1, 3, -0.33333333333333337, 1, 0, 0, 1, 1),\n\t\tp(2, 3, 0.5125850864305672, 1, -20, -18, 0, 1.604),\n\t\tp(3, 3, 1, 1, 0, 0, 1, 1),\n\t]),\n\tpreset(5, 5, [\n\t\tp(0, 0, -1, -1, 0, 0, 1, 1),\n\t\tp(1, 0, -0.4501953125, -1, 0, 55, 1, 2.075),\n\t\tp(2, 0, 0.1953125, -1, 0, 0, 1, 1),\n\t\tp(3, 0, 0.4580078125, -1, 0, -25, 1, 1),\n\t\tp(4, 0, 1, -1, 0, 0, 1, 1),\n\t\tp(0, 1, -1, -0.2514475377525607, -16, 0, 2.327, 0.943),\n\t\tp(1, 1, -0.55859375, -0.6609325945787148, 47, 0, 2.358, 0.377),\n\t\tp(2, 1, 0.232421875, -0.5244375756366635, -66, -25, 1.855, 1.164),\n\t\tp(3, 1, 0.685546875, -0.3753706470552125, 0, 0, 1, 1),\n\t\tp(4, 1, 1, -0.6699125300354287, 0, 0, 1, 1),\n\t\tp(0, 2, -1, 0.035910396862284255, 0, 0, 1, 1),\n\t\tp(1, 2, -0.4921875, 0.005378616309457018, 90, 23, 1, 1.981),\n\t\tp(2, 2, 0.021484375, -0.1365043639066228, 0, 42, 1, 1),\n\t\tp(3, 2, 0.4765625, 0.05925822904974043, -30, 0, 1.95, 0.44),\n\t\tp(4, 2, 1, 0.251428847823418, 0, 0, 1, 1),\n\t\tp(0, 3, -1, 0.6968336464764276, -68, 0, 1, 0.786),\n\t\tp(1, 3, -0.6904296875, 0.5890744209958608, -68, 0, 1, 1),\n\t\tp(2, 3, 0.1845703125, 0.3879238667654693, 61, 0, 1, 1),\n\t\tp(3, 3, 0.60546875, 0.4633553246018661, -47, -59, 0.849, 1.73),\n\t\tp(4, 3, 1, 0.6214021886400309, -33, 0, 0.377, 1.604),\n\t\tp(0, 4, -1, 1, 0, 0, 1, 1),\n\t\tp(1, 4, -0.5, 1, 0, -73, 1, 1),\n\t\tp(2, 4, -0.3271484375, 1, 0, -24, 0.314, 2.704),\n\t\tp(3, 4, 0.5, 1, 0, 0, 1, 1),\n\t\tp(4, 4, 1, 1, 0, 0, 1, 1),\n\t]),\n] as const;\n","/**\n * @fileoverview\n * 实验性的随机控制点生成函数算法\n * 目的是取代原先大量的预设控制点代码\n */\n\nimport {\n\ttype ControlPointConf,\n\ttype ControlPointPreset,\n\tp,\n\tpreset,\n} from \"./cp-presets.ts\";\n\nconst randomRange = (min: number, max: number): number =>\n\tMath.random() * (max - min) + min;\n\nfunction clamp(x: number, min: number, max: number): number {\n\treturn Math.min(Math.max(x, min), max);\n}\n\nfunction smoothstep(edge0: number, edge1: number, x: number): number {\n\tconst t = clamp((x - edge0) / (edge1 - edge0), 0, 1);\n\treturn t * t * (3 - 2 * t);\n}\n\nfunction smoothifyControlPoints(\n\tconf: ControlPointConf[],\n\tw: number,\n\th: number,\n\titerations = 2,\n\tfactor = 0.5,\n\tfactorIterationModifier = 0.1,\n): void {\n\tlet grid: ControlPointConf[][] = [];\n\tlet f = factor;\n\n\tfor (let j = 0; j < h; j++) {\n\t\tgrid[j] = [];\n\t\tfor (let i = 0; i < w; i++) {\n\t\t\tgrid[j][i] = conf[j * w + i];\n\t\t}\n\t}\n\n\tconst kernel = [\n\t\t[1, 2, 1],\n\t\t[2, 4, 2],\n\t\t[1, 2, 1],\n\t];\n\tconst kernelSum = 16;\n\n\tfor (let iter = 0; iter < iterations; iter++) {\n\t\tconst newGrid: ControlPointConf[][] = [];\n\t\tfor (let j = 0; j < h; j++) {\n\t\t\tnewGrid[j] = [];\n\t\t\tfor (let i = 0; i < w; i++) {\n\t\t\t\tif (i === 0 || i === w - 1 || j === 0 || j === h - 1) {\n\t\t\t\t\tnewGrid[j][i] = grid[j][i];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet sumX = 0;\n\t\t\t\tlet sumY = 0;\n\t\t\t\tlet sumUR = 0;\n\t\t\t\tlet sumVR = 0;\n\t\t\t\tlet sumUP = 0;\n\t\t\t\tlet sumVP = 0;\n\t\t\t\tfor (let dj = -1; dj <= 1; dj++) {\n\t\t\t\t\tfor (let di = -1; di <= 1; di++) {\n\t\t\t\t\t\tconst weight = kernel[dj + 1][di + 1];\n\t\t\t\t\t\tconst nb = grid[j + dj][i + di];\n\t\t\t\t\t\tsumX += nb.x * weight;\n\t\t\t\t\t\tsumY += nb.y * weight;\n\t\t\t\t\t\tsumUR += nb.ur * weight;\n\t\t\t\t\t\tsumVR += nb.vr * weight;\n\t\t\t\t\t\tsumUP += nb.up * weight;\n\t\t\t\t\t\tsumVP += nb.vp * weight;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst avgX = sumX / kernelSum;\n\t\t\t\tconst avgY = sumY / kernelSum;\n\t\t\t\tconst avgUR = sumUR / kernelSum;\n\t\t\t\tconst avgVR = sumVR / kernelSum;\n\t\t\t\tconst avgUP = sumUP / kernelSum;\n\t\t\t\tconst avgVP = sumVP / kernelSum;\n\n\t\t\t\tconst cur = grid[j][i];\n\t\t\t\tconst newX = cur.x * (1 - f) + avgX * f;\n\t\t\t\tconst newY = cur.y * (1 - f) + avgY * f;\n\t\t\t\tconst newUR = cur.ur * (1 - f) + avgUR * f;\n\t\t\t\tconst newVR = cur.vr * (1 - f) + avgVR * f;\n\t\t\t\tconst newUP = cur.up * (1 - f) + avgUP * f;\n\t\t\t\tconst newVP = cur.vp * (1 - f) + avgVP * f;\n\t\t\t\tnewGrid[j][i] = p(i, j, newX, newY, newUR, newVR, newUP, newVP);\n\t\t\t}\n\t\t}\n\t\tgrid = newGrid;\n\t\tf = Math.min(1, Math.max(f + factorIterationModifier, 0));\n\t}\n\n\tfor (let j = 0; j < h; j++) {\n\t\tfor (let i = 0; i < w; i++) {\n\t\t\tconf[j * w + i] = grid[j][i];\n\t\t}\n\t}\n}\n\nfunction noise(x: number, y: number): number {\n\treturn fract(Math.sin(x * 12.9898 + y * 78.233) * 43758.5453);\n}\n\nfunction fract(x: number): number {\n\treturn x - Math.floor(x);\n}\n\nfunction smoothNoise(x: number, y: number): number {\n\tconst x0 = Math.floor(x);\n\tconst y0 = Math.floor(y);\n\tconst x1 = x0 + 1;\n\tconst y1 = y0 + 1;\n\n\tconst xf = x - x0;\n\tconst yf = y - y0;\n\n\tconst u = xf * xf * (3 - 2 * xf);\n\tconst v = yf * yf * (3 - 2 * yf);\n\n\tconst n00 = noise(x0, y0);\n\tconst n10 = noise(x1, y0);\n\tconst n01 = noise(x0, y1);\n\tconst n11 = noise(x1, y1);\n\n\tconst nx0 = n00 * (1 - u) + n10 * u;\n\tconst nx1 = n01 * (1 - u) + n11 * u;\n\n\treturn nx0 * (1 - v) + nx1 * v;\n}\n\nfunction computeNoiseGradient(\n\tperlinFn: (x: number, y: number) => number,\n\tx: number,\n\ty: number,\n\tepsilon = 0.001,\n): [number, number] {\n\tconst n1 = perlinFn(x + epsilon, y);\n\tconst n2 = perlinFn(x - epsilon, y);\n\tconst n3 = perlinFn(x, y + epsilon);\n\tconst n4 = perlinFn(x, y - epsilon);\n\tconst dx = (n1 - n2) / (2 * epsilon);\n\tconst dy = (n3 - n4) / (2 * epsilon);\n\tconst len = Math.sqrt(dx * dx + dy * dy) || 1;\n\treturn [dx / len, dy / len];\n}\n\nexport function generateControlPoints(\n\twidth: number,\n\theight: number,\n\tvariationFraction = randomRange(0.4, 0.6), // = 0.2,\n\tnormalOffset = randomRange(0.3, 0.6), // = 0.3,\n\tblendFactor = 0.8,\n\tsmoothIters = Math.floor(randomRange(3, 5)), // = 3,\n\tsmoothFactor = randomRange(0.2, 0.3), // = 0.3,\n\tsmoothModifier = randomRange(-0.1, -0.05), // = -0.05,\n): ControlPointPreset {\n\tconst w = width ?? Math.floor(randomRange(3, 6));\n\tconst h = height ?? Math.floor(randomRange(3, 6));\n\n\tconst conf: ControlPointConf[] = [];\n\tconst dx = w === 1 ? 0 : 2 / (w - 1);\n\tconst dy = h === 1 ? 0 : 2 / (h - 1);\n\n\tfor (let j = 0; j < h; j++) {\n\t\tfor (let i = 0; i < w; i++) {\n\t\t\tconst baseX = (w === 1 ? 0 : i / (w - 1)) * 2 - 1;\n\t\t\tconst baseY = (h === 1 ? 0 : j / (h - 1)) * 2 - 1;\n\n\t\t\tconst isBorder = i === 0 || i === w - 1 || j === 0 || j === h - 1;\n\t\t\tconst pertX = isBorder\n\t\t\t\t? 0\n\t\t\t\t: randomRange(-variationFraction * dx, variationFraction * dx);\n\t\t\tconst pertY = isBorder\n\t\t\t\t? 0\n\t\t\t\t: randomRange(-variationFraction * dy, variationFraction * dy);\n\t\t\tlet x = baseX + pertX;\n\t\t\tlet y = baseY + pertY;\n\n\t\t\tconst ur = isBorder ? 0 : randomRange(-60, 60);\n\t\t\tconst vr = isBorder ? 0 : randomRange(-60, 60);\n\t\t\tconst up = isBorder ? 1 : randomRange(0.8, 1.2);\n\t\t\tconst vp = isBorder ? 1 : randomRange(0.8, 1.2);\n\n\t\t\tif (!isBorder) {\n\t\t\t\tconst uNorm = (baseX + 1) / 2;\n\t\t\t\tconst vNorm = (baseY + 1) / 2;\n\n\t\t\t\tconst [nx, ny] = computeNoiseGradient(smoothNoise, uNorm, vNorm, 0.001);\n\t\t\t\tlet offsetX = nx * normalOffset;\n\t\t\t\tlet offsetY = ny * normalOffset;\n\n\t\t\t\tconst distToBorder = Math.min(uNorm, 1 - uNorm, vNorm, 1 - vNorm); // in [0,0.5]\n\n\t\t\t\tconst weight = smoothstep(0, 1.0, distToBorder);\n\t\t\t\toffsetX *= weight;\n\t\t\t\toffsetY *= weight;\n\n\t\t\t\tx = x * (1 - blendFactor) + (x + offsetX) * blendFactor;\n\t\t\t\ty = y * (1 - blendFactor) + (y + offsetY) * blendFactor;\n\t\t\t}\n\t\t\tconf.push(p(i, j, x, y, ur, vr, up, vp));\n\t\t}\n\t}\n\n\tsmoothifyControlPoints(conf, w, h, smoothIters, smoothFactor, smoothModifier);\n\n\treturn preset(w, h, conf);\n}\n","export default \"precision highp float;\\r\\n\\r\\nvarying vec3 v_color;\\r\\nvarying vec2 v_uv;\\r\\nuniform sampler2D u_texture;\\r\\nuniform float u_time;\\r\\nuniform float u_volume;\\r\\nuniform float u_alpha;\\r\\n\\r\\n// 预计算常量\\r\\nconst float INV_255 = 1.0 / 255.0;\\r\\nconst float HALF_INV_255 = 0.5 / 255.0;\\r\\nconst float GRADIENT_NOISE_A = 52.9829189;\\r\\nconst vec2 GRADIENT_NOISE_B = vec2(0.06711056, 0.00583715);\\r\\n\\r\\n/* Gradient noise from Jorge Jimenez's presentation: */\\r\\n/* http://www.iryoku.com/next-generation-post-processing-in-call-of-duty-advanced-warfare */\\r\\nfloat gradientNoise(in vec2 uv) {\\r\\n    return fract(GRADIENT_NOISE_A * fract(dot(uv, GRADIENT_NOISE_B)));\\r\\n}\\r\\n\\r\\n// 优化的旋转函数，避免重复计算sin/cos\\r\\nvec2 rot(vec2 v, float angle) {\\r\\n    float s = sin(angle);\\r\\n    float c = cos(angle);\\r\\n    return vec2(c * v.x - s * v.y, s * v.x + c * v.y);\\r\\n}\\r\\n\\r\\nvoid main() {\\r\\n    // 合并计算以减少指令数\\r\\n    float volumeEffect = u_volume * 2.0;\\r\\n    float timeVolume = u_time + u_volume;\\r\\n    \\r\\n    float dither = INV_255 * gradientNoise(gl_FragCoord.xy) - HALF_INV_255;\\r\\n    vec2 centeredUV = v_uv - vec2(0.2);\\r\\n    vec2 rotatedUV = rot(centeredUV, timeVolume * 2.0);\\r\\n    vec2 finalUV = rotatedUV * max(0.001, 1.0 - volumeEffect) + vec2(0.5);\\r\\n    \\r\\n    vec4 result = texture2D(u_texture, finalUV);\\r\\n    \\r\\n    float alphaVolumeFactor = u_alpha * max(0.5, 1.0 - u_volume * 0.5);\\r\\n    result.rgb *= v_color * alphaVolumeFactor;\\r\\n    result.a *= alphaVolumeFactor;\\r\\n    \\r\\n    result.rgb += vec3(dither);\\r\\n    \\r\\n    float dist = distance(v_uv, vec2(0.5));\\r\\n    float vignette = smoothstep(0.8, 0.3, dist);\\r\\n    float mask = 0.6 + vignette * 0.4;\\r\\n    result.rgb *= mask;\\r\\n    \\r\\n    gl_FragColor = result;\\r\\n}\\r\\n\"","export default \"precision highp float;\\n\\nattribute vec2 a_pos;\\nattribute vec3 a_color;\\nattribute vec2 a_uv;\\nvarying vec3 v_color;\\nvarying vec2 v_uv;\\n\\nuniform float u_aspect;\\n\\nvoid main() {\\n    v_color = a_color;\\n    v_uv = a_uv;\\n    vec2 pos = a_pos;\\n    if (u_aspect > 1.0) {\\n        pos.y *= u_aspect;\\n    } else {\\n        pos.x /= u_aspect;\\n    }\\n    gl_Position = vec4(pos, 0.0, 1.0);\\n}\\n\"","/**\n * @fileoverview\n * 基于 Mesh Gradient 渐变渲染的渲染器\n * 此渲染应该是 Apple Music 使用的背景渲染方式了\n * 参考内容 https://movingparts.io/gradient-meshes\n */\n\nimport { Mat4, Vec2, Vec3, Vec4 } from \"gl-matrix\";\nimport type { Disposable } from \"../../interfaces.ts\";\nimport {\n\tloadResourceFromElement,\n\tloadResourceFromUrl,\n} from \"../../utils/resource.ts\";\nimport { BaseRenderer } from \"../base.ts\";\nimport {\n\tblurImage,\n\tbrightnessImage,\n\tcontrastImage,\n\tsaturateImage,\n} from \"../img.ts\";\nimport { generateControlPoints } from \"./cp-generate.ts\";\nimport { CONTROL_POINT_PRESETS } from \"./cp-presets.ts\";\nimport meshFragShader from \"./mesh.frag.glsl?raw\";\nimport meshVertShader from \"./mesh.vert.glsl?raw\";\n\ntype RenderingContext = WebGLRenderingContext;\n\nclass GLProgram implements Disposable {\n\tprivate gl: RenderingContext;\n\tprogram: WebGLProgram;\n\tprivate vertexShader: WebGLShader;\n\tprivate fragmentShader: WebGLShader;\n\treadonly attrs: { [name: string]: number };\n\tconstructor(\n\t\tgl: RenderingContext,\n\t\tvertexShaderSource: string,\n\t\tfragmentShaderSource: string,\n\t\tprivate readonly label = \"unknown\",\n\t) {\n\t\tthis.gl = gl;\n\t\tthis.vertexShader = this.createShader(gl.VERTEX_SHADER, vertexShaderSource);\n\t\tthis.fragmentShader = this.createShader(\n\t\t\tgl.FRAGMENT_SHADER,\n\t\t\tfragmentShaderSource,\n\t\t);\n\t\tthis.program = this.createProgram();\n\n\t\tconst num = gl.getProgramParameter(this.program, gl.ACTIVE_ATTRIBUTES);\n\t\tconst attrs: { [name: string]: number } = {};\n\t\tfor (let i = 0; i < num; i++) {\n\t\t\tconst info = gl.getActiveAttrib(this.program, i);\n\t\t\tif (!info) continue;\n\t\t\tconst location = gl.getAttribLocation(this.program, info.name);\n\t\t\tif (location === -1) continue;\n\t\t\tattrs[info.name] = location;\n\t\t}\n\t\tthis.attrs = attrs;\n\t}\n\tprivate createShader(type: number, source: string) {\n\t\tconst gl = this.gl;\n\t\tconst shader = gl.createShader(type);\n\t\tif (!shader) throw new Error(\"Failed to create shader\");\n\t\tgl.shaderSource(shader, source);\n\t\tgl.compileShader(shader);\n\t\tif (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n\t\t\tthrow new Error(\n\t\t\t\t`Failed to compile shader for type ${type} \"${\n\t\t\t\t\tthis.label\n\t\t\t\t}\": ${gl.getShaderInfoLog(shader)}`,\n\t\t\t);\n\t\t}\n\t\treturn shader;\n\t}\n\tprivate createProgram() {\n\t\tconst gl = this.gl;\n\t\tconst program = gl.createProgram();\n\t\tif (!program) throw new Error(\"Failed to create program\");\n\t\tgl.attachShader(program, this.vertexShader);\n\t\tgl.attachShader(program, this.fragmentShader);\n\t\tgl.linkProgram(program);\n\t\tgl.validateProgram(program);\n\t\tif (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n\t\t\tconst errLog = gl.getProgramInfoLog(program);\n\t\t\tgl.deleteProgram(program);\n\t\t\tthrow new Error(`Failed to link program \"${this.label}\": ${errLog}`);\n\t\t}\n\t\treturn program;\n\t}\n\tuse() {\n\t\tconst gl = this.gl;\n\t\tgl.useProgram(this.program);\n\t}\n\tprivate notFoundUniforms: Set<string> = new Set();\n\tprivate warnUniformNotFound(name: string) {\n\t\tif (this.notFoundUniforms.has(name)) return;\n\t\tthis.notFoundUniforms.add(name);\n\t\tconsole.warn(\n\t\t\t`Failed to get uniform location for program \"${this.label}\": ${name}`,\n\t\t);\n\t}\n\tsetUniform1f(name: string, value: number) {\n\t\tconst gl = this.gl;\n\t\tconst location = gl.getUniformLocation(this.program, name);\n\t\tif (!location) this.warnUniformNotFound(name);\n\t\telse gl.uniform1f(location, value);\n\t}\n\tsetUniform2f(name: string, value1: number, value2: number) {\n\t\tconst gl = this.gl;\n\t\tconst location = gl.getUniformLocation(this.program, name);\n\t\tif (!location) this.warnUniformNotFound(name);\n\t\telse gl.uniform2f(location, value1, value2);\n\t}\n\tsetUniform1i(name: string, value: number) {\n\t\tconst gl = this.gl;\n\t\tconst location = gl.getUniformLocation(this.program, name);\n\t\tif (!location) this.warnUniformNotFound(name);\n\t\telse gl.uniform1i(location, value);\n\t}\n\tdispose() {\n\t\tconst gl = this.gl;\n\t\tgl.deleteShader(this.vertexShader);\n\t\tgl.deleteShader(this.fragmentShader);\n\t\tgl.deleteProgram(this.program);\n\t}\n}\n\nclass Mesh implements Disposable {\n\tprotected vertexWidth = 0;\n\tprotected vertexHeight = 0;\n\tprivate vertexBuffer: WebGLBuffer;\n\tprivate indexBuffer: WebGLBuffer;\n\tprivate vertexData: Float32Array;\n\tprivate indexData: Uint16Array;\n\tprivate vertexIndexLength = 0;\n\t// 调试用途，开启线框模式\n\tprivate wireFrame = false;\n\tconstructor(\n\t\tprivate readonly gl: RenderingContext,\n\t\tprivate readonly attrPos: number | undefined,\n\t\tprivate readonly attrColor: number | undefined,\n\t\tprivate readonly attrUV: number | undefined,\n\t) {\n\t\tconst vertexBuf = gl.createBuffer();\n\t\tif (!vertexBuf) throw new Error(\"Failed to create vertex buffer\");\n\t\tthis.vertexBuffer = vertexBuf;\n\t\tconst indexBuf = gl.createBuffer();\n\t\tif (!indexBuf) throw new Error(\"Failed to create index buffer\");\n\t\tthis.indexBuffer = indexBuf;\n\n\t\tthis.bind();\n\n\t\tthis.vertexData = new Float32Array(0);\n\t\tthis.indexData = new Uint16Array(0);\n\n\t\tthis.resize(2, 2);\n\t\tthis.update();\n\t}\n\n\tsetWireFrame(enable: boolean) {\n\t\tthis.wireFrame = enable;\n\t\tthis.resize(this.vertexWidth, this.vertexHeight);\n\t}\n\n\tsetVertexPos(vx: number, vy: number, x: number, y: number): void {\n\t\tconst idx = (vx + vy * this.vertexWidth) * 7;\n\t\tif (idx >= this.vertexData.length - 1) {\n\t\t\tconsole.warn(\"Vertex position out of range\", idx, this.vertexData.length);\n\t\t\treturn;\n\t\t}\n\t\tthis.vertexData[idx] = x;\n\t\tthis.vertexData[idx + 1] = y;\n\t}\n\n\tsetVertexColor(\n\t\tvx: number,\n\t\tvy: number,\n\t\tr: number,\n\t\tg: number,\n\t\tb: number,\n\t): void {\n\t\tconst idx = (vx + vy * this.vertexWidth) * 7 + 2;\n\t\tif (idx >= this.vertexData.length - 2) {\n\t\t\tconsole.warn(\"Vertex color out of range\", idx, this.vertexData.length);\n\t\t\treturn;\n\t\t}\n\t\tthis.vertexData[idx] = r;\n\t\tthis.vertexData[idx + 1] = g;\n\t\tthis.vertexData[idx + 2] = b;\n\t}\n\n\tsetVertexUV(vx: number, vy: number, x: number, y: number): void {\n\t\tconst idx = (vx + vy * this.vertexWidth) * 7 + 5;\n\t\tif (idx >= this.vertexData.length - 1) {\n\t\t\tconsole.warn(\"Vertex UV out of range\", idx, this.vertexData.length);\n\t\t\treturn;\n\t\t}\n\t\tthis.vertexData[idx] = x;\n\t\tthis.vertexData[idx + 1] = y;\n\t}\n\n\t// 批量设置顶点数据的优化方法\n\tsetVertexData(\n\t\tvx: number,\n\t\tvy: number,\n\t\tx: number,\n\t\ty: number,\n\t\tr: number,\n\t\tg: number,\n\t\tb: number,\n\t\tu: number,\n\t\tv: number,\n\t): void {\n\t\tconst idx = (vx + vy * this.vertexWidth) * 7;\n\t\tif (idx >= this.vertexData.length - 6) {\n\t\t\tconsole.warn(\"Vertex data out of range\", idx, this.vertexData.length);\n\t\t\treturn;\n\t\t}\n\t\tconst data = this.vertexData;\n\t\tdata[idx] = x;\n\t\tdata[idx + 1] = y;\n\t\tdata[idx + 2] = r;\n\t\tdata[idx + 3] = g;\n\t\tdata[idx + 4] = b;\n\t\tdata[idx + 5] = u;\n\t\tdata[idx + 6] = v;\n\t}\n\n\tgetVertexIndexLength(): number {\n\t\treturn this.vertexIndexLength;\n\t}\n\n\tdraw() {\n\t\tconst gl = this.gl;\n\n\t\tif (this.wireFrame) {\n\t\t\tgl.drawElements(gl.LINES, this.vertexIndexLength, gl.UNSIGNED_SHORT, 0);\n\t\t} else {\n\t\t\tgl.drawElements(\n\t\t\t\tgl.TRIANGLES,\n\t\t\t\tthis.vertexIndexLength,\n\t\t\t\tgl.UNSIGNED_SHORT,\n\t\t\t\t0,\n\t\t\t);\n\t\t}\n\t}\n\n\tresize(vertexWidth: number, vertexHeight: number): void {\n\t\tthis.vertexWidth = vertexWidth;\n\t\tthis.vertexHeight = vertexHeight;\n\t\t// 2 个顶点坐标 + 3 个颜色值 + 2 个 UV 坐标\n\t\tthis.vertexIndexLength = vertexWidth * vertexHeight * 6;\n\t\tif (this.wireFrame) {\n\t\t\tthis.vertexIndexLength = vertexWidth * vertexHeight * 10;\n\t\t}\n\t\tconst vertexData = new Float32Array(\n\t\t\tvertexWidth * vertexHeight * (2 + 3 + 2),\n\t\t);\n\t\tconst indexData = new Uint16Array(this.vertexIndexLength);\n\t\tthis.vertexData = vertexData;\n\t\tthis.indexData = indexData;\n\t\tfor (let y = 0; y < vertexHeight; y++) {\n\t\t\tfor (let x = 0; x < vertexWidth; x++) {\n\t\t\t\tconst px = (x / (vertexWidth - 1)) * 2 - 1;\n\t\t\t\tconst py = (y / (vertexHeight - 1)) * 2 - 1;\n\t\t\t\tthis.setVertexPos(x, y, px || 0, py || 0);\n\t\t\t\tthis.setVertexColor(x, y, 1, 1, 1);\n\t\t\t\tthis.setVertexUV(x, y, x / (vertexWidth - 1), y / (vertexHeight - 1));\n\t\t\t}\n\t\t}\n\t\tfor (let y = 0; y < vertexHeight - 1; y++) {\n\t\t\tfor (let x = 0; x < vertexWidth - 1; x++) {\n\t\t\t\tif (this.wireFrame) {\n\t\t\t\t\tconst idx = (y * vertexWidth + x) * 10;\n\n\t\t\t\t\tindexData[idx] = y * vertexWidth + x;\n\t\t\t\t\tindexData[idx + 1] = y * vertexWidth + x + 1;\n\n\t\t\t\t\tindexData[idx + 2] = y * vertexWidth + x + 1;\n\t\t\t\t\tindexData[idx + 3] = (y + 1) * vertexWidth + x;\n\n\t\t\t\t\tindexData[idx + 4] = (y + 1) * vertexWidth + x;\n\t\t\t\t\tindexData[idx + 5] = (y + 1) * vertexWidth + x + 1;\n\n\t\t\t\t\tindexData[idx + 6] = (y + 1) * vertexWidth + x + 1;\n\t\t\t\t\tindexData[idx + 7] = y * vertexWidth + x + 1;\n\n\t\t\t\t\tindexData[idx + 8] = y * vertexWidth + x;\n\t\t\t\t\tindexData[idx + 9] = (y + 1) * vertexWidth + x;\n\t\t\t\t} else {\n\t\t\t\t\tconst idx = (y * vertexWidth + x) * 6;\n\t\t\t\t\tindexData[idx] = y * vertexWidth + x;\n\t\t\t\t\tindexData[idx + 1] = y * vertexWidth + x + 1;\n\t\t\t\t\tindexData[idx + 2] = (y + 1) * vertexWidth + x;\n\t\t\t\t\tindexData[idx + 3] = y * vertexWidth + x + 1;\n\t\t\t\t\tindexData[idx + 4] = (y + 1) * vertexWidth + x + 1;\n\t\t\t\t\tindexData[idx + 5] = (y + 1) * vertexWidth + x;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst gl = this.gl;\n\t\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n\t\tgl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.indexData, gl.STATIC_DRAW);\n\t}\n\n\tbind() {\n\t\tconst gl = this.gl;\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n\t\tgl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n\n\t\tif (this.attrPos !== undefined) {\n\t\t\tgl.vertexAttribPointer(this.attrPos, 2, gl.FLOAT, false, 4 * 7, 0);\n\t\t\tgl.enableVertexAttribArray(this.attrPos);\n\t\t}\n\t\tif (this.attrColor !== undefined) {\n\t\t\tgl.vertexAttribPointer(this.attrColor, 3, gl.FLOAT, false, 4 * 7, 4 * 2);\n\t\t\tgl.enableVertexAttribArray(this.attrColor);\n\t\t}\n\t\tif (this.attrUV !== undefined) {\n\t\t\tgl.vertexAttribPointer(this.attrUV, 2, gl.FLOAT, false, 4 * 7, 4 * 5);\n\t\t\tgl.enableVertexAttribArray(this.attrUV);\n\t\t}\n\t}\n\n\tupdate() {\n\t\tconst gl = this.gl;\n\t\tgl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n\t\tgl.bufferData(gl.ARRAY_BUFFER, this.vertexData, gl.DYNAMIC_DRAW);\n\t}\n\n\tdispose(): void {\n\t\tthis.gl.deleteBuffer(this.vertexBuffer);\n\t\tthis.gl.deleteBuffer(this.indexBuffer);\n\t}\n}\n\nclass ControlPoint {\n\tcolor = Vec3.fromValues(1, 1, 1);\n\tlocation = Vec2.fromValues(0, 0);\n\tuTangent = Vec2.fromValues(0, 0);\n\tvTangent = Vec2.fromValues(0, 0);\n\tprivate _uRot = 0;\n\tprivate _vRot = 0;\n\tprivate _uScale = 1;\n\tprivate _vScale = 1;\n\n\tconstructor() {\n\t\tObject.seal(this);\n\t}\n\n\tget uRot() {\n\t\treturn this._uRot;\n\t}\n\n\tget vRot() {\n\t\treturn this._vRot;\n\t}\n\n\tset uRot(value: number) {\n\t\tthis._uRot = value;\n\t\tthis.updateUTangent();\n\t}\n\n\tset vRot(value: number) {\n\t\tthis._vRot = value;\n\t\tthis.updateVTangent();\n\t}\n\n\tget uScale() {\n\t\treturn this._uScale;\n\t}\n\n\tget vScale() {\n\t\treturn this._vScale;\n\t}\n\n\tset uScale(value: number) {\n\t\tthis._uScale = value;\n\t\tthis.updateUTangent();\n\t}\n\n\tset vScale(value: number) {\n\t\tthis._vScale = value;\n\t\tthis.updateVTangent();\n\t}\n\n\tprivate updateUTangent() {\n\t\tthis.uTangent[0] = Math.cos(this._uRot) * this._uScale;\n\t\tthis.uTangent[1] = Math.sin(this._uRot) * this._uScale;\n\t}\n\n\tprivate updateVTangent() {\n\t\tthis.vTangent[0] = -Math.sin(this._vRot) * this._vScale;\n\t\tthis.vTangent[1] = Math.cos(this._vRot) * this._vScale;\n\t}\n}\n\nconst H = Mat4.fromValues(2, -2, 1, 1, -3, 3, -2, -1, 0, 0, 1, 0, 1, 0, 0, 0);\nconst H_T = Mat4.clone(H).transpose();\n\nconst spUx = Vec4.create();\nconst spUy = Vec4.create();\nconst spV = Vec4.create();\n\nconst spxAcc = Mat4.create();\nconst spyAcc = Mat4.create();\nfunction surfacePoint(\n\tu: number,\n\tv: number,\n\tX: Mat4,\n\tY: Mat4,\n\toutput = Vec2.create(),\n): Vec2 {\n\tspUx[0] = u ** 3;\n\tspUx[1] = u ** 2;\n\tspUx[2] = u;\n\tspUx[3] = 1;\n\n\tspUy.copy(spUx);\n\n\tspV[0] = v ** 3;\n\tspV[1] = v ** 2;\n\tspV[2] = v;\n\tspV[3] = 1;\n\n\tspxAcc.copy(X).transpose();\n\tMat4.mul(spxAcc, spxAcc, H);\n\tMat4.mul(spxAcc, H_T, spxAcc);\n\tVec4.transformMat4(spUx, spUx, spxAcc);\n\tconst x = spV.dot(spUx);\n\n\tspyAcc.copy(Y).transpose();\n\tMat4.mul(spyAcc, spyAcc, H);\n\tMat4.mul(spyAcc, H_T, spyAcc);\n\tVec4.transformMat4(spUy, spUy, spyAcc);\n\tconst y = spV.dot(spUy);\n\n\toutput.x = x;\n\toutput.y = y;\n\treturn output;\n}\n\nfunction meshCoefficients(\n\tp00: ControlPoint,\n\tp01: ControlPoint,\n\tp10: ControlPoint,\n\tp11: ControlPoint,\n\taxis: \"x\" | \"y\",\n\toutput = Mat4.create(),\n): Mat4 {\n\tconst l = (p: ControlPoint) => p.location[axis];\n\tconst u = (p: ControlPoint) => p.uTangent[axis];\n\tconst v = (p: ControlPoint) => p.vTangent[axis];\n\n\toutput[0] = l(p00);\n\toutput[1] = l(p01);\n\toutput[2] = v(p00);\n\toutput[3] = v(p01);\n\toutput[4] = l(p10);\n\toutput[5] = l(p11);\n\toutput[6] = v(p10);\n\toutput[7] = v(p11);\n\toutput[8] = u(p00);\n\toutput[9] = u(p01);\n\toutput[10] = 0;\n\toutput[11] = 0;\n\toutput[12] = u(p10);\n\toutput[13] = u(p11);\n\toutput[14] = 0;\n\toutput[15] = 0;\n\n\treturn output;\n}\n\nfunction colorCoefficients(\n\tp00: ControlPoint,\n\tp01: ControlPoint,\n\tp10: ControlPoint,\n\tp11: ControlPoint,\n\taxis: \"r\" | \"g\" | \"b\",\n\toutput = Mat4.create(),\n): Mat4 {\n\tconst c = (p: ControlPoint) => p.color[axis];\n\toutput.fill(0);\n\toutput[0] = c(p00);\n\toutput[1] = c(p01);\n\toutput[4] = c(p10);\n\toutput[5] = c(p11);\n\t// return Mat4.fromValues(\n\t//     c(p00), c(p01), 0, 0,\n\t//     c(p10), c(p11), 0, 0,\n\t//     0, 0, 0, 0,\n\t//     0, 0, 0, 0,\n\t// );\n\treturn output;\n}\n\n// 将这个函数要用到的临时变量提取到外部，尽量避免资源分配提高性能\nconst cpUx = Vec4.create();\nconst cpUy = Vec4.create();\nconst cpUz = Vec4.create();\n\nconst cpV = Vec4.create();\n\nconst cprAcc = Mat4.create();\nconst cpgAcc = Mat4.create();\nconst cpbAcc = Mat4.create();\nconst cpResult = Vec3.create();\nfunction colorPoint(u: number, v: number, R: Mat4, G: Mat4, B: Mat4): Vec3 {\n\tcpUx[0] = u ** 3;\n\tcpUx[1] = u ** 2;\n\tcpUx[2] = u;\n\tcpUx[3] = 1;\n\tcpUy.copy(cpUx);\n\tcpUz.copy(cpUx);\n\n\tcpV[0] = v ** 3;\n\tcpV[1] = v ** 2;\n\tcpV[2] = v;\n\tcpV[3] = 1;\n\n\tcprAcc.copy(R).transpose();\n\tMat4.mul(cprAcc, cprAcc, H);\n\tMat4.mul(cprAcc, H_T, cprAcc);\n\tVec4.transformMat4(cpUx, cpUx, cprAcc);\n\tcpResult.r = cpV.dot(cpUx);\n\n\tcpgAcc.copy(G).transpose();\n\tMat4.mul(cpgAcc, cpgAcc, H);\n\tMat4.mul(cpgAcc, H_T, cpgAcc);\n\tVec4.transformMat4(cpUy, cpUy, cpgAcc);\n\tcpResult.g = cpV.dot(cpUy);\n\n\tcpbAcc.copy(B).transpose();\n\tMat4.mul(cpbAcc, cpbAcc, H);\n\tMat4.mul(cpbAcc, H_T, cpbAcc);\n\tVec4.transformMat4(cpUz, cpUz, cpbAcc);\n\tcpResult.b = cpV.dot(cpUz);\n\n\treturn cpResult;\n}\n\nclass Map2D<T> {\n\tprivate _width = 0;\n\tprivate _height = 0;\n\tprivate _data: T[] = [];\n\tconstructor(width: number, height: number) {\n\t\tthis.resize(width, height);\n\t\tObject.seal(this);\n\t}\n\tresize(width: number, height: number) {\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tthis._data = new Array(width * height).fill(0);\n\t}\n\tset(x: number, y: number, value: T) {\n\t\tthis._data[x + y * this._width] = value;\n\t}\n\tget(x: number, y: number) {\n\t\treturn this._data[x + y * this._width];\n\t}\n\tget width() {\n\t\treturn this._width;\n\t}\n\tget height() {\n\t\treturn this._height;\n\t}\n}\n\n// Bicubic Hermite Patch Mesh\nclass BHPMesh extends Mesh {\n\t/**\n\t * 细分级别，越大曲线越平滑，但是性能消耗也越大\n\t */\n\tprivate _subDivisions = 10;\n\tprivate _controlPoints: Map2D<ControlPoint> = new Map2D(3, 3);\n\n\tconstructor(\n\t\tgl: RenderingContext,\n\t\tattrPos: number,\n\t\tattrColor: number,\n\t\tattrUV: number,\n\t) {\n\t\tsuper(gl, attrPos, attrColor, attrUV);\n\t\tthis.resizeControlPoints(3, 3);\n\t\tObject.seal(this);\n\t}\n\toverride setWireFrame(enable: boolean) {\n\t\tsuper.setWireFrame(enable);\n\t\tthis.updateMesh();\n\t}\n\t/**\n\t * 以当前的控制点矩阵大小和细分级别为参考重新设置细分级别，此操作不会重设控制点数据\n\t * @param subDivisions 细分级别\n\t */\n\tresetSubdivition(subDivisions: number) {\n\t\tthis._subDivisions = subDivisions;\n\t\tsuper.resize(\n\t\t\t(this._controlPoints.width - 1) * subDivisions,\n\t\t\t(this._controlPoints.height - 1) * subDivisions,\n\t\t);\n\t}\n\t/**\n\t * 重设控制点矩阵尺寸，将会重置所有控制点的颜色和坐标数据\n\t * 请在调用此方法后重新设置颜色和坐标，并调用 updateMesh 方法更新网格\n\t * @param width 控制点宽度数量，必须大于等于 2\n\t * @param height 控制点高度数量，必须大于等于 2\n\t */\n\tresizeControlPoints(width: number, height: number) {\n\t\tif (!(width >= 2 && height >= 2)) {\n\t\t\tthrow new Error(\"Control points must be larger than 3x3 or equal\");\n\t\t}\n\t\tthis._controlPoints.resize(width, height);\n\t\tfor (let y = 0; y < height; y++) {\n\t\t\tfor (let x = 0; x < width; x++) {\n\t\t\t\tconst point = new ControlPoint();\n\t\t\t\tpoint.location.x = (x / (width - 1)) * 2 - 1;\n\t\t\t\tpoint.location.y = (y / (height - 1)) * 2 - 1;\n\t\t\t\tpoint.uTangent.x = 2 / (width - 1);\n\t\t\t\tpoint.vTangent.y = 2 / (height - 1);\n\t\t\t\tthis._controlPoints.set(x, y, point);\n\t\t\t}\n\t\t}\n\t\tthis.resetSubdivition(this._subDivisions);\n\t}\n\t/**\n\t * 获取指定位置的控制点，然后可以设置颜色和坐标属性\n\t * 留意颜色属性和坐标属性的值范围均参考 WebGL 的定义\n\t * 即颜色各个组件取值 [0-1]，坐标取值 [-1, 1]\n\t * 点的位置以画面左下角为原点 (0,0)\n\t * @param x 需要获取的控制点的 x 坐标\n\t * @param y 需要获取的控制点的 y 坐标\n\t * @returns 控制点对象\n\t */\n\tgetControlPoint(x: number, y: number) {\n\t\treturn this._controlPoints.get(x, y);\n\t}\n\tprivate tmpV2 = Vec2.create();\n\t// 预分配重复使用的矩阵，避免频繁创建\n\tprivate tempX = Mat4.create();\n\tprivate tempY = Mat4.create();\n\tprivate tempR = Mat4.create();\n\tprivate tempG = Mat4.create();\n\tprivate tempB = Mat4.create();\n\t/**\n\t * 更新最终呈现的网格数据，此方法应在所有控制点或细分参数的操作完成后调用\n\t */\n\tupdateMesh() {\n\t\tconst subDivM1 = this._subDivisions - 1;\n\t\tconst tW = subDivM1 * (this._controlPoints.height - 1);\n\t\tconst tH = subDivM1 * (this._controlPoints.width - 1);\n\t\tconst controlPointsWidth = this._controlPoints.width;\n\t\tconst controlPointsHeight = this._controlPoints.height;\n\t\tconst subDivisions = this._subDivisions;\n\n\t\t// 预计算常用值\n\t\tconst invSubDivM1 = 1 / subDivM1;\n\t\tconst invTH = 1 / tH;\n\t\tconst invTW = 1 / tW;\n\n\t\tfor (let x = 0; x < controlPointsWidth - 1; x++) {\n\t\t\tfor (let y = 0; y < controlPointsHeight - 1; y++) {\n\t\t\t\tconst p00 = this._controlPoints.get(x, y);\n\t\t\t\tconst p01 = this._controlPoints.get(x, y + 1);\n\t\t\t\tconst p10 = this._controlPoints.get(x + 1, y);\n\t\t\t\tconst p11 = this._controlPoints.get(x + 1, y + 1);\n\n\t\t\t\t// 复用预分配的矩阵\n\t\t\t\tmeshCoefficients(p00, p01, p10, p11, \"x\", this.tempX);\n\t\t\t\tmeshCoefficients(p00, p01, p10, p11, \"y\", this.tempY);\n\t\t\t\tcolorCoefficients(p00, p01, p10, p11, \"r\", this.tempR);\n\t\t\t\tcolorCoefficients(p00, p01, p10, p11, \"g\", this.tempG);\n\t\t\t\tcolorCoefficients(p00, p01, p10, p11, \"b\", this.tempB);\n\n\t\t\t\tconst sX = x / (controlPointsWidth - 1);\n\t\t\t\tconst sY = y / (controlPointsHeight - 1);\n\t\t\t\tconst baseVx = y * subDivisions;\n\t\t\t\tconst baseVy = x * subDivisions;\n\n\t\t\t\tfor (let u = 0; u < subDivisions; u++) {\n\t\t\t\t\tconst uNorm = u * invSubDivM1;\n\t\t\t\t\tconst vxOffset = baseVx + u;\n\n\t\t\t\t\tfor (let v = 0; v < subDivisions; v++) {\n\t\t\t\t\t\tconst vNorm = v * invSubDivM1;\n\t\t\t\t\t\tconst vy = baseVy + v;\n\n\t\t\t\t\t\tconst [px, py] = surfacePoint(\n\t\t\t\t\t\t\tuNorm,\n\t\t\t\t\t\t\tvNorm,\n\t\t\t\t\t\t\tthis.tempX,\n\t\t\t\t\t\t\tthis.tempY,\n\t\t\t\t\t\t\tthis.tmpV2,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst [pr, pg, pb] = colorPoint(\n\t\t\t\t\t\t\tuNorm,\n\t\t\t\t\t\t\tvNorm,\n\t\t\t\t\t\t\tthis.tempR,\n\t\t\t\t\t\t\tthis.tempG,\n\t\t\t\t\t\t\tthis.tempB,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst uvX = sX + v * invTH;\n\t\t\t\t\t\tconst uvY = 1 - sY - u * invTW;\n\n\t\t\t\t\t\t// 使用批量设置方法减少数组访问次数\n\t\t\t\t\t\tthis.setVertexData(vxOffset, vy, px, py, pr, pg, pb, uvX, uvY);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.update();\n\t}\n}\n\nclass GLTexture implements Disposable {\n\treadonly tex: WebGLTexture;\n\n\tconstructor(\n\t\tprivate gl: WebGLRenderingContext,\n\t\talbumImageData: ImageData,\n\t) {\n\t\tconst albumTexture = gl.createTexture();\n\t\tif (!albumTexture) throw new Error(\"Failed to create texture\");\n\t\tthis.tex = albumTexture;\n\t\tgl.activeTexture(gl.TEXTURE0);\n\t\tgl.bindTexture(gl.TEXTURE_2D, albumTexture);\n\t\tgl.texImage2D(\n\t\t\tgl.TEXTURE_2D,\n\t\t\t0,\n\t\t\tgl.RGBA,\n\t\t\tgl.RGBA,\n\t\t\tgl.UNSIGNED_BYTE,\n\t\t\talbumImageData,\n\t\t);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.MIRRORED_REPEAT);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.MIRRORED_REPEAT);\n\t}\n\n\tbind() {\n\t\tthis.gl.bindTexture(this.gl.TEXTURE_2D, this.tex);\n\t}\n\n\tdispose(): void {\n\t\tthis.gl.deleteTexture(this.tex);\n\t}\n}\n\nfunction createOffscreenCanvas(width: number, height: number) {\n\tif (\"OffscreenCanvas\" in window) return new OffscreenCanvas(width, height);\n\tconst canvas = document.createElement(\"canvas\");\n\tcanvas.width = width;\n\tcanvas.height = height;\n\treturn canvas;\n}\n\ninterface MeshState {\n\tmesh: BHPMesh;\n\ttexture: GLTexture;\n\talpha: number;\n}\n\nexport class MeshGradientRenderer extends BaseRenderer {\n\tprivate gl: RenderingContext;\n\tprivate lastFrameTime = 0;\n\tprivate frameTime = 0;\n\tprivate currentImageData?: ImageData;\n\tprivate lastTickTime = 0;\n\tprivate smoothedVolume = 0;\n\tprivate volume = 0;\n\tprivate tickHandle = 0;\n\tprivate maxFPS = 60;\n\tprivate paused = false;\n\tprivate staticMode = false;\n\tprivate mainProgram: GLProgram;\n\tprivate manualControl = false;\n\tprivate reduceImageSizeCanvas = createOffscreenCanvas(\n\t\t32,\n\t\t32,\n\t) as HTMLCanvasElement;\n\tprivate targetSize = Vec2.fromValues(0, 0);\n\tprivate currentSize = Vec2.fromValues(0, 0);\n\tprivate isNoCover = true;\n\tprivate meshStates: MeshState[] = [];\n\tprivate _disposed = false;\n\t// 性能监控\n\tprivate frameCount = 0;\n\tprivate lastFPSUpdate = 0;\n\tprivate currentFPS = 0;\n\tprivate enablePerformanceMonitoring = false;\n\n\tsetManualControl(enable: boolean) {\n\t\tthis.manualControl = enable;\n\t}\n\n\tsetWireFrame(enable: boolean) {\n\t\tfor (const state of this.meshStates) {\n\t\t\tstate.mesh.setWireFrame(enable);\n\t\t}\n\t}\n\n\tgetControlPoint(x: number, y: number): ControlPoint | undefined {\n\t\treturn this.meshStates[this.meshStates.length - 1]?.mesh?.getControlPoint(\n\t\t\tx,\n\t\t\ty,\n\t\t);\n\t}\n\n\tresizeControlPoints(width: number, height: number) {\n\t\treturn this.meshStates[\n\t\t\tthis.meshStates.length - 1\n\t\t]?.mesh?.resizeControlPoints(width, height);\n\t}\n\n\tresetSubdivition(subDivisions: number) {\n\t\treturn this.meshStates[this.meshStates.length - 1]?.mesh?.resetSubdivition(\n\t\t\tsubDivisions,\n\t\t);\n\t}\n\n\tprivate onTick(tickTime: number) {\n\t\tthis.tickHandle = 0;\n\t\tif (this.paused) return;\n\t\tif (this._disposed) return;\n\n\t\t// 更新性能统计\n\t\tthis.updatePerformanceStats(tickTime);\n\n\t\tif (Number.isNaN(this.lastFrameTime)) {\n\t\t\tthis.lastFrameTime = tickTime;\n\t\t}\n\t\tconst delta = tickTime - this.lastTickTime;\n\t\tconst frameDelta = tickTime - this.lastFrameTime;\n\t\tthis.lastFrameTime = tickTime;\n\t\tif (delta < 1000 / this.maxFPS) {\n\t\t\tthis.requestTick();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.frameTime += frameDelta * this.flowSpeed;\n\n\t\tif (!(this.onRedraw(this.frameTime, frameDelta) && this.staticMode)) {\n\t\t\tthis.requestTick();\n\t\t} else if (this.staticMode) {\n\t\t\tthis.lastFrameTime = Number.NaN;\n\t\t}\n\n\t\tthis.lastTickTime = tickTime;\n\t}\n\n\tprivate checkIfResize() {\n\t\tconst [tW, tH] = [this.targetSize.x, this.targetSize.y];\n\t\tconst [cW, cH] = [this.currentSize.x, this.currentSize.y];\n\t\tif (tW !== cW || tH !== cH) {\n\t\t\tsuper.onResize(tW, tH);\n\t\t\tconst gl = this.gl;\n\t\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\t\t\tgl.viewport(0, 0, tW, tH);\n\t\t\tthis.currentSize.x = tW;\n\t\t\tthis.currentSize.y = tH;\n\t\t}\n\t}\n\n\tprivate onRedraw(tickTime: number, delta: number) {\n\t\tconst latestMeshState = this.meshStates[this.meshStates.length - 1];\n\t\tlet canBeStatic = false;\n\n\t\t// 预计算常用值\n\t\tconst deltaFactor = delta / 500;\n\n\t\tif (latestMeshState) {\n\t\t\tlatestMeshState.mesh.bind();\n\t\t\t// 考虑到我们并不逐帧更新网格控制点，因此也不需要重复调用 updateMesh\n\t\t\tif (this.manualControl) latestMeshState.mesh.updateMesh();\n\n\t\t\tif (this.isNoCover) {\n\t\t\t\t// 批量处理alpha更新，减少循环开销\n\t\t\t\tlet hasActiveStates = false;\n\t\t\t\tfor (let i = this.meshStates.length - 1; i >= 0; i--) {\n\t\t\t\t\tconst state = this.meshStates[i];\n\t\t\t\t\tstate.alpha = Math.max(0, state.alpha - deltaFactor);\n\t\t\t\t\tif (state.alpha > 0) {\n\t\t\t\t\t\thasActiveStates = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 立即释放资源\n\t\t\t\t\t\tstate.mesh.dispose();\n\t\t\t\t\t\tstate.texture.dispose();\n\t\t\t\t\t\tthis.meshStates.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcanBeStatic = !hasActiveStates;\n\t\t\t} else {\n\t\t\t\tlatestMeshState.alpha = Math.min(\n\t\t\t\t\t1,\n\t\t\t\t\tlatestMeshState.alpha + deltaFactor,\n\t\t\t\t);\n\t\t\t\tif (latestMeshState.alpha >= 1) {\n\t\t\t\t\t// 批量清理旧状态\n\t\t\t\t\tconst deleted = this.meshStates.splice(0, this.meshStates.length - 1);\n\t\t\t\t\tfor (const state of deleted) {\n\t\t\t\t\t\tstate.mesh.dispose();\n\t\t\t\t\t\tstate.texture.dispose();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcanBeStatic =\n\t\t\t\t\tthis.meshStates.length === 1 && latestMeshState.alpha >= 1;\n\t\t\t}\n\t\t}\n\n\t\tconst gl = this.gl;\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\t\tgl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\t\tgl.clear(gl.COLOR_BUFFER_BIT);\n\t\tthis.checkIfResize();\n\n\t\tconst lerpFactor = Math.min(1.0, delta / 100.0);\n\t\tthis.smoothedVolume += (this.volume - this.smoothedVolume) * lerpFactor;\n\n\t\tthis.mainProgram.use();\n\n\t\t// 预设置不变的uniform\n\t\tgl.activeTexture(gl.TEXTURE0);\n\t\tthis.mainProgram.setUniform1f(\"u_time\", tickTime / 10000);\n\t\tthis.mainProgram.setUniform1f(\n\t\t\t\"u_aspect\",\n\t\t\tthis.manualControl ? 1 : this.canvas.width / this.canvas.height,\n\t\t);\n\t\tthis.mainProgram.setUniform1i(\"u_texture\", 0);\n\t\tthis.mainProgram.setUniform1f(\"u_volume\", this.volume);\n\n\t\t// 渲染所有网格状态\n\t\tfor (const state of this.meshStates) {\n\t\t\tthis.mainProgram.setUniform1f(\"u_alpha\", state.alpha);\n\t\t\tstate.texture.bind();\n\t\t\tstate.mesh.bind();\n\t\t\tstate.mesh.draw();\n\t\t}\n\n\t\tgl.flush();\n\n\t\treturn canBeStatic;\n\t}\n\n\tprivate onTickBinded = this.onTick.bind(this);\n\n\tprivate requestTick() {\n\t\tif (this._disposed) return;\n\t\tif (this.tickHandle === 0)\n\t\t\tthis.tickHandle = requestAnimationFrame(this.onTickBinded);\n\t}\n\n\tprivate supportTextureFloat = true;\n\n\tconstructor(canvas: HTMLCanvasElement) {\n\t\tsuper(canvas);\n\n\t\tconst gl = canvas.getContext(\"webgl\");\n\t\tif (!gl) throw new Error(\"WebGL not supported\");\n\t\tif (!gl.getExtension(\"EXT_color_buffer_float\"))\n\t\t\tconsole.warn(\"EXT_color_buffer_float not supported\");\n\t\tif (!gl.getExtension(\"EXT_float_blend\")) {\n\t\t\tconsole.warn(\"EXT_float_blend not supported\");\n\t\t\tthis.supportTextureFloat = false;\n\t\t}\n\t\tif (!gl.getExtension(\"OES_texture_float_linear\"))\n\t\t\tconsole.warn(\"OES_texture_float_linear not supported\");\n\t\tif (!gl.getExtension(\"OES_texture_float\")) {\n\t\t\tthis.supportTextureFloat = false;\n\t\t\tconsole.warn(\"OES_texture_float not supported\");\n\t\t}\n\n\t\tthis.gl = gl;\n\t\tgl.enable(gl.BLEND);\n\t\tgl.enable(gl.DEPTH_TEST);\n\t\tgl.depthFunc(gl.ALWAYS);\n\n\t\tthis.mainProgram = new GLProgram(\n\t\t\tgl,\n\t\t\tmeshVertShader,\n\t\t\tmeshFragShader,\n\t\t\t\"main-program-mg\",\n\t\t);\n\n\t\tthis.requestTick();\n\t}\n\n\tprotected override onResize(width: number, height: number): void {\n\t\tthis.targetSize.x = Math.ceil(width);\n\t\tthis.targetSize.y = Math.ceil(height);\n\t\tthis.requestTick();\n\t}\n\n\toverride setStaticMode(enable: boolean): void {\n\t\tthis.staticMode = enable;\n\t\tthis.lastFrameTime = performance.now();\n\t\tthis.requestTick();\n\t}\n\toverride setFPS(fps: number): void {\n\t\tthis.maxFPS = fps;\n\t}\n\toverride pause(): void {\n\t\tif (this.tickHandle) {\n\t\t\tcancelAnimationFrame(this.tickHandle);\n\t\t\tthis.tickHandle = 0;\n\t\t}\n\t\tthis.paused = true;\n\t}\n\toverride resume(): void {\n\t\tthis.paused = false;\n\t\tthis.requestTick();\n\t}\n\toverride async setAlbum(\n\t\talbumSource?: string | HTMLImageElement | HTMLVideoElement,\n\t\tisVideo?: boolean,\n\t): Promise<void> {\n\t\tif (\n\t\t\talbumSource === undefined ||\n\t\t\t(typeof albumSource === \"string\" && albumSource.trim().length === 0)\n\t\t) {\n\t\t\tthis.isNoCover = true;\n\t\t\treturn;\n\t\t}\n\t\tlet res: HTMLImageElement | HTMLVideoElement | null = null;\n\t\tlet remainRetryTimes = 5;\n\t\twhile (!res && remainRetryTimes > 0) {\n\t\t\ttry {\n\t\t\t\tif (typeof albumSource === \"string\") {\n\t\t\t\t\tres = await loadResourceFromUrl(albumSource, isVideo);\n\t\t\t\t} else {\n\t\t\t\t\tres = await loadResourceFromElement(albumSource);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.warn(\n\t\t\t\t\t`failed on loading album resource, retrying (${remainRetryTimes})`,\n\t\t\t\t\t{\n\t\t\t\t\t\talbumSource,\n\t\t\t\t\t\terror,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tremainRetryTimes--;\n\t\t\t}\n\t\t}\n\t\tif (!res) {\n\t\t\tconsole.error(\"Failed to load album resource\", albumSource);\n\t\t\tthis.isNoCover = true;\n\t\t\treturn;\n\t\t}\n\t\tthis.isNoCover = false;\n\t\t// resize image\n\t\tconst c = this.reduceImageSizeCanvas;\n\t\tconst ctx = c.getContext(\"2d\", {\n\t\t\twillReadFrequently: true,\n\t\t});\n\t\tif (!ctx) throw new Error(\"Failed to create canvas context\");\n\t\tctx.clearRect(0, 0, c.width, c.height);\n\t\t// Safari 不支持 filter\n\t\t// ctx.filter = baseFilter;\n\t\tconst imgw =\n\t\t\tres instanceof HTMLVideoElement ? res.videoWidth : res.naturalWidth;\n\t\tconst imgh =\n\t\t\tres instanceof HTMLVideoElement ? res.videoHeight : res.naturalHeight;\n\t\tif (imgw * imgh === 0) throw new Error(\"Invalid image size\");\n\t\tctx.drawImage(res, 0, 0, imgw, imgh, 0, 0, c.width, c.height);\n\n\t\tconst imageData = ctx.getImageData(0, 0, c.width, c.height);\n\t\tcontrastImage(imageData, 0.4);\n\t\tsaturateImage(imageData, 3.0);\n\t\tcontrastImage(imageData, 1.7);\n\t\tbrightnessImage(imageData, 0.75);\n\t\tblurImage(imageData, 2, 4);\n\n\t\tif (this.manualControl && this.meshStates.length > 0) {\n\t\t\tthis.meshStates[0].texture.dispose();\n\t\t\tthis.meshStates[0].texture = new GLTexture(this.gl, imageData);\n\t\t} else {\n\t\t\tconst newMesh = new BHPMesh(\n\t\t\t\tthis.gl,\n\t\t\t\tthis.mainProgram.attrs.a_pos,\n\t\t\t\tthis.mainProgram.attrs.a_color,\n\t\t\t\tthis.mainProgram.attrs.a_uv,\n\t\t\t);\n\t\t\tnewMesh.resetSubdivition(15);\n\n\t\t\tconst chosenPreset =\n\t\t\t\tMath.random() > 0.8\n\t\t\t\t\t? generateControlPoints(6, 6)\n\t\t\t\t\t: CONTROL_POINT_PRESETS[\n\t\t\t\t\t\t\tMath.floor(Math.random() * CONTROL_POINT_PRESETS.length)\n\t\t\t\t\t\t];\n\n\t\t\tnewMesh.resizeControlPoints(chosenPreset.width, chosenPreset.height);\n\t\t\tconst uPower = 2 / (chosenPreset.width - 1);\n\t\t\tconst vPower = 2 / (chosenPreset.height - 1);\n\t\t\tfor (const cp of chosenPreset.conf) {\n\t\t\t\tconst p = newMesh.getControlPoint(cp.cx, cp.cy);\n\t\t\t\tp.location.x = cp.x;\n\t\t\t\tp.location.y = cp.y;\n\t\t\t\tp.uRot = (cp.ur * Math.PI) / 180;\n\t\t\t\tp.vRot = (cp.vr * Math.PI) / 180;\n\t\t\t\tp.uScale = uPower * cp.up;\n\t\t\t\tp.vScale = vPower * cp.vp;\n\t\t\t}\n\n\t\t\tnewMesh.updateMesh();\n\t\t\tthis.currentImageData = imageData;\n\n\t\t\tconst albumTexture = new GLTexture(this.gl, imageData);\n\t\t\tconst newState: MeshState = {\n\t\t\t\tmesh: newMesh,\n\t\t\t\ttexture: albumTexture,\n\t\t\t\talpha: 0,\n\t\t\t};\n\t\t\tthis.meshStates.push(newState);\n\t\t}\n\n\t\tthis.requestTick();\n\t}\n\toverride setLowFreqVolume(volume: number): void {\n\t\tthis.volume = volume / 10;\n\t}\n\toverride setHasLyric(_hasLyric: boolean): void {\n\t\t// 不再考虑实现\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t\tif (this.tickHandle) {\n\t\t\tcancelAnimationFrame(this.tickHandle);\n\t\t\tthis.tickHandle = 0;\n\t\t}\n\t\tthis._disposed = true;\n\t\tthis.mainProgram.dispose();\n\t\tfor (const state of this.meshStates) {\n\t\t\tstate.mesh.dispose();\n\t\t\tstate.texture.dispose();\n\t\t}\n\t}\n\n\tenablePerformanceMonitor(enable: boolean) {\n\t\tthis.enablePerformanceMonitoring = enable;\n\t\tif (enable) {\n\t\t\tthis.frameCount = 0;\n\t\t\tthis.lastFPSUpdate = performance.now();\n\t\t}\n\t}\n\n\tgetCurrentFPS(): number {\n\t\treturn this.currentFPS;\n\t}\n\n\tprivate updatePerformanceStats(tickTime: number) {\n\t\tif (!this.enablePerformanceMonitoring) return;\n\n\t\tthis.frameCount++;\n\t\tif (tickTime - this.lastFPSUpdate > 1000) {\n\t\t\tthis.currentFPS = this.frameCount;\n\t\t\tthis.frameCount = 0;\n\t\t\tthis.lastFPSUpdate = tickTime;\n\t\t}\n\t}\n}\n","import { Application } from \"@pixi/app\";\nimport { Texture } from \"@pixi/core\";\nimport { Container } from \"@pixi/display\";\nimport { BlurFilter } from \"@pixi/filter-blur\";\nimport { BulgePinchFilter } from \"@pixi/filter-bulge-pinch\";\nimport { ColorMatrixFilter } from \"@pixi/filter-color-matrix\";\nimport { Sprite } from \"@pixi/sprite\";\nimport {\n\tloadResourceFromElement,\n\tloadResourceFromUrl,\n} from \"../utils/resource\";\nimport { BaseRenderer } from \"./base\";\n\nclass TimedContainer extends Container {\n\tpublic time = 0;\n}\n\nexport class PixiRenderer extends BaseRenderer {\n\tprivate app: Application;\n\tprivate curContainer?: TimedContainer;\n\tprivate staticMode = false;\n\tprivate lastContainer: Set<TimedContainer> = new Set();\n\tprivate onTick = (delta: number): void => {\n\t\tfor (const lastContainer of this.lastContainer) {\n\t\t\tlastContainer.alpha = Math.max(0, lastContainer.alpha - delta / 60);\n\t\t\tif (lastContainer.alpha <= 0) {\n\t\t\t\tthis.app.stage.removeChild(lastContainer);\n\t\t\t\tthis.lastContainer.delete(lastContainer);\n\t\t\t\tlastContainer.destroy(true);\n\t\t\t}\n\t\t}\n\n\t\tif (this.curContainer) {\n\t\t\tthis.curContainer.alpha = Math.min(\n\t\t\t\t1,\n\t\t\t\tthis.curContainer.alpha + delta / 60,\n\t\t\t);\n\t\t\tconst [s1, s2, s3, s4] = this.curContainer.children as Sprite[];\n\t\t\tconst maxSize = Math.max(this.app.screen.width, this.app.screen.height);\n\t\t\ts1.position.set(this.app.screen.width / 2, this.app.screen.height / 2);\n\t\t\ts2.position.set(\n\t\t\t\tthis.app.screen.width / 2.5,\n\t\t\t\tthis.app.screen.height / 2.5,\n\t\t\t);\n\t\t\ts3.position.set(this.app.screen.width / 2, this.app.screen.height / 2);\n\t\t\ts4.position.set(this.app.screen.width / 2, this.app.screen.height / 2);\n\t\t\ts1.width = maxSize * Math.sqrt(2);\n\t\t\ts1.height = s1.width;\n\t\t\ts2.width = maxSize * 0.8;\n\t\t\ts2.height = s2.width;\n\t\t\ts3.width = maxSize * 0.5;\n\t\t\ts3.height = s3.width;\n\t\t\ts4.width = maxSize * 0.25;\n\t\t\ts4.height = s4.width;\n\n\t\t\tthis.curContainer.time += delta * this.flowSpeed;\n\n\t\t\ts1.rotation += (delta / 1000) * this.flowSpeed;\n\t\t\ts2.rotation -= (delta / 500) * this.flowSpeed;\n\t\t\ts3.rotation += (delta / 1000) * this.flowSpeed;\n\t\t\ts4.rotation -= (delta / 750) * this.flowSpeed;\n\n\t\t\ts3.x =\n\t\t\t\tthis.app.screen.width / 2 +\n\t\t\t\t(this.app.screen.width / 4) *\n\t\t\t\t\tMath.cos((this.curContainer.time / 1000) * 0.75);\n\t\t\ts3.y =\n\t\t\t\tthis.app.screen.height / 2 +\n\t\t\t\t(this.app.screen.width / 4) *\n\t\t\t\t\tMath.cos((this.curContainer.time / 1000) * 0.75);\n\n\t\t\ts4.x =\n\t\t\t\tthis.app.screen.width / 2 +\n\t\t\t\t(this.app.screen.width / 4) * 0.1 +\n\t\t\t\tMath.cos(this.curContainer.time * 0.006 * 0.75);\n\t\t\ts4.y =\n\t\t\t\tthis.app.screen.height / 2 +\n\t\t\t\t(this.app.screen.width / 4) * 0.1 +\n\t\t\t\tMath.cos(this.curContainer.time * 0.006 * 0.75);\n\n\t\t\tif (\n\t\t\t\tthis.curContainer.alpha >= 1 &&\n\t\t\t\tthis.lastContainer.size === 0 &&\n\t\t\t\tthis.staticMode\n\t\t\t) {\n\t\t\t\tthis.app.ticker.stop();\n\t\t\t}\n\t\t}\n\t};\n\tconstructor(protected override canvas: HTMLCanvasElement) {\n\t\tsuper(canvas);\n\t\tthis.app = new Application({\n\t\t\tview: canvas,\n\t\t\tresizeTo: this.canvas,\n\t\t\tpowerPreference: \"low-power\",\n\t\t\tbackgroundAlpha: 1,\n\t\t});\n\t\tthis.rebuildFilters();\n\t\tthis.app.ticker.maxFPS = 30;\n\t\tthis.app.ticker.add(this.onTick);\n\t\tthis.app.ticker.start();\n\t}\n\n\tprotected override onResize(width: number, height: number): void {\n\t\tsuper.onResize(width, height);\n\t\tthis.app.resize();\n\t\tthis.rebuildFilters();\n\t}\n\n\toverride setRenderScale(scale: number) {\n\t\tsuper.setRenderScale(scale);\n\t\tthis.rebuildFilters();\n\t}\n\tprivate rebuildFilters() {\n\t\tconst minBorder = Math.min(this.canvas.width, this.canvas.height);\n\t\tconst maxBorder = Math.max(this.canvas.width, this.canvas.height);\n\t\tconst c0 = new ColorMatrixFilter();\n\t\tc0.saturate(1.2, false);\n\t\tconst c1 = new ColorMatrixFilter();\n\t\tc1.brightness(0.6, false);\n\t\tconst c2 = new ColorMatrixFilter();\n\t\tc2.contrast(0.3, true);\n\t\tfor (const filter of this.app.stage.filters ?? []) {\n\t\t\tfilter.destroy();\n\t\t}\n\t\tthis.app.stage.filters = [];\n\t\tthis.app.stage.filters.push(new BlurFilter(5, 1));\n\t\tthis.app.stage.filters.push(new BlurFilter(10, 1));\n\t\tthis.app.stage.filters.push(new BlurFilter(20, 2));\n\t\tthis.app.stage.filters.push(new BlurFilter(40, 2));\n\t\tthis.app.stage.filters.push(new BlurFilter(80, 2));\n\t\tif (minBorder > 768) this.app.stage.filters.push(new BlurFilter(160, 4));\n\t\tif (minBorder > 768 * 2)\n\t\t\tthis.app.stage.filters.push(new BlurFilter(320, 4));\n\n\t\tthis.app.stage.filters.push(c0, c1, c2);\n\t\tthis.app.stage.filters.push(new BlurFilter(5, 1));\n\t\tif (Math.random() > 0.5) {\n\t\t\tthis.app.stage.filters.push(\n\t\t\t\tnew BulgePinchFilter({\n\t\t\t\t\tradius: (maxBorder + minBorder) / 2,\n\t\t\t\t\tstrength: 1,\n\t\t\t\t\tcenter: [0.25, 1],\n\t\t\t\t}),\n\t\t\t);\n\t\t\tthis.app.stage.filters.push(\n\t\t\t\tnew BulgePinchFilter({\n\t\t\t\t\tradius: (maxBorder + minBorder) / 2,\n\t\t\t\t\tstrength: 1,\n\t\t\t\t\tcenter: [0.75, 0],\n\t\t\t\t}),\n\t\t\t);\n\t\t} else {\n\t\t\tthis.app.stage.filters.push(\n\t\t\t\tnew BulgePinchFilter({\n\t\t\t\t\tradius: (maxBorder + minBorder) / 2,\n\t\t\t\t\tstrength: 1,\n\t\t\t\t\tcenter: [0.75, 1],\n\t\t\t\t}),\n\t\t\t);\n\t\t\tthis.app.stage.filters.push(\n\t\t\t\tnew BulgePinchFilter({\n\t\t\t\t\tradius: (maxBorder + minBorder) / 2,\n\t\t\t\t\tstrength: 1,\n\t\t\t\t\tcenter: [0.25, 0],\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t}\n\n\toverride setStaticMode(enable = false) {\n\t\tthis.staticMode = enable;\n\t\tthis.app.ticker.start();\n\t}\n\n\toverride setFPS(fps: number) {\n\t\tthis.app.ticker.maxFPS = fps;\n\t}\n\n\toverride pause() {\n\t\tthis.app.ticker.stop();\n\t\tthis.app.render();\n\t}\n\n\toverride resume() {\n\t\tthis.app.ticker.start();\n\t}\n\n\toverride setLowFreqVolume(_volume: number): void {\n\t\t// NOOP\n\t}\n\n\toverride setHasLyric(_hasLyric: boolean): void {\n\t\t// NOOP\n\t}\n\n\toverride async setAlbum(\n\t\talbumSource?: string | HTMLImageElement | HTMLVideoElement,\n\t\tisVideo?: boolean,\n\t): Promise<void> {\n\t\tif (\n\t\t\t!albumSource ||\n\t\t\t(typeof albumSource === \"string\" && albumSource.trim().length === 0)\n\t\t)\n\t\t\treturn;\n\t\tlet res: HTMLImageElement | HTMLVideoElement | null = null;\n\t\tlet remainRetryTimes = 5;\n\t\tlet tex: Texture | null = null;\n\t\twhile (!tex?.baseTexture?.resource?.valid && remainRetryTimes > 0) {\n\t\t\ttry {\n\t\t\t\tif (typeof albumSource === \"string\") {\n\t\t\t\t\tres = await loadResourceFromUrl(albumSource, isVideo);\n\t\t\t\t} else {\n\t\t\t\t\tres = await loadResourceFromElement(albumSource);\n\t\t\t\t}\n\t\t\t\ttex = Texture.from(res, {\n\t\t\t\t\tresourceOptions: {\n\t\t\t\t\t\tautoLoad: false,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tawait tex.baseTexture.resource.load();\n\t\t\t} catch (error) {\n\t\t\t\tconsole.warn(\n\t\t\t\t\t`failed on loading album image, retrying (${remainRetryTimes})`,\n\t\t\t\t\talbumSource,\n\t\t\t\t\terror,\n\t\t\t\t);\n\t\t\t\ttex = null;\n\t\t\t\tremainRetryTimes--;\n\t\t\t}\n\t\t}\n\t\tif (!tex) return;\n\t\tconst container = new TimedContainer();\n\t\tconst s1 = new Sprite(tex);\n\t\tconst s2 = new Sprite(tex);\n\t\tconst s3 = new Sprite(tex);\n\t\tconst s4 = new Sprite(tex);\n\t\ts1.anchor.set(0.5, 0.5);\n\t\ts2.anchor.set(0.5, 0.5);\n\t\ts3.anchor.set(0.5, 0.5);\n\t\ts4.anchor.set(0.5, 0.5);\n\t\ts1.rotation = Math.random() * Math.PI * 2;\n\t\ts2.rotation = Math.random() * Math.PI * 2;\n\t\ts3.rotation = Math.random() * Math.PI * 2;\n\t\ts4.rotation = Math.random() * Math.PI * 2;\n\t\tcontainer.addChild(s1, s2, s3, s4);\n\t\tif (this.curContainer) this.lastContainer.add(this.curContainer);\n\t\tthis.curContainer = container;\n\t\tthis.app.stage.addChild(container);\n\t\tthis.curContainer.alpha = 0;\n\t\tthis.app.ticker.start();\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\t\tthis.app.ticker.remove(this.onTick);\n\t\tthis.app.destroy(true);\n\t}\n\n\toverride getElement(): HTMLElement {\n\t\treturn this.canvas;\n\t}\n}\n","/**\n * @fileoverview\n * 一个播放歌词的组件\n * @author SteveXMH\n */\n\nexport { AbstractBaseRenderer, BaseRenderer } from \"./base.ts\";\nexport { MeshGradientRenderer } from \"./mesh-renderer/index.ts\";\nexport { PixiRenderer } from \"./pixi-renderer.ts\";\nimport type { AbstractBaseRenderer, BaseRenderer } from \"./base.ts\";\n\nexport class BackgroundRender<Renderer extends BaseRenderer>\n\timplements AbstractBaseRenderer\n{\n\tprivate element: HTMLCanvasElement;\n\tprivate renderer: Renderer;\n\tconstructor(renderer: Renderer, canvas: HTMLCanvasElement) {\n\t\tthis.renderer = renderer;\n\n\t\tthis.element = canvas;\n\t\tcanvas.style.pointerEvents = \"none\";\n\t\tcanvas.style.zIndex = \"-1\";\n\t\tcanvas.style.contain = \"strict\";\n\t}\n\n\tstatic new<Renderer extends BaseRenderer>(type: {\n\t\tnew (canvas: HTMLCanvasElement): Renderer;\n\t}): BackgroundRender<Renderer> {\n\t\tconst newCanvas = document.createElement(\"canvas\");\n\t\treturn new BackgroundRender(new type(newCanvas), newCanvas);\n\t}\n\n\tsetRenderScale(scale: number): void {\n\t\tthis.renderer.setRenderScale(scale);\n\t}\n\n\tsetFlowSpeed(speed: number): void {\n\t\tthis.renderer.setFlowSpeed(speed);\n\t}\n\tsetStaticMode(enable: boolean): void {\n\t\tthis.renderer.setStaticMode(enable);\n\t}\n\tsetFPS(fps: number): void {\n\t\tthis.renderer.setFPS(fps);\n\t}\n\tpause(): void {\n\t\tthis.renderer.pause();\n\t}\n\tresume(): void {\n\t\tthis.renderer.resume();\n\t}\n\tsetLowFreqVolume(volume: number): void {\n\t\tthis.renderer.setLowFreqVolume(volume);\n\t}\n\tsetHasLyric(hasLyric: boolean): void {\n\t\tthis.renderer.setHasLyric(hasLyric);\n\t}\n\tsetAlbum(\n\t\talbumSource: string | HTMLImageElement | HTMLVideoElement,\n\t\tisVideo?: boolean,\n\t): Promise<void> {\n\t\treturn this.renderer.setAlbum(albumSource, isVideo);\n\t}\n\tgetElement() {\n\t\treturn this.element;\n\t}\n\tdispose() {\n\t\tthis.renderer.dispose();\n\t\tthis.element.remove();\n\t}\n}\n","export const VOID       = -1;\nexport const PRIMITIVE  = 0;\nexport const ARRAY      = 1;\nexport const OBJECT     = 2;\nexport const DATE       = 3;\nexport const REGEXP     = 4;\nexport const MAP        = 5;\nexport const SET        = 6;\nexport const ERROR      = 7;\nexport const BIGINT     = 8;\n// export const SYMBOL = 9;\n","import {\n  VOID, PRIMITIVE,\n  ARRAY, OBJECT,\n  DATE, REGEXP, MAP, SET,\n  ERROR, BIGINT\n} from './types.js';\n\nconst env = typeof self === 'object' ? self : globalThis;\n\nconst deserializer = ($, _) => {\n  const as = (out, index) => {\n    $.set(index, out);\n    return out;\n  };\n\n  const unpair = index => {\n    if ($.has(index))\n      return $.get(index);\n\n    const [type, value] = _[index];\n    switch (type) {\n      case PRIMITIVE:\n      case VOID:\n        return as(value, index);\n      case ARRAY: {\n        const arr = as([], index);\n        for (const index of value)\n          arr.push(unpair(index));\n        return arr;\n      }\n      case OBJECT: {\n        const object = as({}, index);\n        for (const [key, index] of value)\n          object[unpair(key)] = unpair(index);\n        return object;\n      }\n      case DATE:\n        return as(new Date(value), index);\n      case REGEXP: {\n        const {source, flags} = value;\n        return as(new RegExp(source, flags), index);\n      }\n      case MAP: {\n        const map = as(new Map, index);\n        for (const [key, index] of value)\n          map.set(unpair(key), unpair(index));\n        return map;\n      }\n      case SET: {\n        const set = as(new Set, index);\n        for (const index of value)\n          set.add(unpair(index));\n        return set;\n      }\n      case ERROR: {\n        const {name, message} = value;\n        return as(new env[name](message), index);\n      }\n      case BIGINT:\n        return as(BigInt(value), index);\n      case 'BigInt':\n        return as(Object(BigInt(value)), index);\n      case 'ArrayBuffer':\n        return as(new Uint8Array(value).buffer, value);\n      case 'DataView': {\n        const { buffer } = new Uint8Array(value);\n        return as(new DataView(buffer), value);\n      }\n    }\n    return as(new env[type](value), index);\n  };\n\n  return unpair;\n};\n\n/**\n * @typedef {Array<string,any>} Record a type representation\n */\n\n/**\n * Returns a deserialized value from a serialized array of Records.\n * @param {Record[]} serialized a previously serialized value.\n * @returns {any}\n */\nexport const deserialize = serialized => deserializer(new Map, serialized)(0);\n","import {\n  VOID, PRIMITIVE,\n  ARRAY, OBJECT,\n  DATE, REGEXP, MAP, SET,\n  ERROR, BIGINT\n} from './types.js';\n\nconst EMPTY = '';\n\nconst {toString} = {};\nconst {keys} = Object;\n\nconst typeOf = value => {\n  const type = typeof value;\n  if (type !== 'object' || !value)\n    return [PRIMITIVE, type];\n\n  const asString = toString.call(value).slice(8, -1);\n  switch (asString) {\n    case 'Array':\n      return [ARRAY, EMPTY];\n    case 'Object':\n      return [OBJECT, EMPTY];\n    case 'Date':\n      return [DATE, EMPTY];\n    case 'RegExp':\n      return [REGEXP, EMPTY];\n    case 'Map':\n      return [MAP, EMPTY];\n    case 'Set':\n      return [SET, EMPTY];\n    case 'DataView':\n      return [ARRAY, asString];\n  }\n\n  if (asString.includes('Array'))\n    return [ARRAY, asString];\n\n  if (asString.includes('Error'))\n    return [ERROR, asString];\n\n  return [OBJECT, asString];\n};\n\nconst shouldSkip = ([TYPE, type]) => (\n  TYPE === PRIMITIVE &&\n  (type === 'function' || type === 'symbol')\n);\n\nconst serializer = (strict, json, $, _) => {\n\n  const as = (out, value) => {\n    const index = _.push(out) - 1;\n    $.set(value, index);\n    return index;\n  };\n\n  const pair = value => {\n    if ($.has(value))\n      return $.get(value);\n\n    let [TYPE, type] = typeOf(value);\n    switch (TYPE) {\n      case PRIMITIVE: {\n        let entry = value;\n        switch (type) {\n          case 'bigint':\n            TYPE = BIGINT;\n            entry = value.toString();\n            break;\n          case 'function':\n          case 'symbol':\n            if (strict)\n              throw new TypeError('unable to serialize ' + type);\n            entry = null;\n            break;\n          case 'undefined':\n            return as([VOID], value);\n        }\n        return as([TYPE, entry], value);\n      }\n      case ARRAY: {\n        if (type) {\n          let spread = value;\n          if (type === 'DataView') {\n            spread = new Uint8Array(value.buffer);\n          }\n          else if (type === 'ArrayBuffer') {\n            spread = new Uint8Array(value);\n          }\n          return as([type, [...spread]], value);\n        }\n\n        const arr = [];\n        const index = as([TYPE, arr], value);\n        for (const entry of value)\n          arr.push(pair(entry));\n        return index;\n      }\n      case OBJECT: {\n        if (type) {\n          switch (type) {\n            case 'BigInt':\n              return as([type, value.toString()], value);\n            case 'Boolean':\n            case 'Number':\n            case 'String':\n              return as([type, value.valueOf()], value);\n          }\n        }\n\n        if (json && ('toJSON' in value))\n          return pair(value.toJSON());\n\n        const entries = [];\n        const index = as([TYPE, entries], value);\n        for (const key of keys(value)) {\n          if (strict || !shouldSkip(typeOf(value[key])))\n            entries.push([pair(key), pair(value[key])]);\n        }\n        return index;\n      }\n      case DATE:\n        return as([TYPE, value.toISOString()], value);\n      case REGEXP: {\n        const {source, flags} = value;\n        return as([TYPE, {source, flags}], value);\n      }\n      case MAP: {\n        const entries = [];\n        const index = as([TYPE, entries], value);\n        for (const [key, entry] of value) {\n          if (strict || !(shouldSkip(typeOf(key)) || shouldSkip(typeOf(entry))))\n            entries.push([pair(key), pair(entry)]);\n        }\n        return index;\n      }\n      case SET: {\n        const entries = [];\n        const index = as([TYPE, entries], value);\n        for (const entry of value) {\n          if (strict || !shouldSkip(typeOf(entry)))\n            entries.push(pair(entry));\n        }\n        return index;\n      }\n    }\n\n    const {message} = value;\n    return as([TYPE, {name: type, message}], value);\n  };\n\n  return pair;\n};\n\n/**\n * @typedef {Array<string,any>} Record a type representation\n */\n\n/**\n * Returns an array of serialized Records.\n * @param {any} value a serializable value.\n * @param {{json?: boolean, lossy?: boolean}?} options an object with a `lossy` or `json` property that,\n *  if `true`, will not throw errors on incompatible types, and behave more\n *  like JSON stringify would behave. Symbol and Function will be discarded.\n * @returns {Record[]}\n */\n export const serialize = (value, {json, lossy} = {}) => {\n  const _ = [];\n  return serializer(!(json || lossy), !!json, new Map, _)(value), _;\n};\n","import {deserialize} from './deserialize.js';\nimport {serialize} from './serialize.js';\n\n/**\n * @typedef {Array<string,any>} Record a type representation\n */\n\n/**\n * Returns an array of serialized Records.\n * @param {any} any a serializable value.\n * @param {{transfer?: any[], json?: boolean, lossy?: boolean}?} options an object with\n * a transfer option (ignored when polyfilled) and/or non standard fields that\n * fallback to the polyfill if present.\n * @returns {Record[]}\n */\nexport default typeof structuredClone === \"function\" ?\n  /* c8 ignore start */\n  (any, options) => (\n    options && ('json' in options || 'lossy' in options) ?\n      deserialize(serialize(any, options)) : structuredClone(any)\n  ) :\n  (any, options) => deserialize(serialize(any, options));\n  /* c8 ignore stop */\n\nexport {deserialize, serialize};\n","export const eqSet: <T>(xs: Set<T>, ys: Set<T>) => boolean = (\n\txs,\n\tys,\n): boolean => xs.size === ys.size && [...xs].every((x) => ys.has(x));\n","export const isCJK = (char: string) => {\n\treturn /^[\\p{Unified_Ideograph}\\u0800-\\u9FFC]+$/u.test(char);\n};\n","export function derivative(f: (x: number) => number) {\n\tconst h = 0.001;\n\treturn (x: number) => (f(x + h) - f(x - h)) / (2 * h);\n}\n\nexport function getVelocity(f: (t: number) => number): (t: number) => number {\n\treturn derivative(f);\n}\n","import { getVelocity } from \"./derivative.ts\";\n\n/** MIT License github.com/pushkine/ */\nexport interface SpringParams {\n\tmass: number; // = 1.0\n\tdamping: number; // = 10.0\n\tstiffness: number; // = 100.0\n\tsoft: boolean; // = false\n}\n\ntype seconds = number;\n\nexport class Spring {\n\tprivate currentPosition = 0;\n\tprivate targetPosition = 0;\n\tprivate currentTime = 0;\n\tprivate params: Partial<SpringParams> = {};\n\tprivate currentSolver: (t: seconds) => number;\n\tprivate getV: (t: seconds) => number;\n\tprivate getV2: (t: seconds) => number;\n\tprivate queueParams:\n\t\t| (Partial<SpringParams> & {\n\t\t\t\ttime: number;\n\t\t  })\n\t\t| undefined;\n\tprivate queuePosition:\n\t\t| {\n\t\t\t\ttime: number;\n\t\t\t\tposition: number;\n\t\t  }\n\t\t| undefined;\n\tconstructor(currentPosition = 0) {\n\t\tthis.targetPosition = currentPosition;\n\t\tthis.currentPosition = this.targetPosition;\n\t\tthis.currentSolver = () => this.targetPosition;\n\t\tthis.getV = () => 0;\n\t\tthis.getV2 = () => 0;\n\t}\n\tprivate resetSolver() {\n\t\tconst curV = this.getV(this.currentTime);\n\t\tthis.currentTime = 0;\n\t\tthis.currentSolver = solveSpring(\n\t\t\tthis.currentPosition,\n\t\t\tcurV,\n\t\t\tthis.targetPosition,\n\t\t\t0,\n\t\t\tthis.params,\n\t\t);\n\t\tthis.getV = getVelocity(this.currentSolver);\n\t\tthis.getV2 = getVelocity(this.getV);\n\t}\n\tarrived() {\n\t\treturn (\n\t\t\tMath.abs(this.targetPosition - this.currentPosition) < 0.01 &&\n\t\t\tthis.getV(this.currentTime) < 0.01 &&\n\t\t\tthis.getV2(this.currentTime) < 0.01 &&\n\t\t\tthis.queueParams === undefined &&\n\t\t\tthis.queuePosition === undefined\n\t\t);\n\t}\n\tsetPosition(targetPosition: number) {\n\t\tthis.targetPosition = targetPosition;\n\t\tthis.currentPosition = targetPosition;\n\t\tthis.currentSolver = () => this.targetPosition;\n\t\tthis.getV = () => 0;\n\t\tthis.getV2 = () => 0;\n\t}\n\tupdate(delta = 0) {\n\t\tthis.currentTime += delta;\n\t\tthis.currentPosition = this.currentSolver(this.currentTime);\n\t\tif (this.queueParams) {\n\t\t\tthis.queueParams.time -= delta;\n\t\t\tif (this.queueParams.time <= 0) {\n\t\t\t\tthis.updateParams({\n\t\t\t\t\t...this.queueParams,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (this.queuePosition) {\n\t\t\tthis.queuePosition.time -= delta;\n\t\t\tif (this.queuePosition.time <= 0) {\n\t\t\t\tthis.setTargetPosition(this.queuePosition.position);\n\t\t\t}\n\t\t}\n\t\tif (this.arrived()) {\n\t\t\tthis.setPosition(this.targetPosition);\n\t\t}\n\t}\n\tupdateParams(params: Partial<SpringParams>, delay = 0) {\n\t\tif (delay > 0) {\n\t\t\tthis.queueParams = {\n\t\t\t\t...(this.queuePosition ?? {}),\n\t\t\t\t...params,\n\t\t\t\ttime: delay,\n\t\t\t};\n\t\t} else {\n\t\t\tthis.queuePosition = undefined;\n\t\t\tthis.params = {\n\t\t\t\t...this.params,\n\t\t\t\t...params,\n\t\t\t};\n\t\t\tthis.resetSolver();\n\t\t}\n\t}\n\tsetTargetPosition(targetPosition: number, delay = 0) {\n\t\tif (delay > 0) {\n\t\t\tthis.queuePosition = {\n\t\t\t\t...(this.queuePosition ?? {}),\n\t\t\t\tposition: targetPosition,\n\t\t\t\ttime: delay,\n\t\t\t};\n\t\t} else {\n\t\t\tthis.queuePosition = undefined;\n\t\t\tthis.targetPosition = targetPosition;\n\t\t\tthis.resetSolver();\n\t\t}\n\t}\n\tgetCurrentPosition() {\n\t\treturn this.currentPosition;\n\t}\n}\n\nfunction solveSpring(\n\tfrom: number,\n\tvelocity: number,\n\tto: number,\n\tdelay: seconds = 0,\n\tparams?: Partial<SpringParams>,\n): (t: seconds) => number {\n\tconst soft = params?.soft ?? false;\n\tconst stiffness = params?.stiffness ?? 100;\n\tconst damping = params?.damping ?? 10;\n\tconst mass = params?.mass ?? 1;\n\tconst delta = to - from;\n\tif (soft || 1.0 <= damping / (2.0 * Math.sqrt(stiffness * mass))) {\n\t\tconst angular_frequency = -Math.sqrt(stiffness / mass);\n\t\tconst leftover = -angular_frequency * delta - velocity;\n\t\treturn (t: seconds) => {\n\t\t\tt -= delay;\n\t\t\tif (t < 0) return from;\n\t\t\treturn to - (delta + t * leftover) * Math.E ** (t * angular_frequency);\n\t\t};\n\t}\n\tconst damping_frequency = Math.sqrt(4.0 * mass * stiffness - damping ** 2.0);\n\tconst leftover =\n\t\t(damping * delta - 2.0 * mass * velocity) / damping_frequency;\n\tconst dfm = (0.5 * damping_frequency) / mass;\n\tconst dm = -(0.5 * damping) / mass;\n\treturn (t: seconds) => {\n\t\tt -= delay;\n\t\tif (t < 0) return from;\n\t\treturn (\n\t\t\tto -\n\t\t\t(Math.cos(t * dfm) * delta + Math.sin(t * dfm) * leftover) *\n\t\t\t\tMath.E ** (t * dm)\n\t\t);\n\t};\n}\n","/**\n * @fileoverview\n * @see https://github.com/wilsonpage/fastdom/blob/master/fastdom.js\n */\n\ninterface Task<T> {\n\ttask: () => T;\n\tresolve: (value: T) => void;\n\treject: (reason?: any) => void;\n}\n\nconst measureTasks: Task<any>[] = [];\nconst mutateTasks: Task<any>[] = [];\nlet scheduled = false;\n\nfunction onFlush() {\n\tlet tmp = mutateTasks.shift();\n\twhile (tmp) {\n\t\ttry {\n\t\t\ttmp.resolve(tmp.task());\n\t\t} catch (error) {\n\t\t\ttmp.reject(error);\n\t\t}\n\t\ttmp = mutateTasks.shift();\n\t}\n\ttmp = measureTasks.shift();\n\twhile (tmp) {\n\t\ttry {\n\t\t\ttmp.resolve(tmp.task());\n\t\t} catch (error) {\n\t\t\ttmp.reject(error);\n\t\t}\n\t\ttmp = measureTasks.shift();\n\t}\n\tscheduled = false;\n}\n\nfunction scheduleFlush() {\n\tif (!scheduled) {\n\t\tscheduled = true;\n\t\trequestAnimationFrame(onFlush);\n\t}\n}\n\nexport function measure<T>(callback: () => T): Promise<T> {\n\tconst task: Task<T> = {\n\t\ttask: callback,\n\t\tresolve: () => {},\n\t\treject: () => {},\n\t};\n\tconst promise = new Promise<T>((resolve, reject) => {\n\t\ttask.resolve = resolve;\n\t\ttask.reject = reject;\n\t});\n\tmeasureTasks.push(task);\n\tscheduleFlush();\n\treturn promise;\n}\n\nexport function mutate(callback: () => void) {\n\tconst task: Task<void> = {\n\t\ttask: callback,\n\t\tresolve: () => {},\n\t\treject: () => {},\n\t};\n\tconst promise = new Promise((resolve, reject) => {\n\t\ttask.resolve = resolve;\n\t\ttask.reject = reject;\n\t});\n\tmutateTasks.push(task);\n\tscheduleFlush();\n\treturn promise;\n}\n","import type { Disposable, HasElement } from \"../interfaces.ts\";\nimport styles from \"../styles/lyric-player.module.css\";\nimport { measure } from \"../utils/schedule.ts\";\nimport { Spring } from \"../utils/spring.ts\";\nimport type { LyricPlayerBase } from \"./base.ts\";\n\nexport class BottomLineEl implements HasElement, Disposable {\n\tprivate element: HTMLElement = document.createElement(\"div\");\n\tprivate left = 0;\n\tprivate top = 0;\n\tprivate delay = 0;\n\t// 由 LyricPlayer 来设置\n\tlineSize: [number, number] = [0, 0];\n\treadonly lineTransforms = {\n\t\tposX: new Spring(0),\n\t\tposY: new Spring(0),\n\t};\n\tconstructor(private lyricPlayer: LyricPlayerBase) {\n\t\tthis.element.setAttribute(\"class\", styles.lyricLine);\n\t\tthis.rebuildStyle();\n\t}\n\tasync measureSize(): Promise<[number, number]> {\n\t\tconst size: [number, number] = await measure(() => [\n\t\t\tthis.element.clientWidth,\n\t\t\tthis.element.clientHeight,\n\t\t]);\n\t\treturn size;\n\t}\n\tprivate lastStyle = \"\";\n\tshow() {\n\t\tthis.rebuildStyle();\n\t}\n\thide() {\n\t\tthis.rebuildStyle();\n\t}\n\tprivate rebuildStyle() {\n\t\tlet style = `transform:translate(${this.lineTransforms.posX\n\t\t\t.getCurrentPosition()\n\t\t\t.toFixed(2)}px,${this.lineTransforms.posY\n\t\t\t.getCurrentPosition()\n\t\t\t.toFixed(2)}px);`;\n\t\tif (!this.lyricPlayer.getEnableSpring() && this.isInSight) {\n\t\t\tstyle += `transition-delay:${this.delay}ms;`;\n\t\t}\n\t\tif (style !== this.lastStyle) {\n\t\t\tthis.lastStyle = style;\n\t\t\tthis.element.setAttribute(\"style\", style);\n\t\t}\n\t}\n\tgetElement() {\n\t\treturn this.element;\n\t}\n\tsetTransform(\n\t\tleft: number = this.left,\n\t\ttop: number = this.top,\n\t\tforce = false,\n\t\tdelay = 0,\n\t) {\n\t\tthis.left = left;\n\t\tthis.top = top;\n\t\tthis.delay = (delay * 1000) | 0;\n\t\tif (force || !this.lyricPlayer.getEnableSpring()) {\n\t\t\tif (force) this.element.classList.add(styles.tmpDisableTransition);\n\t\t\tthis.lineTransforms.posX.setPosition(left);\n\t\t\tthis.lineTransforms.posY.setPosition(top);\n\t\t\tif (!this.lyricPlayer.getEnableSpring()) this.show();\n\t\t\telse this.rebuildStyle();\n\t\t\tif (force)\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tthis.element.classList.remove(styles.tmpDisableTransition);\n\t\t\t\t});\n\t\t} else {\n\t\t\tthis.lineTransforms.posX.setTargetPosition(left, delay);\n\t\t\tthis.lineTransforms.posY.setTargetPosition(top, delay);\n\t\t}\n\t}\n\tupdate(delta = 0) {\n\t\tif (!this.lyricPlayer.getEnableSpring()) return;\n\t\tthis.lineTransforms.posX.update(delta);\n\t\tthis.lineTransforms.posY.update(delta);\n\t\tif (this.isInSight) {\n\t\t\tthis.show();\n\t\t} else {\n\t\t\tthis.hide();\n\t\t}\n\t}\n\tget isInSight() {\n\t\tconst l = this.lineTransforms.posX.getCurrentPosition();\n\t\tconst t = this.lineTransforms.posY.getCurrentPosition();\n\t\tconst r = l + this.lineSize[0];\n\t\tconst b = t + this.lineSize[1];\n\t\tconst pr = this.lyricPlayer.size[0];\n\t\tconst pb = this.lyricPlayer.size[1];\n\t\treturn !(l > pr || t > pb || r < 0 || b < 0);\n\t}\n\tdispose(): void {\n\t\tthis.element.remove();\n\t}\n}\n","import type { Disposable, HasElement } from \"../../interfaces.ts\";\nimport styles from \"../../styles/lyric-player.module.css\";\n\nfunction easeInOutBack(x: number): number {\n\tconst c1 = 1.70158;\n\tconst c2 = c1 * 1.525;\n\n\treturn x < 0.5\n\t\t? ((2 * x) ** 2 * ((c2 + 1) * 2 * x - c2)) / 2\n\t\t: ((2 * x - 2) ** 2 * ((c2 + 1) * (x * 2 - 2) + c2) + 2) / 2;\n}\n\nfunction easeOutExpo(x: number): number {\n\treturn x === 1 ? 1 : 1 - 2 ** (-10 * x);\n}\n\nconst clamp = (min: number, cur: number, max: number) =>\n\tMath.max(min, Math.min(cur, max));\n\nexport class InterludeDots implements HasElement, Disposable {\n\tprivate element: HTMLElement = document.createElement(\"div\");\n\tprivate dot0: HTMLElement = document.createElement(\"span\");\n\tprivate dot1: HTMLElement = document.createElement(\"span\");\n\tprivate dot2: HTMLElement = document.createElement(\"span\");\n\tprivate left = 0;\n\tprivate top = 0;\n\tprivate playing = true;\n\tprivate lastStyle = \"\";\n\tprivate currentInterlude?: [number, number];\n\tprivate currentTime = 0;\n\tprivate targetBreatheDuration = 1500;\n\tconstructor() {\n\t\tthis.element.className = styles.interludeDots;\n\t\tthis.element.appendChild(this.dot0);\n\t\tthis.element.appendChild(this.dot1);\n\t\tthis.element.appendChild(this.dot2);\n\t}\n\tgetElement() {\n\t\treturn this.element;\n\t}\n\tsetTransform(left: number = this.left, top: number = this.top) {\n\t\tthis.left = left;\n\t\tthis.top = top;\n\t\tthis.update();\n\t}\n\tsetInterlude(interlude?: [number, number]) {\n\t\tthis.currentInterlude = interlude;\n\t\tthis.currentTime = interlude?.[0] ?? 0;\n\t\tif (interlude) {\n\t\t\tthis.element.classList.add(styles.enabled);\n\t\t} else {\n\t\t\tthis.element.classList.remove(styles.enabled);\n\t\t}\n\t}\n\tpause() {\n\t\tthis.playing = false;\n\t\tthis.element.classList.remove(styles.playing);\n\t}\n\tresume() {\n\t\tthis.playing = true;\n\t\tthis.element.classList.add(styles.playing);\n\t}\n\tupdate(delta = 0) {\n\t\tif (!this.playing) return;\n\t\tthis.currentTime += delta;\n\t\tlet curStyle = \"\";\n\n\t\tcurStyle += `transform:translate(${this.left.toFixed(\n\t\t\t2,\n\t\t)}px, ${this.top.toFixed(2)}px)`;\n\n\t\t// 计算缩放大小\n\n\t\tif (this.currentInterlude) {\n\t\t\tconst interludeDuration =\n\t\t\t\tthis.currentInterlude[1] - this.currentInterlude[0];\n\t\t\tconst currentDuration = this.currentTime - this.currentInterlude[0];\n\t\t\tif (currentDuration <= interludeDuration) {\n\t\t\t\tconst breatheDuration =\n\t\t\t\t\tinterludeDuration /\n\t\t\t\t\tMath.ceil(interludeDuration / this.targetBreatheDuration);\n\t\t\t\tlet scale = 1;\n\t\t\t\tlet globalOpacity = 1;\n\n\t\t\t\tscale *=\n\t\t\t\t\tMath.sin(1.5 * Math.PI - (currentDuration / breatheDuration) * 2) /\n\t\t\t\t\t\t20 +\n\t\t\t\t\t1;\n\n\t\t\t\tif (currentDuration < 2000) {\n\t\t\t\t\tscale *= easeOutExpo(currentDuration / 2000);\n\t\t\t\t}\n\n\t\t\t\tif (currentDuration < 500) {\n\t\t\t\t\tglobalOpacity = 0;\n\t\t\t\t} else if (currentDuration < 1000) {\n\t\t\t\t\tglobalOpacity *= (currentDuration - 500) / 500;\n\t\t\t\t}\n\n\t\t\t\tif (interludeDuration - currentDuration < 750) {\n\t\t\t\t\tscale *=\n\t\t\t\t\t\t1 -\n\t\t\t\t\t\teaseInOutBack(\n\t\t\t\t\t\t\t(750 - (interludeDuration - currentDuration)) / 750 / 2,\n\t\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (interludeDuration - currentDuration < 375) {\n\t\t\t\t\tglobalOpacity *= clamp(\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t(interludeDuration - currentDuration) / 375,\n\t\t\t\t\t\t1,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tconst dotsDuration = Math.max(0, interludeDuration - 750);\n\n\t\t\t\tscale = Math.max(0, scale) * 0.7;\n\n\t\t\t\tcurStyle += ` scale(${scale})`;\n\n\t\t\t\tconst dot0Opacity = clamp(\n\t\t\t\t\t0.25,\n\t\t\t\t\t((currentDuration * 3) / dotsDuration) * 0.75,\n\t\t\t\t\t1,\n\t\t\t\t);\n\t\t\t\tconst dot1Opacity = clamp(\n\t\t\t\t\t0.25,\n\t\t\t\t\t(((currentDuration - dotsDuration / 3) * 3) / dotsDuration) * 0.75,\n\t\t\t\t\t1,\n\t\t\t\t);\n\t\t\t\tconst dot2Opacity = clamp(\n\t\t\t\t\t0.25,\n\t\t\t\t\t(((currentDuration - (dotsDuration / 3) * 2) * 3) / dotsDuration) *\n\t\t\t\t\t\t0.75,\n\t\t\t\t\t1,\n\t\t\t\t);\n\n\t\t\t\tthis.dot0.style.opacity = `${clamp(\n\t\t\t\t\t0,\n\t\t\t\t\tMath.max(0, globalOpacity * dot0Opacity),\n\t\t\t\t\t1,\n\t\t\t\t)}`;\n\t\t\t\tthis.dot1.style.opacity = `${clamp(\n\t\t\t\t\t0,\n\t\t\t\t\tMath.max(0, globalOpacity * dot1Opacity),\n\t\t\t\t\t1,\n\t\t\t\t)}`;\n\t\t\t\tthis.dot2.style.opacity = `${clamp(\n\t\t\t\t\t0,\n\t\t\t\t\tMath.max(0, globalOpacity * dot2Opacity),\n\t\t\t\t\t1,\n\t\t\t\t)}`;\n\t\t\t} else {\n\t\t\t\tcurStyle += \" scale(0)\";\n\t\t\t\tthis.dot0.style.opacity = \"0\";\n\t\t\t\tthis.dot1.style.opacity = \"0\";\n\t\t\t\tthis.dot2.style.opacity = \"0\";\n\t\t\t}\n\n\t\t\tcurStyle += \";\";\n\n\t\t\tif (this.lastStyle !== curStyle) {\n\t\t\t\tthis.element.setAttribute(\"style\", curStyle);\n\t\t\t\tthis.lastStyle = curStyle;\n\t\t\t}\n\t\t}\n\t}\n\tdispose() {\n\t\tthis.element.remove();\n\t}\n}\n","import structuredClone from \"@ungap/structured-clone\";\nimport type {\n\tDisposable,\n\tHasElement,\n\tLyricLine,\n\tLyricWord,\n} from \"../interfaces.ts\";\nimport styles from \"../styles/lyric-player.module.css\";\nimport { eqSet } from \"../utils/eq-set.ts\";\nimport { isCJK } from \"../utils/is-cjk.ts\";\nimport { Spring, type SpringParams } from \"../utils/spring.ts\";\nimport { BottomLineEl } from \"./bottom-line.ts\";\nimport { InterludeDots } from \"./dom/interlude-dots.ts\";\n\n/**\n * 歌词播放器的基类，已经包含了有关歌词操作和排版的功能，子类需要为其实现对应的显示展示操作\n */\nexport abstract class LyricPlayerBase\n\textends EventTarget\n\timplements HasElement, Disposable\n{\n\tprotected element: HTMLElement = document.createElement(\"div\");\n\n\tprotected currentTime = 0;\n\t/** @internal */\n\tlyricLinesSize: WeakMap<LyricLineBase, [number, number]> = new WeakMap();\n\t/** @internal */\n\tlyricLineElementMap: WeakMap<Element, LyricLineBase> = new WeakMap();\n\tprotected currentLyricLines: LyricLine[] = [];\n\t// protected currentLyricLineObjects: LyricLineBase[] = [];\n\tprotected processedLines: LyricLine[] = [];\n\tprotected lyricLinesIndexes: WeakMap<LyricLineBase, number> = new WeakMap();\n\tprotected hotLines: Set<number> = new Set();\n\tprotected bufferedLines: Set<number> = new Set();\n\tprotected isNonDynamic = false;\n\tprotected hasDuetLine = false;\n\tprotected scrollToIndex = 0;\n\tprotected disableSpring = false;\n\tprotected interludeDotsSize: [number, number] = [0, 0];\n\tprotected interludeDots: InterludeDots = new InterludeDots();\n\tprotected bottomLine: BottomLineEl = new BottomLineEl(this);\n\tprotected enableBlur = true;\n\tprotected enableScale = true;\n\tprotected hidePassedLines = false;\n\tprotected scrollBoundary = [0, 0];\n\tprotected currentLyricLineObjects: LyricLineBase[] = [];\n\tprotected isSeeking = false;\n\tprotected lastCurrentTime = 0;\n\tprotected alignAnchor: \"top\" | \"bottom\" | \"center\" = \"center\";\n\tprotected alignPosition = 0.35;\n\tprotected scrollOffset = 0;\n\treadonly size: [number, number] = [0, 0];\n\tprotected allowScroll = true;\n\tprotected isPageVisible = true;\n\n\tprotected initialLayoutFinished = false;\n\n\t/**\n\t * 视图额外预渲染（overscan）距离，单位：像素。\n\t * 用于决定在视口之外多少距离内也认为是“可见”，以便提前创建/保留行元素。\n\t */\n\tprotected overscanPx = 300;\n\n\tprotected posXSpringParams: Partial<SpringParams> = {\n\t\tmass: 1,\n\t\tdamping: 10,\n\t\tstiffness: 100,\n\t};\n\tprotected posYSpringParams: Partial<SpringParams> = {\n\t\tmass: 0.9,\n\t\tdamping: 15,\n\t\tstiffness: 90,\n\t};\n\tprotected scaleSpringParams: Partial<SpringParams> = {\n\t\tmass: 2,\n\t\tdamping: 25,\n\t\tstiffness: 100,\n\t};\n\tprotected scaleForBGSpringParams: Partial<SpringParams> = {\n\t\tmass: 1,\n\t\tdamping: 20,\n\t\tstiffness: 50,\n\t};\n\tprivate onPageShow = () => {\n\t\tthis.isPageVisible = true;\n\t\tthis.setCurrentTime(this.currentTime, true);\n\t};\n\tprivate onPageHide = () => {\n\t\tthis.isPageVisible = false;\n\t};\n\tprivate scrolledHandler = 0;\n\tprotected isScrolled = false;\n\t/** @internal */\n\tresizeObserver: ResizeObserver = new ResizeObserver(((entries) => {\n\t\tlet shouldRelayout = false;\n\t\tlet shouldRebuildPlayerStyle = false;\n\t\tfor (const entry of entries) {\n\t\t\tif (entry.target === this.element) {\n\t\t\t\tconst rect = entry.contentRect;\n\t\t\t\tthis.size[0] = rect.width;\n\t\t\t\tthis.size[1] = rect.height;\n\t\t\t\tshouldRebuildPlayerStyle = true;\n\t\t\t} else if (entry.target === this.interludeDots.getElement()) {\n\t\t\t\tthis.interludeDotsSize[0] = entry.target.clientWidth;\n\t\t\t\tthis.interludeDotsSize[1] = entry.target.clientHeight;\n\t\t\t\tshouldRelayout = true;\n\t\t\t} else if (entry.target === this.bottomLine.getElement()) {\n\t\t\t\tconst newSize: [number, number] = [\n\t\t\t\t\tentry.target.clientWidth,\n\t\t\t\t\tentry.target.clientHeight,\n\t\t\t\t];\n\t\t\t\tconst oldSize: [number, number] = this.bottomLine.lineSize;\n\n\t\t\t\tif (newSize[0] !== oldSize[0] || newSize[1] !== oldSize[1]) {\n\t\t\t\t\tthis.bottomLine.lineSize = newSize;\n\t\t\t\t\tshouldRelayout = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst lineObj = this.lyricLineElementMap.get(entry.target);\n\t\t\t\tif (lineObj) {\n\t\t\t\t\tconst newSize: [number, number] = [\n\t\t\t\t\t\tentry.target.clientWidth,\n\t\t\t\t\t\tentry.target.clientHeight,\n\t\t\t\t\t];\n\t\t\t\t\tconst oldSize: [number, number] = this.lyricLinesSize.get(\n\t\t\t\t\t\tlineObj,\n\t\t\t\t\t) ?? [0, 0];\n\n\t\t\t\t\tif (newSize[0] !== oldSize[0] || newSize[1] !== oldSize[1]) {\n\t\t\t\t\t\tthis.lyricLinesSize.set(lineObj, newSize);\n\t\t\t\t\t\tlineObj.onLineSizeChange(newSize);\n\t\t\t\t\t\tshouldRelayout = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (shouldRelayout) {\n\t\t\tthis.calcLayout(true);\n\t\t}\n\t\tif (shouldRebuildPlayerStyle) {\n\t\t\tthis.onResize();\n\t\t}\n\t}) as ResizeObserverCallback);\n\tprotected wordFadeWidth = 0.5;\n\tprotected targetAlignIndex = 0;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.resizeObserver.observe(this.element);\n\t\tthis.resizeObserver.observe(this.interludeDots.getElement());\n\t\tthis.element.classList.add(styles.lyricPlayer);\n\n\t\tthis.element.appendChild(this.interludeDots.getElement());\n\t\tthis.element.appendChild(this.bottomLine.getElement());\n\t\tthis.interludeDots.setTransform(0, 200);\n\t\twindow.addEventListener(\"pageshow\", this.onPageShow);\n\t\twindow.addEventListener(\"pagehide\", this.onPageHide);\n\t\tlet startScrollY = 0;\n\t\tlet direction: \"up\" | \"down\" | \"none\" = \"none\";\n\t\tlet startTouchPosY = 0;\n\t\tlet startScrollTime = 0;\n\t\tlet scrollSpeed = 0;\n\t\tlet scrollId = Symbol(\"amll-scroll\");\n\t\tlet lastMoveY = 0;\n\t\tlet lastDragTime = 0;\n\t\tthis.element.addEventListener(\"touchstart\", (evt) => {\n\t\t\tif (this.beginScrollHandler()) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tstartScrollY = this.scrollOffset;\n\t\t\t\tstartTouchPosY = evt.touches[0].screenY;\n\t\t\t\tlastMoveY = startTouchPosY;\n\t\t\t\tstartScrollTime = Date.now();\n\t\t\t\tscrollSpeed = 0;\n\t\t\t}\n\t\t});\n\t\tthis.element.addEventListener(\"touchmove\", (evt) => {\n\t\t\tif (this.beginScrollHandler()) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tconst touchScreenY = evt.touches[0].screenY;\n\t\t\t\tconst delta = touchScreenY - startTouchPosY;\n\t\t\t\tconst lastDelta = touchScreenY - lastMoveY;\n\t\t\t\tconst targetDirection =\n\t\t\t\t\tlastDelta > 0 ? \"down\" : lastDelta < 0 ? \"up\" : \"none\";\n\t\t\t\tif (direction !== targetDirection) {\n\t\t\t\t\tdirection = targetDirection;\n\t\t\t\t\tstartScrollY = this.scrollOffset;\n\t\t\t\t\tstartTouchPosY = touchScreenY;\n\t\t\t\t\tstartScrollTime = Date.now();\n\t\t\t\t} else {\n\t\t\t\t\tthis.scrollOffset = startScrollY - delta;\n\t\t\t\t}\n\t\t\t\tlastMoveY = touchScreenY;\n\t\t\t\tlastDragTime = Date.now();\n\t\t\t\tthis.limitScrollOffset();\n\t\t\t\tthis.calcLayout(true);\n\t\t\t}\n\t\t});\n\t\tthis.element.addEventListener(\"touchend\", (evt) => {\n\t\t\tif (this.beginScrollHandler()) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tstartTouchPosY = 0;\n\t\t\t\tconst curTime = Date.now();\n\t\t\t\tif (curTime - lastDragTime > 100) return this.endScrollHandler();\n\t\t\t\tconst scrollDuration = curTime - startScrollTime;\n\t\t\t\tscrollSpeed =\n\t\t\t\t\t((this.scrollOffset - startScrollY) / scrollDuration) * 1000;\n\t\t\t\tlet lt = 0;\n\t\t\t\tconst curScrollId = Symbol(\"amll-scroll\");\n\t\t\t\tscrollId = curScrollId;\n\t\t\t\tconst onScrollFrame = (dt: number) => {\n\t\t\t\t\tlt ||= dt;\n\t\t\t\t\tif (scrollId === curScrollId && this.beginScrollHandler()) {\n\t\t\t\t\t\tthis.scrollOffset += (scrollSpeed * (dt - lt)) / 1000;\n\t\t\t\t\t\tscrollSpeed *= 0.99;\n\t\t\t\t\t\tthis.limitScrollOffset();\n\t\t\t\t\t\tthis.calcLayout(true);\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tMath.abs(scrollSpeed) > 1 &&\n\t\t\t\t\t\t\t!this.scrollBoundary.includes(this.scrollOffset)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\trequestAnimationFrame(onScrollFrame);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.endScrollHandler();\n\t\t\t\t\t\tlt = dt;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\trequestAnimationFrame(onScrollFrame);\n\t\t\t\tthis.endScrollHandler();\n\t\t\t}\n\t\t});\n\t\tthis.element.addEventListener(\"wheel\", (evt) => {\n\t\t\tif (this.beginScrollHandler()) {\n\t\t\t\tif (evt.deltaMode === evt.DOM_DELTA_PIXEL) {\n\t\t\t\t\tthis.scrollOffset += evt.deltaY;\n\t\t\t\t\tthis.limitScrollOffset();\n\t\t\t\t\tthis.calcLayout(true);\n\t\t\t\t} else {\n\t\t\t\t\tthis.scrollOffset += evt.deltaY * 50;\n\t\t\t\t\tthis.limitScrollOffset();\n\t\t\t\t\tthis.calcLayout(false);\n\t\t\t\t}\n\t\t\t\tthis.endScrollHandler();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate beginScrollHandler() {\n\t\tconst allowed = this.allowScroll;\n\t\tif (allowed) {\n\t\t\tthis.isScrolled = true;\n\t\t\tclearTimeout(this.scrolledHandler);\n\t\t\tthis.scrolledHandler = setTimeout(() => {\n\t\t\t\tthis.isScrolled = false;\n\t\t\t\tthis.scrollOffset = 0;\n\t\t\t}, 5000);\n\t\t}\n\t\treturn allowed;\n\t}\n\tprivate endScrollHandler() {}\n\tprivate limitScrollOffset() {\n\t\tthis.scrollOffset = Math.max(\n\t\t\tMath.min(this.scrollBoundary[1], this.scrollOffset),\n\t\t\tthis.scrollBoundary[0],\n\t\t);\n\t}\n\n\t/**\n\t * 设置文字动画的渐变宽度，单位以歌词行的主文字字体大小的倍数为单位，默认为 0.5，即一个全角字符的一半宽度\n\t *\n\t * 如果要模拟 Apple Music for Android 的效果，可以设置为 1\n\t *\n\t * 如果要模拟 Apple Music for iPad 的效果，可以设置为 0.5\n\t *\n\t * 如果想要近乎禁用渐变效果，可以设置成非常接近 0 的小数（例如 `0.0001` ），但是**不可以为 0**\n\t *\n\t * @param value 需要设置的渐变宽度，单位以歌词行的主文字字体大小的倍数为单位，默认为 0.5\n\t */\n\tsetWordFadeWidth(value = 0.5) {\n\t\tthis.wordFadeWidth = Math.max(0.0001, value);\n\t}\n\n\t/**\n\t * 是否启用歌词行缩放效果，默认启用\n\t *\n\t * 如果启用，非选中的歌词行会轻微缩小以凸显当前播放歌词行效果\n\t *\n\t * 此效果对性能影响微乎其微，推荐启用\n\t * @param enable 是否启用歌词行缩放效果\n\t */\n\tsetEnableScale(enable = true) {\n\t\tthis.enableScale = enable;\n\t\tthis.calcLayout();\n\t}\n\t/**\n\t * 获取当前是否启用了歌词行缩放效果\n\t * @returns 是否启用歌词行缩放效果\n\t */\n\tgetEnableScale() {\n\t\treturn this.enableScale;\n\t}\n\n\t/**\n\t * 获取当前文字动画的渐变宽度，单位以歌词行的主文字字体大小的倍数为单位\n\t * @returns 当前文字动画的渐变宽度，单位以歌词行的主文字字体大小的倍数为单位\n\t */\n\tgetWordFadeWidth() {\n\t\treturn this.wordFadeWidth;\n\t}\n\n\tsetIsSeeking(isSeeking: boolean) {\n\t\tthis.isSeeking = isSeeking;\n\t}\n\t/**\n\t * 设置是否隐藏已经播放过的歌词行，默认不隐藏\n\t * @param hide 是否隐藏已经播放过的歌词行，默认不隐藏\n\t */\n\tsetHidePassedLines(hide: boolean) {\n\t\tthis.hidePassedLines = hide;\n\t\tthis.calcLayout();\n\t}\n\t/**\n\t * 设置是否启用歌词行的模糊效果\n\t * @param enable 是否启用\n\t */\n\tsetEnableBlur(enable: boolean) {\n\t\tif (this.enableBlur === enable) return;\n\t\tthis.enableBlur = enable;\n\t\tthis.calcLayout();\n\t}\n\t/**\n\t * 设置目标歌词行的对齐方式，默认为 `center`\n\t *\n\t * - 设置成 `top` 的话将会向目标歌词行的顶部对齐\n\t * - 设置成 `bottom` 的话将会向目标歌词行的底部对齐\n\t * - 设置成 `center` 的话将会向目标歌词行的垂直中心对齐\n\t * @param alignAnchor 歌词行对齐方式，详情见函数说明\n\t */\n\tsetAlignAnchor(alignAnchor: \"top\" | \"bottom\" | \"center\") {\n\t\tthis.alignAnchor = alignAnchor;\n\t}\n\t/**\n\t * 设置默认的歌词行对齐位置，相对于整个歌词播放组件的大小位置，默认为 `0.5`\n\t * @param alignPosition 一个 `[0.0-1.0]` 之间的任意数字，代表组件高度由上到下的比例位置\n\t */\n\tsetAlignPosition(alignPosition: number) {\n\t\tthis.alignPosition = alignPosition;\n\t}\n\n\t/**\n\t * 设置 overscan（视图上下额外缓冲渲染区）距离，单位：像素。\n\t * @param px 像素值，默认 300\n\t */\n\tsetOverscanPx(px: number) {\n\t\tthis.overscanPx = Math.max(0, px | 0);\n\t}\n\t/** 获取当前 overscan 像素距离 */\n\tgetOverscanPx() {\n\t\treturn this.overscanPx;\n\t}\n\t/**\n\t * 设置是否使用物理弹簧算法实现歌词动画效果，默认启用\n\t *\n\t * 如果启用，则会通过弹簧算法实时处理歌词位置，但是需要性能足够强劲的电脑方可流畅运行\n\t *\n\t * 如果不启用，则会回退到基于 `transition` 的过渡效果，对低性能的机器比较友好，但是效果会比较单一\n\t */\n\tsetEnableSpring(enable = true) {\n\t\tthis.disableSpring = !enable;\n\t\tif (enable) {\n\t\t\tthis.element.classList.remove(styles.disableSpring);\n\t\t} else {\n\t\t\tthis.element.classList.add(styles.disableSpring);\n\t\t}\n\t\tthis.calcLayout(true);\n\t}\n\t/**\n\t * 获取当前是否启用了物理弹簧\n\t * @returns 是否启用物理弹簧\n\t */\n\tgetEnableSpring() {\n\t\treturn !this.disableSpring;\n\t}\n\n\t/**\n\t * 获取当前播放时间里是否处于间奏区间\n\t * 如果是则会返回单位为毫秒的始末时间\n\t * 否则返回 undefined\n\t *\n\t * 这个只允许内部调用\n\t * @returns [开始时间,结束时间,大概处于的歌词行ID,下一句是否为对唱歌词] 或 undefined 如果不处于间奏区间\n\t */\n\tprotected getCurrentInterlude():\n\t\t| [number, number, number, boolean]\n\t\t| undefined {\n\t\tif (this.bufferedLines.size > 0) return undefined;\n\t\tconst currentTime = this.currentTime + 20;\n\t\tconst i = this.scrollToIndex;\n\t\tif (i === 0) {\n\t\t\tif (this.processedLines[0]?.startTime) {\n\t\t\t\tif (this.processedLines[0].startTime > currentTime) {\n\t\t\t\t\treturn [\n\t\t\t\t\t\tcurrentTime,\n\t\t\t\t\t\tMath.max(currentTime, this.processedLines[0].startTime - 250),\n\t\t\t\t\t\t-2,\n\t\t\t\t\t\tthis.processedLines[0].isDuet,\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tthis.processedLines[1].startTime > currentTime &&\n\t\t\t\t\tthis.processedLines[0].endTime < currentTime\n\t\t\t\t) {\n\t\t\t\t\treturn [\n\t\t\t\t\t\tMath.max(this.processedLines[0].endTime, currentTime),\n\t\t\t\t\t\tthis.processedLines[1].startTime,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tthis.processedLines[1].isDuet,\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (\n\t\t\tthis.processedLines[i]?.endTime &&\n\t\t\tthis.processedLines[i + 1]?.startTime\n\t\t) {\n\t\t\tif (\n\t\t\t\tthis.processedLines[i + 1].startTime > currentTime &&\n\t\t\t\tthis.processedLines[i].endTime < currentTime\n\t\t\t) {\n\t\t\t\treturn [\n\t\t\t\t\tMath.max(this.processedLines[i].endTime, currentTime),\n\t\t\t\t\tthis.processedLines[i + 1].startTime,\n\t\t\t\t\ti,\n\t\t\t\t\tthis.processedLines[i + 1].isDuet,\n\t\t\t\t];\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis.processedLines[i + 2]?.startTime &&\n\t\t\t\tthis.processedLines[i + 2].startTime > currentTime &&\n\t\t\t\tthis.processedLines[i + 1].endTime < currentTime\n\t\t\t) {\n\t\t\t\treturn [\n\t\t\t\t\tMath.max(this.processedLines[i + 1].endTime, currentTime),\n\t\t\t\t\tthis.processedLines[i + 2].startTime,\n\t\t\t\t\ti + 1,\n\t\t\t\t\tthis.processedLines[i + 2].isDuet,\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\t/**\n\t * 设置当前播放歌词，要注意传入后这个数组内的信息不得修改，否则会发生错误\n\t * @param lines 歌词数组\n\t * @param initialTime 初始时间，默认为 0\n\t */\n\tsetLyricLines(lines: LyricLine[], initialTime = 0) {\n\t\tif (import.meta.env.DEV) {\n\t\t\tconsole.log(\"设置歌词行\", lines, initialTime);\n\t\t}\n\t\tthis.initialLayoutFinished = true;\n\t\tfor (const line of lines) {\n\t\t\tfor (const word of line.words) {\n\t\t\t\tword.word = word.word.replace(/\\s+/g, \" \");\n\t\t\t}\n\t\t}\n\t\tthis.lastCurrentTime = initialTime;\n\t\tthis.currentTime = initialTime;\n\t\tthis.currentLyricLines = structuredClone(lines) as LyricLine[];\n\t\tthis.processedLines = structuredClone(lines) as LyricLine[];\n\n\t\tthis.isNonDynamic = true;\n\t\tfor (const line of this.processedLines) {\n\t\t\tif (line.words.length > 1) {\n\t\t\t\tthis.isNonDynamic = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.hasDuetLine = this.processedLines.some((line) => line.isDuet);\n\t\t\n\t\t// 将行开始时间提早最多一秒\n\t\tfor (let i = this.processedLines.length - 1; i >= 0; i--) {\n\t\t\tconst line = this.processedLines[i];\n\t\t\tif (line.isBG) continue;\n\t\t\tconst prevLine = this.processedLines[i - 1];\n\t\t\tif (prevLine) {\n\t\t\t\t// 增加一个 min 边界是为了如果现有歌词已经和上一行歌词有交错，则不做修改\n\t\t\t\tline.startTime = Math.max(\n\t\t\t\t\tMath.min(prevLine.endTime, line.startTime),\n\t\t\t\t\tline.startTime - 1000,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tline.startTime = Math.max(0, line.startTime - 1000);\n\t\t\t}\n\t\t}\n\n\t\t// 让背景歌词和上一行歌词一同出现并一同消失\n\t\tfor (let i = this.processedLines.length - 1; i >= 0; i--) {\n\t\t\tconst line = this.processedLines[i];\n\t\t\tif (line.isBG) continue;\n\t\t\tconst nextLine = this.processedLines[i + 1];\n\t\t\tif (nextLine?.isBG) {\n\t\t\t\tconst bgStartTime = Math.min(\n\t\t\t\t\t...nextLine.words\n\t\t\t\t\t\t.filter((w) => w.word.trim().length > 0)\n\t\t\t\t\t\t.map((w) => w.startTime),\n\t\t\t\t\tline.startTime,\n\t\t\t\t);\n\t\t\t\tconst bgEndTime = Math.max(\n\t\t\t\t\t...nextLine.words\n\t\t\t\t\t\t.filter((w) => w.word.trim().length > 0)\n\t\t\t\t\t\t.map((w) => w.endTime),\n\t\t\t\t\tline.endTime,\n\t\t\t\t);\n\t\t\t\tconst startTime = Math.min(bgStartTime, line.startTime);\n\t\t\t\tconst endTime = Math.max(bgEndTime, line.endTime);\n\t\t\t\tnextLine.startTime = startTime;\n\t\t\t\tnextLine.endTime = endTime;\n\t\t\t}\n\t\t}\n\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.dispose();\n\t\t}\n\n\t\tthis.interludeDots.setInterlude(undefined);\n\t\tthis.hotLines.clear();\n\t\tthis.bufferedLines.clear();\n\t\tthis.setCurrentTime(0, true);\n\t\tif (import.meta.env.DEV) {\n\t\t\tconsole.log(\"歌词处理完成\", this);\n\t\t}\n\t}\n\n\t/**\n\t * 设置当前播放进度，单位为毫秒且**必须是整数**，此时将会更新内部的歌词进度信息\n\t * 内部会根据调用间隔和播放进度自动决定如何滚动和显示歌词，所以这个的调用频率越快越准确越好\n\t *\n\t * 调用完成后，可以每帧调用 `update` 函数来执行歌词动画效果\n\t * @param time 当前播放进度，单位为毫秒\n\t */\n\tsetCurrentTime(time: number, isSeek = false) {\n\t\t// 我在这里定义了歌词的选择状态：\n\t\t// 普通行：当前不处于时间范围内的歌词行\n\t\t// 热行：当前绝对处于播放时间内的歌词行，且一般会被立刻加入到缓冲行中\n\t\t// 缓冲行：一般处于播放时间后的歌词行，会因为当前播放状态的缘故推迟解除状态\n\n\t\t// 然后我们需要让歌词行为如下：\n\t\t// 如果当前仍有缓冲行的情况下加入新热行，则不会解除当前缓冲行，且也不会修改当前滚动位置\n\t\t// 如果当前所有缓冲行都将被删除且没有新热行加入，则删除所有缓冲行，且也不会修改当前滚动位置\n\t\t// 如果当前所有缓冲行都将被删除且有新热行加入，则删除所有缓冲行并加入新热行作为缓冲行，然后修改当前滚动位置\n\n\t\tthis.currentTime = time;\n\n\t\tif (!this.initialLayoutFinished && !isSeek) return;\n\n\t\tconst removedHotIds = new Set<number>();\n\t\tconst removedIds = new Set<number>();\n\t\tconst addedIds = new Set<number>();\n\n\t\t// 先检索当前已经超出时间范围的缓冲行，列入待删除集内\n\t\tfor (const lastHotId of this.hotLines) {\n\t\t\tconst line = this.processedLines[lastHotId];\n\t\t\tif (line) {\n\t\t\t\tif (line.isBG) continue;\n\t\t\t\tconst nextLine = this.processedLines[lastHotId + 1];\n\t\t\t\tif (nextLine?.isBG) {\n\t\t\t\t\tconst nextMainLine = this.processedLines[lastHotId + 2];\n\t\t\t\t\tconst startTime = Math.min(line.startTime, nextLine?.startTime);\n\t\t\t\t\tconst endTime = Math.min(\n\t\t\t\t\t\tMath.max(line.endTime, nextMainLine?.startTime ?? Number.MAX_VALUE),\n\t\t\t\t\t\tMath.max(line.endTime, nextLine?.endTime),\n\t\t\t\t\t);\n\t\t\t\t\tif (startTime > time || endTime <= time) {\n\t\t\t\t\t\tthis.hotLines.delete(lastHotId);\n\t\t\t\t\t\tremovedHotIds.add(lastHotId);\n\t\t\t\t\t\tthis.hotLines.delete(lastHotId + 1);\n\t\t\t\t\t\tremovedHotIds.add(lastHotId + 1);\n\t\t\t\t\t\tif (isSeek) {\n\t\t\t\t\t\t\tthis.currentLyricLineObjects[lastHotId]?.disable();\n\t\t\t\t\t\t\tthis.currentLyricLineObjects[lastHotId + 1]?.disable();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (line.startTime > time || line.endTime <= time) {\n\t\t\t\t\tthis.hotLines.delete(lastHotId);\n\t\t\t\t\tremovedHotIds.add(lastHotId);\n\t\t\t\t\tif (isSeek) this.currentLyricLineObjects[lastHotId]?.disable();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.hotLines.delete(lastHotId);\n\t\t\t\tremovedHotIds.add(lastHotId);\n\t\t\t\tif (isSeek) this.currentLyricLineObjects[lastHotId]?.disable();\n\t\t\t}\n\t\t}\n\t\tthis.currentLyricLineObjects.forEach((lineObj, id, arr) => {\n\t\t\tconst line = lineObj.getLine();\n\t\t\tif (!line.isBG && line.startTime <= time && line.endTime > time) {\n\t\t\t\tif (!this.hotLines.has(id)) {\n\t\t\t\t\tthis.hotLines.add(id);\n\t\t\t\t\taddedIds.add(id);\n\t\t\t\t\tif (isSeek) lineObj.enable();\n\t\t\t\t\tif (arr[id + 1]?.getLine()?.isBG) {\n\t\t\t\t\t\tthis.hotLines.add(id + 1);\n\t\t\t\t\t\taddedIds.add(id + 1);\n\t\t\t\t\t\tif (isSeek) arr[id + 1].enable();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tfor (const v of this.bufferedLines) {\n\t\t\tif (!this.hotLines.has(v)) {\n\t\t\t\tremovedIds.add(v);\n\t\t\t\tif (isSeek) this.currentLyricLineObjects[v]?.disable();\n\t\t\t}\n\t\t}\n\t\tif (isSeek) {\n\t\t\tif (this.bufferedLines.size > 0) {\n\t\t\t\tthis.scrollToIndex = Math.min(...this.bufferedLines);\n\t\t\t} else {\n\t\t\t\tthis.scrollToIndex = this.processedLines.findIndex(\n\t\t\t\t\t(line) => line.startTime >= time,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.bufferedLines.clear();\n\t\t\tfor (const v of this.hotLines) {\n\t\t\t\tthis.bufferedLines.add(v);\n\t\t\t}\n\t\t\tthis.calcLayout();\n\t\t} else if (removedIds.size > 0 || addedIds.size > 0) {\n\t\t\tif (removedIds.size === 0 && addedIds.size > 0) {\n\t\t\t\tfor (const v of addedIds) {\n\t\t\t\t\tthis.bufferedLines.add(v);\n\t\t\t\t\tthis.currentLyricLineObjects[v]?.enable();\n\t\t\t\t}\n\t\t\t\tthis.scrollToIndex = Math.min(...this.bufferedLines);\n\t\t\t\tthis.calcLayout();\n\t\t\t} else if (addedIds.size === 0 && removedIds.size > 0) {\n\t\t\t\tif (eqSet(removedIds, this.bufferedLines)) {\n\t\t\t\t\tfor (const v of this.bufferedLines) {\n\t\t\t\t\t\tif (!this.hotLines.has(v)) {\n\t\t\t\t\t\t\tthis.bufferedLines.delete(v);\n\t\t\t\t\t\t\tthis.currentLyricLineObjects[v]?.disable();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.calcLayout();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (const v of addedIds) {\n\t\t\t\t\tthis.bufferedLines.add(v);\n\t\t\t\t\tthis.currentLyricLineObjects[v]?.enable();\n\t\t\t\t}\n\t\t\t\tfor (const v of removedIds) {\n\t\t\t\t\tthis.bufferedLines.delete(v);\n\t\t\t\t\tthis.currentLyricLineObjects[v]?.disable();\n\t\t\t\t}\n\t\t\t\tif (this.bufferedLines.size > 0)\n\t\t\t\t\tthis.scrollToIndex = Math.min(...this.bufferedLines);\n\t\t\t\tthis.calcLayout();\n\t\t\t}\n\t\t}\n\t\tthis.lastCurrentTime = time;\n\t}\n\n\t/**\n\t * 重新布局定位歌词行的位置，调用完成后再逐帧调用 `update`\n\t * 函数即可让歌词通过动画移动到目标位置。\n\t *\n\t * 函数有一个 `force` 参数，用于指定是否强制修改布局，也就是不经过动画直接调整元素位置和大小。\n\t *\n\t * 此函数还有一个 `reflow` 参数，用于指定是否需要重新计算布局\n\t *\n\t * 因为计算布局必定会导致浏览器重排布局，所以会大幅度影响流畅度和性能，故请只在以下情况下将其​设置为 true：\n\t *\n\t * 1. 歌词页面大小发生改变时（这个组件会自行处理）\n\t * 2. 加载了新的歌词时（不论前后歌词是否完全一样）\n\t * 3. 用户自行跳转了歌曲播放位置（不论距离远近）\n\t *\n\t * @param force 是否不经过动画直接修改布局定位\n\t * @param reflow 是否进行重新布局（重新计算每行歌词大小）\n\t */\n\tasync calcLayout(sync = false) {\n\t\tconst interlude = this.getCurrentInterlude();\n\t\tlet curPos = -this.scrollOffset;\n\t\tlet targetAlignIndex = this.scrollToIndex;\n\t\tlet interludeDuration = 0;\n\t\tif (interlude) {\n\t\t\tinterludeDuration = interlude[1] - interlude[0];\n\t\t\tif (interludeDuration >= 4000) {\n\t\t\t\tconst nextLine = this.currentLyricLineObjects[interlude[2] + 1];\n\t\t\t\tif (nextLine) {\n\t\t\t\t\ttargetAlignIndex = interlude[2] + 1;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.interludeDots.setInterlude(undefined);\n\t\t}\n\t\t// 避免一开始就让所有歌词行挤在一起\n\t\tconst LINE_HEIGHT_FALLBACK = this.size[1] / 5;\n\t\tconst scrollOffset = this.currentLyricLineObjects\n\t\t\t.slice(0, targetAlignIndex)\n\t\t\t.reduce(\n\t\t\t\t(acc, el) =>\n\t\t\t\t\tacc +\n\t\t\t\t\t(el.getLine().isBG && this.isPlaying\n\t\t\t\t\t\t? 0\n\t\t\t\t\t\t: (this.lyricLinesSize.get(el)?.[1] ?? LINE_HEIGHT_FALLBACK)),\n\t\t\t\t0,\n\t\t\t);\n\t\tthis.scrollBoundary[0] = -scrollOffset;\n\t\tcurPos -= scrollOffset;\n\t\tcurPos += this.size[1] * this.alignPosition;\n\t\tconst curLine = this.currentLyricLineObjects[targetAlignIndex];\n\t\tthis.targetAlignIndex = targetAlignIndex;\n\t\tif (curLine) {\n\t\t\tconst lineHeight =\n\t\t\t\tthis.lyricLinesSize.get(curLine)?.[1] ?? LINE_HEIGHT_FALLBACK;\n\t\t\tswitch (this.alignAnchor) {\n\t\t\t\tcase \"bottom\":\n\t\t\t\t\tcurPos -= lineHeight;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"center\":\n\t\t\t\t\tcurPos -= lineHeight / 2;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"top\":\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst latestIndex = Math.max(...this.bufferedLines);\n\t\tlet delay = 0;\n\t\tlet baseDelay = sync ? 0 : 0.05;\n\t\tlet setDots = false;\n\t\tthis.currentLyricLineObjects.forEach((lineObj, i) => {\n\t\t\tconst hasBuffered = this.bufferedLines.has(i);\n\t\t\tconst isActive =\n\t\t\t\thasBuffered || (i >= this.scrollToIndex && i < latestIndex);\n\t\t\tconst line = lineObj.getLine();\n\t\t\tif (\n\t\t\t\t!setDots &&\n\t\t\t\tinterludeDuration >= 4000 &&\n\t\t\t\t((i === this.scrollToIndex && interlude?.[2] === -2) ||\n\t\t\t\t\ti === this.scrollToIndex + 1)\n\t\t\t) {\n\t\t\t\tsetDots = true;\n\t\t\t\tthis.interludeDots.setTransform(0, curPos);\n\t\t\t\tif (interlude) {\n\t\t\t\t\tthis.interludeDots.setInterlude([interlude[0], interlude[1]]);\n\t\t\t\t}\n\t\t\t\tcurPos += this.interludeDotsSize[1];\n\t\t\t}\n\t\t\tlet targetOpacity: number;\n\n\t\t\tif (this.hidePassedLines) {\n\t\t\t\tif (\n\t\t\t\t\ti < (interlude ? interlude[2] + 1 : this.scrollToIndex) &&\n\t\t\t\t\tthis.isPlaying\n\t\t\t\t) {\n\t\t\t\t\t// 为了避免浏览器优化，这里使用了一个极小但不为零的值（几乎不可见）\n\t\t\t\t\ttargetOpacity = 0.00001;\n\t\t\t\t} else if (hasBuffered) {\n\t\t\t\t\ttargetOpacity = 0.85;\n\t\t\t\t} else {\n\t\t\t\t\ttargetOpacity = this.isNonDynamic ? 0.2 : 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (hasBuffered) {\n\t\t\t\t\ttargetOpacity = 0.85;\n\t\t\t\t} else {\n\t\t\t\t\ttargetOpacity = this.isNonDynamic ? 0.2 : 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet blurLevel = 0;\n\t\t\tif (this.enableBlur) {\n\t\t\t\tif (isActive) {\n\t\t\t\t\tblurLevel = 0;\n\t\t\t\t} else {\n\t\t\t\t\tblurLevel = 1;\n\t\t\t\t\tif (i < this.scrollToIndex) {\n\t\t\t\t\t\tblurLevel += Math.abs(this.scrollToIndex - i) + 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tblurLevel += Math.abs(\n\t\t\t\t\t\t\ti - Math.max(this.scrollToIndex, latestIndex),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst SCALE_ASPECT = this.enableScale ? 97 : 100;\n\n\t\t\tlet targetScale = 100;\n\n\t\t\tif (!isActive && this.isPlaying) {\n\t\t\t\tif (line.isBG) {\n\t\t\t\t\ttargetScale = 75;\n\t\t\t\t} else {\n\t\t\t\t\ttargetScale = SCALE_ASPECT;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlineObj.setTransform(\n\t\t\t\tcurPos,\n\t\t\t\ttargetScale,\n\t\t\t\ttargetOpacity,\n\t\t\t\twindow.innerWidth <= 1024 ? blurLevel * 0.8 : blurLevel,\n\t\t\t\tfalse,\n\t\t\t\tdelay,\n\t\t\t);\n\t\t\tif (line.isBG && (isActive || !this.isPlaying)) {\n\t\t\t\tcurPos += this.lyricLinesSize.get(lineObj)?.[1] ?? LINE_HEIGHT_FALLBACK;\n\t\t\t} else if (!line.isBG) {\n\t\t\t\tcurPos += this.lyricLinesSize.get(lineObj)?.[1] ?? LINE_HEIGHT_FALLBACK;\n\t\t\t}\n\t\t\tif (curPos >= 0 && !this.isSeeking) {\n\t\t\t\tif (!line.isBG) delay += baseDelay;\n\n\t\t\t\tif (i >= this.scrollToIndex) baseDelay /= 1.05;\n\t\t\t}\n\t\t});\n\t\tthis.scrollBoundary[1] = curPos + this.scrollOffset - this.size[1] / 2;\n\t\t// console.groupEnd();\n\t\tthis.bottomLine.setTransform(0, curPos, false, delay);\n\t}\n\n\t/**\n\t * 设置所有歌词行在横坐标上的弹簧属性，包括重量、弹力和阻力。\n\t *\n\t * @param params 需要设置的弹簧属性，提供的属性将会覆盖原来的属性，未提供的属性将会保持原样\n\t * @deprecated 考虑到横向弹簧效果并不常见，所以这个函数将会在未来的版本中移除\n\t */\n\tsetLinePosXSpringParams(_params: Partial<SpringParams> = {}) {}\n\t/**\n\t * 设置所有歌词行在​纵坐标上的弹簧属性，包括重量、弹力和阻力。\n\t *\n\t * @param params 需要设置的弹簧属性，提供的属性将会覆盖原来的属性，未提供的属性将会保持原样\n\t */\n\tsetLinePosYSpringParams(params: Partial<SpringParams> = {}) {\n\t\tthis.posYSpringParams = {\n\t\t\t...this.posYSpringParams,\n\t\t\t...params,\n\t\t};\n\t\tthis.bottomLine.lineTransforms.posY.updateParams(this.posYSpringParams);\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.lineTransforms.posY.updateParams(this.posYSpringParams);\n\t\t}\n\t}\n\t/**\n\t * 设置所有歌词行在​缩放大小上的弹簧属性，包括重量、弹力和阻力。\n\t *\n\t * @param params 需要设置的弹簧属性，提供的属性将会覆盖原来的属性，未提供的属性将会保持原样\n\t */\n\tsetLineScaleSpringParams(params: Partial<SpringParams> = {}) {\n\t\tthis.scaleSpringParams = {\n\t\t\t...this.scaleSpringParams,\n\t\t\t...params,\n\t\t};\n\t\tthis.scaleForBGSpringParams = {\n\t\t\t...this.scaleForBGSpringParams,\n\t\t\t...params,\n\t\t};\n\t\tfor (const lineObj of this.currentLyricLineObjects) {\n\t\t\tif (lineObj.getLine().isBG) {\n\t\t\t\tlineObj.lineTransforms.scale.updateParams(this.scaleForBGSpringParams);\n\t\t\t} else {\n\t\t\t\tlineObj.lineTransforms.scale.updateParams(this.scaleSpringParams);\n\t\t\t}\n\t\t}\n\t}\n\tprotected isPlaying = true;\n\t/**\n\t * 暂停部分效果演出，目前会暂停播放间奏点的动画，且将背景歌词显示出来\n\t */\n\tpause() {\n\t\tthis.interludeDots.pause();\n\t\tif (this.isPlaying) {\n\t\t\tthis.isPlaying = false;\n\t\t\tthis.calcLayout();\n\t\t}\n\t}\n\t/**\n\t * 恢复部分效果演出，目前会恢复播放间奏点的动画\n\t */\n\tresume() {\n\t\tthis.interludeDots.resume();\n\t\tif (!this.isPlaying) {\n\t\t\tthis.isPlaying = true;\n\t\t\tthis.calcLayout();\n\t\t}\n\t}\n\t/**\n\t * 更新动画，这个函数应该被逐帧调用或者在以下情况下调用一次：\n\t *\n\t * 1. 刚刚调用完设置歌词函数的时候\n\t * @param delta 距离上一次被调用到现在的时长，单位为毫秒（可为浮点数）\n\t */\n\n\tupdate(delta = 0) {\n\t\tthis.bottomLine.update(delta / 1000);\n\t\tthis.interludeDots.update(delta / 1000);\n\t}\n\n\tprotected onResize() {}\n\n\t/**\n\t * 获取一个特殊的底栏元素，默认是空白的，可以往内部添加任意元素\n\t *\n\t * 这个元素始终在歌词的底部，可以用于显示歌曲创作者等信息\n\t *\n\t * 但是请勿删除该元素，只能在内部存放元素\n\t *\n\t * @returns 一个元素，可以往内部添加任意元素\n\t */\n\tgetBottomLineElement(): HTMLElement {\n\t\treturn this.bottomLine.getElement();\n\t}\n\t/**\n\t * 重置用户滚动状态\n\t *\n\t * 请在用户完成滚动点击跳转歌词时调用本事件再调用 `calcLayout` 以正确滚动到目标位置\n\t */\n\tresetScroll() {\n\t\tthis.isScrolled = false;\n\t\tthis.scrollOffset = 0;\n\t\tclearTimeout(this.scrolledHandler);\n\t\tthis.scrolledHandler = 0;\n\t}\n\t/**\n\t * 获取当前歌词数组\n\t *\n\t * 一般和最后调用 `setLyricLines` 给予的参数一样\n\t * @returns 当前歌词数组\n\t */\n\tgetLyricLines() {\n\t\treturn this.currentLyricLines;\n\t}\n\t/**\n\t * 获取当前歌词的播放位置\n\t *\n\t * 一般和最后调用 `setCurrentTime` 给予的参数一样\n\t * @returns 当前播放位置\n\t */\n\tgetCurrentTime() {\n\t\treturn this.currentTime;\n\t}\n\n\tgetElement(): HTMLElement {\n\t\treturn this.element;\n\t}\n\tdispose(): void {\n\t\tthis.element.remove();\n\t\twindow.removeEventListener(\"pageshow\", this.onPageShow);\n\t\twindow.removeEventListener(\"pagehide\", this.onPageHide);\n\t}\n}\n\n/**\n * 所有标准歌词行的基类\n * @internal\n */\nexport abstract class LyricLineBase extends EventTarget implements Disposable {\n\tprotected top = 0;\n\tprotected scale = 1;\n\tprotected blur = 0;\n\tprotected opacity = 1;\n\tprotected delay = 0;\n\treadonly lineTransforms = {\n\t\tposY: new Spring(0),\n\t\tscale: new Spring(100),\n\t};\n\tabstract getLine(): LyricLine;\n\tabstract enable(): void;\n\tabstract disable(): void;\n\tabstract resume(): void;\n\tabstract pause(): void;\n\tonLineSizeChange(_size: [number, number]): void {}\n\tsetTransform(\n\t\ttop: number = this.top,\n\t\tscale: number = this.scale,\n\t\topacity: number = this.opacity,\n\t\tblur: number = this.blur,\n\t\t_force = false,\n\t\tdelay = 0,\n\t) {\n\t\tthis.top = top;\n\t\tthis.scale = scale;\n\t\tthis.opacity = opacity;\n\t\tthis.blur = blur;\n\t\tthis.delay = delay;\n\t}\n\n\t/**\n\t * 判定歌词是否可以应用强调辉光效果\n\t *\n\t * 果子在对辉光效果的解释是一种强调（emphasized）效果\n\t *\n\t * 条件是一个单词时长大于等于 1s 且长度小于等于 7\n\t *\n\t * @param word 单词\n\t * @returns 是否可以应用强调辉光效果\n\t */\n\tstatic shouldEmphasize(word: LyricWord): boolean {\n\t\tif (isCJK(word.word)) return word.endTime - word.startTime >= 1000;\n\n\t\treturn (\n\t\t\tword.endTime - word.startTime >= 1000 &&\n\t\t\tword.word.trim().length <= 7 &&\n\t\t\tword.word.trim().length > 1\n\t\t);\n\t}\n\tabstract update(delta?: number): void;\n\tdispose() {}\n}\n","/**\n * https://github.com/gre/bezier-easing\n * BezierEasing - use bezier curve for transition easing function\n * by Gaëtan Renaudeau 2014 - 2015 – MIT License\n */\n\n// These values are established by empiricism with tests (tradeoff: performance VS precision)\nvar NEWTON_ITERATIONS = 4;\nvar NEWTON_MIN_SLOPE = 0.001;\nvar SUBDIVISION_PRECISION = 0.0000001;\nvar SUBDIVISION_MAX_ITERATIONS = 10;\n\nvar kSplineTableSize = 11;\nvar kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\nvar float32ArraySupported = typeof Float32Array === 'function';\n\nfunction A (aA1, aA2) { return 1.0 - 3.0 * aA2 + 3.0 * aA1; }\nfunction B (aA1, aA2) { return 3.0 * aA2 - 6.0 * aA1; }\nfunction C (aA1)      { return 3.0 * aA1; }\n\n// Returns x(t) given t, x1, and x2, or y(t) given t, y1, and y2.\nfunction calcBezier (aT, aA1, aA2) { return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT; }\n\n// Returns dx/dt given t, x1, and x2, or dy/dt given t, y1, and y2.\nfunction getSlope (aT, aA1, aA2) { return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1); }\n\nfunction binarySubdivide (aX, aA, aB, mX1, mX2) {\n  var currentX, currentT, i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2.0;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0.0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (Math.abs(currentX) > SUBDIVISION_PRECISION && ++i < SUBDIVISION_MAX_ITERATIONS);\n  return currentT;\n}\n\nfunction newtonRaphsonIterate (aX, aGuessT, mX1, mX2) {\n for (var i = 0; i < NEWTON_ITERATIONS; ++i) {\n   var currentSlope = getSlope(aGuessT, mX1, mX2);\n   if (currentSlope === 0.0) {\n     return aGuessT;\n   }\n   var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n   aGuessT -= currentX / currentSlope;\n }\n return aGuessT;\n}\n\nfunction LinearEasing (x) {\n  return x;\n}\n\nmodule.exports = function bezier (mX1, mY1, mX2, mY2) {\n  if (!(0 <= mX1 && mX1 <= 1 && 0 <= mX2 && mX2 <= 1)) {\n    throw new Error('bezier x values must be in [0, 1] range');\n  }\n\n  if (mX1 === mY1 && mX2 === mY2) {\n    return LinearEasing;\n  }\n\n  // Precompute samples table\n  var sampleValues = float32ArraySupported ? new Float32Array(kSplineTableSize) : new Array(kSplineTableSize);\n  for (var i = 0; i < kSplineTableSize; ++i) {\n    sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n  }\n\n  function getTForX (aX) {\n    var intervalStart = 0.0;\n    var currentSample = 1;\n    var lastSample = kSplineTableSize - 1;\n\n    for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n      intervalStart += kSampleStepSize;\n    }\n    --currentSample;\n\n    // Interpolate to provide an initial guess for t\n    var dist = (aX - sampleValues[currentSample]) / (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n    var guessForT = intervalStart + dist * kSampleStepSize;\n\n    var initialSlope = getSlope(guessForT, mX1, mX2);\n    if (initialSlope >= NEWTON_MIN_SLOPE) {\n      return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n    } else if (initialSlope === 0.0) {\n      return guessForT;\n    } else {\n      return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n    }\n  }\n\n  return function BezierEasing (x) {\n    // Because JavaScript number are imprecise, we should guarantee the extremes are right.\n    if (x === 0) {\n      return 0;\n    }\n    if (x === 1) {\n      return 1;\n    }\n    return calcBezier(getTForX(x), mY1, mY2);\n  };\n};\n","import type { LyricWord } from \"../interfaces.ts\";\n\nconst CJKEXP = /^[\\p{Unified_Ideograph}\\u0800-\\u9FFC]+$/u;\n\n/**\n * 将输入的单词重新分组，之间没有空格的单词将会组合成一个单词数组\n *\n * 例如输入：`[\"Life\", \" \", \"is\", \" a\", \" su\", \"gar so\", \"sweet\"]`\n *\n * 应该返回：`[\"Life\", \" \", \"is\", \" a\", [\" su\", \"gar\"], \"so\", \"sweet\"]`\n * @param words 输入的单词数组\n * @returns 重新分组后的单词数组\n */\nexport function chunkAndSplitLyricWords(\n\twords: LyricWord[],\n): (LyricWord | LyricWord[])[] {\n\tconst resplitedWords: LyricWord[] = [];\n\n\tfor (const w of words) {\n\t\tconst realLength = w.word.replace(/\\s/g, \"\").length;\n\t\tconst splited = w.word.split(\" \").filter((v) => v.trim().length > 0);\n\t\tif (splited.length > 1) {\n\t\t\tif (w.word.startsWith(\" \")) {\n\t\t\t\tresplitedWords.push({\n\t\t\t\t\tword: \" \",\n\t\t\t\t\tromanWord: \"\",\n\t\t\t\t\tstartTime: 0,\n\t\t\t\t\tendTime: 0,\n\t\t\t\t\tobscene: false,\n\t\t\t\t});\n\t\t\t}\n\t\t\tlet charPos = 0;\n\t\t\tfor (const s of splited) {\n\t\t\t\tconst word: LyricWord = {\n\t\t\t\t\tword: s,\n\t\t\t\t\tromanWord: \"\",\n\t\t\t\t\tobscene: w.obscene,\n\t\t\t\t\tstartTime:\n\t\t\t\t\t\tw.startTime + (charPos / realLength) * (w.endTime - w.startTime),\n\t\t\t\t\tendTime:\n\t\t\t\t\t\tw.startTime +\n\t\t\t\t\t\t((charPos + s.length) / realLength) * (w.endTime - w.startTime),\n\t\t\t\t};\n\t\t\t\tresplitedWords.push(word);\n\t\t\t\tresplitedWords.push({\n\t\t\t\t\tword: \" \",\n\t\t\t\t\tromanWord: \"\",\n\t\t\t\t\tstartTime: 0,\n\t\t\t\t\tendTime: 0,\n\t\t\t\t\tobscene: false,\n\t\t\t\t});\n\t\t\t\tcharPos += s.length;\n\t\t\t}\n\t\t\tif (!w.word.endsWith(\" \")) {\n\t\t\t\tresplitedWords.pop();\n\t\t\t}\n\t\t} else {\n\t\t\tresplitedWords.push({\n\t\t\t\t...w,\n\t\t\t});\n\t\t}\n\t}\n\n\tlet wordChunk: string[] = [];\n\tlet wChunk: LyricWord[] = [];\n\tconst result: (LyricWord | LyricWord[])[] = [];\n\n\tfor (const w of resplitedWords) {\n\t\tconst word = w.word;\n\t\twordChunk.push(word);\n\t\twChunk.push(w);\n\t\tif (word.length > 0 && word.trim().length === 0) {\n\t\t\twordChunk.pop();\n\t\t\twChunk.pop();\n\t\t\tif (wChunk.length === 1) {\n\t\t\t\tresult.push(wChunk[0]);\n\t\t\t} else if (wChunk.length > 1) {\n\t\t\t\tresult.push(wChunk);\n\t\t\t}\n\t\t\tresult.push(w);\n\t\t\twordChunk = [];\n\t\t\twChunk = [];\n\t\t} else if (\n\t\t\t!/^\\s*[^\\s]*\\s*$/.test(wordChunk.join(\"\")) ||\n\t\t\tCJKEXP.test(word)\n\t\t) {\n\t\t\twordChunk.pop();\n\t\t\twChunk.pop();\n\t\t\tif (wChunk.length === 1) {\n\t\t\t\tresult.push(wChunk[0]);\n\t\t\t} else if (wChunk.length > 1) {\n\t\t\t\tresult.push(wChunk);\n\t\t\t}\n\t\t\twordChunk = [word];\n\t\t\twChunk = [w];\n\t\t}\n\t}\n\n\tif (wChunk.length === 1) {\n\t\tresult.push(wChunk[0]);\n\t} else {\n\t\tresult.push(wChunk);\n\t}\n\n\treturn result;\n}\n","// biome-ignore format: matrix\nexport type Matrix4 = [\n\tnumber, number, number, number,\n\tnumber, number, number, number,\n\tnumber, number, number, number,\n\tnumber, number, number, number,\n];\n\nexport function createMatrix4(): Matrix4 {\n\t// biome-ignore format: matrix\n\treturn [\n        1, 0, 0, 0,\n        0, 1, 0, 0,\n        0, 0, 1, 0,\n        0, 0, 0, 1\n    ];\n}\n\nexport function scaleMatrix4(\n\tm: Matrix4,\n\tscale = 1,\n\torigin = { x: 0, y: 0 },\n): Matrix4 {\n\tconst [ox, oy] = [origin.x, origin.y];\n\t// biome-ignore format: matrix\n\treturn [\n        m[0] * scale           , m[1] * scale           , m[2] * scale , m[3],\n        m[4] * scale           , m[5] * scale           , m[6] * scale , m[7],\n        m[8] * scale           , m[9] * scale           , m[10] * scale, m[11],\n        m[12] - ox * scale + ox, m[13] - oy * scale + oy, m[14]        , m[15]\n    ];\n}\n\nexport function translateMatrix4(m: Matrix4, x = 0, y = 0, z = 0): Matrix4 {\n\t// biome-ignore format: matrix\n\treturn [\n        m[0]     , m[1]     , m[2]     , m[3] ,\n        m[4]     , m[5]     , m[6]     , m[7] ,\n        m[8]     , m[9]     , m[10]    , m[11],\n        m[12] + x, m[13] + y, m[14] + z, m[15]\n    ];\n}\n\nexport function matrix4ToCSS(m: Matrix4, fractionDigits = 4): string {\n\tconst format = (n: number, i: number) => n.toFixed(fractionDigits);\n\treturn `matrix3d(${m.map(format).join(\", \")})`;\n}\n","import bezier from \"bezier-easing\";\nimport type { LyricLine, LyricWord } from \"../../interfaces.ts\";\nimport styles from \"../../styles/lyric-player.module.css\";\nimport { chunkAndSplitLyricWords } from \"../../utils/lyric-split-words.ts\";\nimport {\n\tcreateMatrix4,\n\tmatrix4ToCSS,\n\tscaleMatrix4,\n} from \"../../utils/matrix.ts\";\nimport { LyricLineBase } from \"../base.ts\";\nimport type { DomLyricPlayer } from \".\";\n\ninterface RealWord extends LyricWord {\n\tmainElement: HTMLSpanElement;\n\tsubElements: HTMLSpanElement[];\n\telementAnimations: Animation[];\n\tmaskAnimations: Animation[];\n\twidth: number;\n\theight: number;\n\tpadding: number;\n\tshouldEmphasize: boolean;\n}\n\nconst ANIMATION_FRAME_QUANTITY = 32;\n\nconst norNum = (min: number, max: number) => (x: number) =>\n\tMath.min(1, Math.max(0, (x - min) / (max - min)));\nconst EMP_EASING_MID = 0.5;\nconst beginNum = norNum(0, EMP_EASING_MID);\nconst endNum = norNum(EMP_EASING_MID, 1);\n\nconst bezIn = bezier(0.2, 0.4, 0.58, 1.0);\nconst bezOut = bezier(0.3, 0.0, 0.58, 1.0);\n\nconst makeEmpEasing = (mid: number) => {\n\treturn (x: number) => (x < mid ? bezIn(beginNum(x)) : 1 - bezOut(endNum(x)));\n};\n\nfunction generateFadeGradient(\n\twidth: number,\n\tpadding = 0,\n\tbright = \"rgba(0,0,0,var(--bright-mask-alpha, 1.0))\",\n\tdark = \"rgba(0,0,0,var(--dark-mask-alpha, 1.0))\",\n): [string, number] {\n\tconst totalAspect = 2 + width + padding;\n\tconst widthInTotal = width / totalAspect;\n\tconst leftPos = (1 - widthInTotal) / 2;\n\treturn [\n\t\t`linear-gradient(to right,${bright} ${leftPos * 100}%,${dark} ${\n\t\t\t(leftPos + widthInTotal) * 100\n\t\t}%)`,\n\t\ttotalAspect,\n\t];\n}\n\nexport class RawLyricLineMouseEvent extends MouseEvent {\n\tconstructor(\n\t\tpublic readonly line: LyricLineBase,\n\t\tevent: MouseEvent,\n\t) {\n\t\tsuper(event.type, event);\n\t}\n}\n\nfunction getScaleFromTransform(transform: string): number {\n\tconst match = transform.match(/matrix\\(([^)]+)\\)/);\n\tif (match) {\n\t\tconst values = match[1].split(\", \");\n\t\tconst scaleX = Number.parseFloat(values[0]);\n\t\tconst scaleY = Number.parseFloat(values[3]);\n\t\treturn (scaleX + scaleY) / 2; // Average of scaleX and scaleY\n\t}\n\treturn 1; // Default scale value if not found\n}\n\ntype MouseEventMap = {\n\t[evt in keyof HTMLElementEventMap]: HTMLElementEventMap[evt] extends MouseEvent\n\t\t? evt\n\t\t: never;\n};\ntype MouseEventTypes = MouseEventMap[keyof MouseEventMap];\ntype MouseEventListener = (\n\tthis: LyricLineEl,\n\tev: RawLyricLineMouseEvent,\n) => void;\n\nexport class LyricLineEl extends LyricLineBase {\n\tprivate element: HTMLElement = document.createElement(\"div\");\n\tprivate splittedWords: RealWord[] = [];\n\t// 标记是否已经构建了行内的实际 DOM（单词与动画等）\n\tprivate built = false;\n\n\t// 由 LyricPlayer 来设置\n\tlineSize: number[] = [0, 0];\n\n\tconstructor(\n\t\tprivate lyricPlayer: DomLyricPlayer,\n\t\tprivate lyricLine: LyricLine = {\n\t\t\twords: [],\n\t\t\ttranslatedLyric: \"\",\n\t\t\tromanLyric: \"\",\n\t\t\tstartTime: 0,\n\t\t\tendTime: 0,\n\t\t\tisBG: false,\n\t\t\tisDuet: false,\n\t\t},\n\t) {\n\t\tsuper();\n\t\tthis._prevParentEl = lyricPlayer.getElement();\n\t\tlyricPlayer.resizeObserver.observe(this.element);\n\t\tthis.element.setAttribute(\"class\", styles.lyricLine);\n\t\tif (this.lyricLine.isBG) {\n\t\t\tthis.element.classList.add(styles.lyricBgLine);\n\t\t}\n\t\tif (this.lyricLine.isDuet) {\n\t\t\tthis.element.classList.add(styles.lyricDuetLine);\n\t\t}\n\t\tthis.lineTransforms.posY.setPosition(window.innerHeight * 2);\n\t\tthis.element.appendChild(document.createElement(\"div\")); // 歌词行\n\t\tthis.element.appendChild(document.createElement(\"div\")); // 翻译行\n\t\tthis.element.appendChild(document.createElement(\"div\")); // 音译行\n\t\tconst main = this.element.children[0] as HTMLDivElement;\n\t\tconst trans = this.element.children[1] as HTMLDivElement;\n\t\tconst roman = this.element.children[2] as HTMLDivElement;\n\t\tmain.setAttribute(\"class\", styles.lyricMainLine);\n\t\ttrans.setAttribute(\"class\", styles.lyricSubLine);\n\t\troman.setAttribute(\"class\", styles.lyricSubLine);\n\t\t// 延迟构建具体行内容，进入可视区（含 overscan）时再构建\n\t\tthis.rebuildStyle();\n\t}\n\tprivate listenersMap = new Map<string, Set<MouseEventListener>>();\n\tprivate readonly onMouseEvent = (e: MouseEvent) => {\n\t\tconst wrapped = new RawLyricLineMouseEvent(this, e);\n\t\tfor (const listener of this.listenersMap.get(e.type) ?? []) {\n\t\t\tlistener.call(this, wrapped);\n\t\t}\n\t\tif (!this.dispatchEvent(wrapped) || wrapped.defaultPrevented) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t\treturn false;\n\t\t}\n\t};\n\n\taddMouseEventListener(\n\t\ttype: MouseEventTypes,\n\t\tcallback: MouseEventListener | null,\n\t\toptions?: boolean | AddEventListenerOptions | undefined,\n\t): void {\n\t\tif (callback) {\n\t\t\tconst listeners = this.listenersMap.get(type) ?? new Set();\n\t\t\tif (listeners.size === 0)\n\t\t\t\tthis.element.addEventListener(type, this.onMouseEvent, options);\n\t\t\tlisteners.add(callback);\n\t\t\tthis.listenersMap.set(type, listeners);\n\t\t}\n\t}\n\n\tremoveMouseEventListener(\n\t\ttype: MouseEventTypes,\n\t\tcallback: MouseEventListener | null,\n\t\toptions?: boolean | EventListenerOptions | undefined,\n\t): void {\n\t\tif (callback) {\n\t\t\tconst listeners = this.listenersMap.get(type);\n\t\t\tif (listeners) {\n\t\t\t\tlisteners.delete(callback);\n\t\t\t\tif (listeners.size === 0)\n\t\t\t\t\tthis.element.removeEventListener(type, this.onMouseEvent, options);\n\t\t\t}\n\t\t}\n\t}\n\n\tareWordsOnSameLine(word1: RealWord, word2: RealWord) {\n\t\tif (word1?.mainElement && word2?.mainElement) {\n\t\t\tconst word1el = word1.mainElement;\n\t\t\tconst word2el = word2.mainElement;\n\n\t\t\tconst rect1 = word1el.getBoundingClientRect();\n\t\t\tconst rect2 = word2el.getBoundingClientRect();\n\n\t\t\t// 检查两个单词的顶部距离是否相等（或者差值很小）\n\t\t\tconst topDifference = Math.abs(rect1.top - rect2.top);\n\n\t\t\t// 如果顶部距离相差很小，可以认为它们在同一行上\n\t\t\treturn topDifference < 10;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate isEnabled = false;\n\tasync enable(maskAnimationTime = this.lyricLine.startTime) {\n\t\tthis.isEnabled = true;\n\t\tthis.element.classList.add(styles.active);\n\t\tconst main = this.element.children[0] as HTMLDivElement;\n\t\tfor (const word of this.splittedWords) {\n\t\t\tfor (const a of word.elementAnimations) {\n\t\t\t\ta.currentTime = 0;\n\t\t\t\ta.playbackRate = 1;\n\t\t\t\ta.play();\n\t\t\t}\n\t\t\tfor (const a of word.maskAnimations) {\n\t\t\t\ta.currentTime = Math.min(\n\t\t\t\t\tthis.totalDuration,\n\t\t\t\t\tMath.max(0, maskAnimationTime - this.lyricLine.startTime),\n\t\t\t\t);\n\t\t\t\ta.playbackRate = 1;\n\t\t\t\ta.play();\n\t\t\t}\n\t\t}\n\t\tmain.classList.add(styles.active);\n\t}\n\tdisable() {\n\t\tthis.isEnabled = false;\n\t\tthis.element.classList.remove(styles.active);\n\t\tconst main = this.element.children[0] as HTMLDivElement;\n\t\tfor (const word of this.splittedWords) {\n\t\t\tfor (const a of word.elementAnimations) {\n\t\t\t\tif (\n\t\t\t\t\ta.id === \"float-word\" ||\n\t\t\t\t\ta.id.includes(\"emphasize-word-float-only\")\n\t\t\t\t) {\n\t\t\t\t\ta.playbackRate = -1;\n\t\t\t\t\ta.play();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tmain.classList.remove(styles.active);\n\t}\n\tprivate lastWord?: RealWord;\n\tasync resume() {\n\t\tif (!this.isEnabled) return;\n\t\tfor (const word of this.splittedWords) {\n\t\t\tfor (const a of word.elementAnimations) {\n\t\t\t\tif (\n\t\t\t\t\t!this.lastWord ||\n\t\t\t\t\tthis.splittedWords.indexOf(this.lastWord) <\n\t\t\t\t\t\tthis.splittedWords.indexOf(word)\n\t\t\t\t) {\n\t\t\t\t\ta.play();\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const a of word.maskAnimations) {\n\t\t\t\tif (\n\t\t\t\t\t!this.lastWord ||\n\t\t\t\t\tthis.splittedWords.indexOf(this.lastWord) <\n\t\t\t\t\t\tthis.splittedWords.indexOf(word)\n\t\t\t\t) {\n\t\t\t\t\ta.play();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tasync pause() {\n\t\tif (!this.isEnabled) return;\n\t\tfor (const word of this.splittedWords) {\n\t\t\tfor (const a of word.elementAnimations) {\n\t\t\t\ta.pause();\n\t\t\t}\n\t\t\tfor (const a of word.maskAnimations) {\n\t\t\t\ta.pause();\n\t\t\t}\n\t\t}\n\t}\n\tsetMaskAnimationState(maskAnimationTime = 0) {\n\t\tconst t = maskAnimationTime - this.lyricLine.startTime;\n\t\tfor (const word of this.splittedWords) {\n\t\t\tfor (const a of word.maskAnimations) {\n\t\t\t\ta.currentTime = Math.min(this.totalDuration, Math.max(0, t));\n\t\t\t\ta.playbackRate = 1;\n\t\t\t\tif (t >= 0 && t < this.totalDuration) a.play();\n\t\t\t\telse a.pause();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLine() {\n\t\treturn this.lyricLine;\n\t}\n\tprivate _hide = true;\n\tprivate _prevParentEl: HTMLElement;\n\tprivate lastStyle = \"\";\n\tshow() {\n\t\tthis._hide = false;\n\t\tif (!this.element.parentElement) {\n\t\t\tthis._prevParentEl.appendChild(this.element);\n\t\t\tthis.lyricPlayer.resizeObserver.observe(this.element);\n\t\t}\n\t\tif (!this.built) {\n\t\t\tthis.rebuildElement();\n\t\t\tthis.built = true;\n\t\t\tthis.updateMaskImageSync();\n\t\t}\n\t\tthis.rebuildStyle();\n\t}\n\thide() {\n\t\tthis._hide = true;\n\t\tif (this.element.parentElement) {\n\t\t\tthis._prevParentEl.removeChild(this.element);\n\t\t\tthis.lyricPlayer.resizeObserver.unobserve(this.element);\n\t\t}\n\t\tif (this.built) {\n\t\t\tthis.disposeElements();\n\t\t\tthis.built = false;\n\t\t}\n\t}\n\tprivate rebuildStyle() {\n\t\tlet style = \"\";\n\t\t// if (this.lyricPlayer.getEnableSpring()) {\n\t\tstyle += `transform:translateY(${this.lineTransforms.posY\n\t\t\t.getCurrentPosition()\n\t\t\t.toFixed(\n\t\t\t\t1,\n\t\t\t)}px) scale(${(this.lineTransforms.scale.getCurrentPosition() / 100).toFixed(4)});`;\n\t\tif (!this.lyricPlayer.getEnableSpring() && this.isInSight) {\n\t\t\tstyle += `transition-delay:${this.delay}ms;`;\n\t\t}\n\t\tstyle += `filter:blur(${Math.min(32, this.blur)}px);`;\n\t\tif (style !== this.lastStyle) {\n\t\t\tthis.lastStyle = style;\n\t\t\tthis.element.setAttribute(\"style\", style);\n\t\t}\n\t}\n\n\trebuildElement() {\n\t\tthis.disposeElements();\n\t\tconst main = this.element.children[0] as HTMLDivElement;\n\t\tconst trans = this.element.children[1] as HTMLDivElement;\n\t\tconst roman = this.element.children[2] as HTMLDivElement;\n\t\t// 非动态歌词，直接渲染整行与副行\n\t\tif (this.lyricPlayer._getIsNonDynamic()) {\n\t\t\tmain.innerText = this.lyricLine.words.map((w) => w.word).join(\"\");\n\t\t\tthis.setSubLinesText(trans, roman);\n\t\t\treturn;\n\t\t}\n\n\t\tconst chunkedWords = chunkAndSplitLyricWords(this.lyricLine.words);\n\t\tmain.innerHTML = \"\";\n\t\tfor (const chunk of chunkedWords) {\n\t\t\tif (Array.isArray(chunk)) {\n\t\t\t\t// 多个没有空格的单词组合在一起\n\t\t\t\tif (chunk.length === 0) continue;\n\t\t\t\tthis.buildChunkGroup(chunk, main);\n\t\t\t} else if (chunk.word.trim().length === 0) {\n\t\t\t\t// 纯空格\n\t\t\t\tmain.appendChild(document.createTextNode(\" \"));\n\t\t\t} else {\n\t\t\t\t// 单个单词\n\t\t\t\tthis.buildSingleWord(chunk, main);\n\t\t\t}\n\t\t}\n\t\tthis.setSubLinesText(trans, roman);\n\t}\n\n\t/** 设置翻译与音译行文本 */\n\tprivate setSubLinesText(trans: HTMLDivElement, roman: HTMLDivElement) {\n\t\ttrans.innerText = this.lyricLine.translatedLyric;\n\t\troman.innerText = this.lyricLine.romanLyric;\n\t}\n\n\t/** 处理一组连写（无空格）单词，包含强调效果 */\n\tprivate buildChunkGroup(chunk: LyricWord[], main: HTMLDivElement) {\n\t\t// 聚合区间与文本作为合并词\n\t\tconst merged = chunk.reduce(\n\t\t\t(a, b) => {\n\t\t\t\ta.endTime = Math.max(a.endTime, b.endTime);\n\t\t\t\ta.startTime = Math.min(a.startTime, b.startTime);\n\t\t\t\ta.word += b.word;\n\t\t\t\treturn a;\n\t\t\t},\n\t\t\t{\n\t\t\t\tword: \"\",\n\t\t\t\tromanWord: \"\",\n\t\t\t\tstartTime: Number.POSITIVE_INFINITY,\n\t\t\t\tendTime: Number.NEGATIVE_INFINITY,\n\t\t\t\twordType: \"normal\",\n\t\t\t\tobscene: false,\n\t\t\t} as LyricWord,\n\t\t);\n\t\tconst emp = chunk\n\t\t\t.map((word) => LyricLineBase.shouldEmphasize(word))\n\t\t\t.reduce((a, b) => a || b, LyricLineBase.shouldEmphasize(merged));\n\n\t\tconst wrapperWordEl = document.createElement(\"span\");\n\t\twrapperWordEl.classList.add(styles.emphasizeWrapper);\n\n\t\tconst characterElements: HTMLElement[] = [];\n\t\tfor (const word of chunk) {\n\t\t\tconst mainWordEl = document.createElement(\"span\");\n\t\t\tif (emp) {\n\t\t\t\tmainWordEl.classList.add(styles.emphasize);\n\t\t\t\tconst charEls: HTMLSpanElement[] = [];\n\t\t\t\tfor (const char of word.word.trim()) {\n\t\t\t\t\tconst charEl = document.createElement(\"span\");\n\t\t\t\t\tcharEl.innerText = char;\n\t\t\t\t\tcharEls.push(charEl);\n\t\t\t\t\tcharacterElements.push(charEl);\n\t\t\t\t\tmainWordEl.appendChild(charEl);\n\t\t\t\t}\n\t\t\t\tconst realWord: RealWord = {\n\t\t\t\t\t...word,\n\t\t\t\t\tmainElement: mainWordEl,\n\t\t\t\t\tsubElements: charEls,\n\t\t\t\t\telementAnimations: [this.initFloatAnimation(word, mainWordEl)],\n\t\t\t\t\tmaskAnimations: [],\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\tshouldEmphasize: emp,\n\t\t\t\t};\n\t\t\t\tthis.splittedWords.push(realWord);\n\t\t\t} else {\n\t\t\t\t// 普通显示（可能含音译）\n\t\t\t\tif (word.romanWord && word.romanWord.trim().length > 0) {\n\t\t\t\t\tconst wordEl = document.createElement(\"div\");\n\t\t\t\t\tconst romanWordEl = document.createElement(\"div\");\n\t\t\t\t\twordEl.innerText = word.word;\n\t\t\t\t\tromanWordEl.innerText = word.romanWord;\n\t\t\t\t\tromanWordEl.classList.add(styles.romanWord);\n\t\t\t\t\tmainWordEl.appendChild(wordEl);\n\t\t\t\t\tmainWordEl.appendChild(romanWordEl);\n\t\t\t\t} else {\n\t\t\t\t\tmainWordEl.innerText = word.word;\n\t\t\t\t}\n\t\t\t\tthis.splittedWords.push({\n\t\t\t\t\t...word,\n\t\t\t\t\tmainElement: mainWordEl,\n\t\t\t\t\tsubElements: [],\n\t\t\t\t\telementAnimations: [this.initFloatAnimation(word, mainWordEl)],\n\t\t\t\t\tmaskAnimations: [],\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\tshouldEmphasize: emp,\n\t\t\t\t});\n\t\t\t}\n\t\t\twrapperWordEl.appendChild(mainWordEl);\n\t\t}\n\n\t\t// 组强调动画追加到该组的最后一个词的动画列表（保持原逻辑）\n\t\tif (emp) {\n\t\t\tthis.splittedWords[this.splittedWords.length - 1].elementAnimations.push(\n\t\t\t\t...this.initEmphasizeAnimation(\n\t\t\t\t\tmerged,\n\t\t\t\t\tcharacterElements,\n\t\t\t\t\tmerged.endTime - merged.startTime,\n\t\t\t\t\tmerged.startTime - this.lyricLine.startTime,\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\t// 前后空格处理（保持原有判断）\n\t\tif (merged.word.trimStart() !== merged.word) {\n\t\t\tmain.appendChild(document.createTextNode(\" \"));\n\t\t}\n\t\tmain.appendChild(wrapperWordEl);\n\t\tif (\n\t\t\tmerged.word.trimEnd() !== merged.word &&\n\t\t\tLyricLineBase.shouldEmphasize(merged)\n\t\t) {\n\t\t\tmain.appendChild(document.createTextNode(\" \"));\n\t\t}\n\t}\n\n\t/** 渲染单个词（含强调与音译处理） */\n\tprivate buildSingleWord(chunk: LyricWord, main: HTMLDivElement) {\n\t\tconst emp = LyricLineBase.shouldEmphasize(chunk);\n\t\tconst mainWordEl = document.createElement(\"span\");\n\t\tconst realWord: RealWord = {\n\t\t\t...chunk,\n\t\t\tmainElement: mainWordEl,\n\t\t\tsubElements: [],\n\t\t\telementAnimations: [this.initFloatAnimation(chunk, mainWordEl)],\n\t\t\tmaskAnimations: [],\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\tpadding: 0,\n\t\t\tshouldEmphasize: emp,\n\t\t};\n\n\t\tif (emp) {\n\t\t\tmainWordEl.classList.add(styles.emphasize);\n\t\t\tconst charEls: HTMLSpanElement[] = [];\n\t\t\tfor (const char of chunk.word.trim()) {\n\t\t\t\tconst charEl = document.createElement(\"span\");\n\t\t\t\tcharEl.innerText = char;\n\t\t\t\tcharEls.push(charEl);\n\t\t\t\tmainWordEl.appendChild(charEl);\n\t\t\t}\n\t\t\tif (chunk.romanWord && chunk.romanWord.trim().length > 0) {\n\t\t\t\tconst romanWordEl = document.createElement(\"div\");\n\t\t\t\tromanWordEl.innerText = chunk.romanWord;\n\t\t\t\tromanWordEl.classList.add(styles.romanWord);\n\t\t\t\tmainWordEl.appendChild(romanWordEl);\n\t\t\t}\n\t\t\trealWord.subElements = charEls;\n\t\t\tconst duration = Math.abs(realWord.endTime - realWord.startTime);\n\t\t\trealWord.elementAnimations.push(\n\t\t\t\t...this.initEmphasizeAnimation(\n\t\t\t\t\tchunk,\n\t\t\t\t\tcharEls,\n\t\t\t\t\tduration,\n\t\t\t\t\trealWord.startTime - this.lyricLine.startTime,\n\t\t\t\t),\n\t\t\t);\n\t\t} else {\n\t\t\tif (chunk.romanWord && chunk.romanWord.trim().length > 0) {\n\t\t\t\tconst wordEl = document.createElement(\"div\");\n\t\t\t\tconst romanWordEl = document.createElement(\"div\");\n\t\t\t\twordEl.innerText = chunk.word;\n\t\t\t\tromanWordEl.innerText = chunk.romanWord;\n\t\t\t\tromanWordEl.classList.add(styles.romanWord);\n\t\t\t\tmainWordEl.appendChild(wordEl);\n\t\t\t\tmainWordEl.appendChild(romanWordEl);\n\t\t\t} else {\n\t\t\t\tmainWordEl.innerText = chunk.word.trim();\n\t\t\t}\n\t\t}\n\n\t\t// 前后空格处理\n\t\tif (chunk.word.trimStart() !== chunk.word) {\n\t\t\tmain.appendChild(document.createTextNode(\" \"));\n\t\t}\n\t\tmain.appendChild(mainWordEl);\n\t\tif (chunk.word.trimEnd() !== chunk.word) {\n\t\t\tmain.appendChild(document.createTextNode(\" \"));\n\t\t}\n\t\tthis.splittedWords.push(realWord);\n\t}\n\tprivate initFloatAnimation(word: LyricWord, wordEl: HTMLSpanElement) {\n\t\tconst delay = word.startTime - this.lyricLine.startTime;\n\t\tconst duration = Math.max(1000, word.endTime - word.startTime);\n\t\tlet up = 0.05;\n\t\tif (this.lyricLine.isBG) {\n\t\t\tup *= 2;\n\t\t}\n\t\tconst a = wordEl.animate(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\ttransform: \"translateY(0px)\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttransform: `translateY(${-up}em)`,\n\t\t\t\t},\n\t\t\t],\n\t\t\t{\n\t\t\t\tduration: Number.isFinite(duration) ? duration : 0,\n\t\t\t\tdelay: Number.isFinite(delay) ? delay : 0,\n\t\t\t\tid: \"float-word\",\n\t\t\t\tcomposite: \"add\",\n\t\t\t\tfill: \"both\",\n\t\t\t\teasing: \"ease-out\",\n\t\t\t},\n\t\t);\n\t\ta.pause();\n\t\treturn a;\n\t}\n\t// 按照原 Apple Music 参考，强调效果只应用缩放、轻微左右位移和辉光效果，原主要的悬浮位移效果不变\n\t// 为了避免产生锯齿抖动感，使用 matrix3d 来实现缩放和位移\n\tprivate initEmphasizeAnimation(\n\t\tword: LyricWord,\n\t\tcharacterElements: HTMLElement[],\n\t\tduration: number,\n\t\tdelay: number,\n\t): Animation[] {\n\t\tconst de = Math.max(0, delay);\n\t\tlet du = Math.max(1000, duration);\n\n\t\tlet result: Animation[] = [];\n\n\t\tlet amount = du / 2000;\n\t\tamount = amount > 1 ? Math.sqrt(amount) : amount ** 3;\n\t\tlet blur = du / 3000;\n\t\tblur = blur > 1 ? Math.sqrt(blur) : blur ** 3;\n\t\tamount *= 0.6;\n\t\tblur *= 0.5;\n\t\tif (\n\t\t\tthis.lyricLine.words.length > 0 &&\n\t\t\tword.word.includes(\n\t\t\t\tthis.lyricLine.words[this.lyricLine.words.length - 1].word,\n\t\t\t)\n\t\t) {\n\t\t\tamount *= 1.6;\n\t\t\tblur *= 1.5;\n\t\t\tdu *= 1.2;\n\t\t}\n\t\tamount = Math.min(1.2, amount);\n\t\tblur = Math.min(0.8, blur);\n\n\t\tconst animateDu = Number.isFinite(du) ? du : 0;\n\t\tconst empEasing = makeEmpEasing(EMP_EASING_MID);\n\n\t\tresult = characterElements.flatMap((el, i, arr) => {\n\t\t\tconst wordDe = de + (du / 2.5 / arr.length) * i;\n\t\t\tconst result: Animation[] = [];\n\n\t\t\tconst frames: Keyframe[] = new Array(ANIMATION_FRAME_QUANTITY)\n\t\t\t\t.fill(0)\n\t\t\t\t.map((_, j) => {\n\t\t\t\t\tconst x = (j + 1) / ANIMATION_FRAME_QUANTITY;\n\t\t\t\t\tconst transX = empEasing(x);\n\t\t\t\t\tconst glowLevel = empEasing(x) * blur;\n\n\t\t\t\t\tconst mat = scaleMatrix4(createMatrix4(), 1 + transX * 0.1 * amount);\n\t\t\t\t\tconst offsetX = -transX * 0.03 * amount * (arr.length / 2 - i);\n\t\t\t\t\tconst offsetY = -transX * 0.025 * amount;\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\toffset: x,\n\t\t\t\t\t\ttransform: `${matrix4ToCSS(\n\t\t\t\t\t\t\tmat,\n\t\t\t\t\t\t\t4,\n\t\t\t\t\t\t)} translate(${offsetX}em, ${offsetY}em)`,\n\t\t\t\t\t\ttextShadow: `0 0 ${Math.min(\n\t\t\t\t\t\t\t0.3,\n\t\t\t\t\t\t\tblur * 0.3,\n\t\t\t\t\t\t)}em rgba(255, 255, 255, ${glowLevel})`,\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\tconst glow = el.animate(frames, {\n\t\t\t\tduration: animateDu,\n\t\t\t\tdelay: Number.isFinite(wordDe) ? wordDe : 0,\n\t\t\t\tid: `emphasize-word-${el.innerText}-${i}`,\n\t\t\t\titerations: 1,\n\t\t\t\tcomposite: \"replace\",\n\t\t\t\tfill: \"both\",\n\t\t\t});\n\t\t\tglow.onfinish = () => {\n\t\t\t\tglow.pause();\n\t\t\t};\n\t\t\tglow.pause();\n\t\t\tresult.push(glow);\n\n\t\t\tconst floatFrame: Keyframe[] = new Array(ANIMATION_FRAME_QUANTITY)\n\t\t\t\t.fill(0)\n\t\t\t\t.map((_, j) => {\n\t\t\t\t\tconst x = (j + 1) / ANIMATION_FRAME_QUANTITY;\n\t\t\t\t\tlet y = Math.sin(x * Math.PI);\n\t\t\t\t\t// y = x < 0.5 ? y : Math.max(y, 1.0);\n\t\t\t\t\tif (this.lyricLine.isBG) {\n\t\t\t\t\t\ty *= 2;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\toffset: x,\n\t\t\t\t\t\ttransform: `translateY(${-y * 0.05}em)`,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\tconst float = el.animate(floatFrame, {\n\t\t\t\tduration: animateDu * 1.4,\n\t\t\t\tdelay: Number.isFinite(wordDe) ? wordDe - 400 : 0,\n\t\t\t\tid: \"emphasize-word-float\",\n\t\t\t\titerations: 1,\n\t\t\t\tcomposite: \"add\",\n\t\t\t\tfill: \"both\",\n\t\t\t});\n\t\t\tfloat.onfinish = () => {\n\t\t\t\tfloat.pause();\n\t\t\t};\n\t\t\tfloat.pause();\n\t\t\tresult.push(float);\n\n\t\t\treturn result;\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tprivate get totalDuration() {\n\t\treturn this.lyricLine.endTime - this.lyricLine.startTime;\n\t}\n\n\toverride onLineSizeChange(_size: [number, number]) {\n\t\tthis.updateMaskImageSync();\n\t}\n\tupdateMaskImageSync() {\n\t\tfor (const word of this.splittedWords) {\n\t\t\tconst el = word.mainElement;\n\t\t\tif (el) {\n\t\t\t\tword.padding = Number.parseFloat(getComputedStyle(el).paddingLeft);\n\t\t\t\tword.width = el.clientWidth - word.padding * 2;\n\t\t\t\tword.height = el.clientHeight - word.padding * 2;\n\t\t\t} else {\n\t\t\t\tword.width = 0;\n\t\t\t\tword.height = 0;\n\t\t\t\tword.padding = 0;\n\t\t\t}\n\t\t}\n\t\tif (this.lyricPlayer.supportMaskImage) {\n\t\t\tthis.generateWebAnimationBasedMaskImage();\n\t\t} else {\n\t\t\tthis.generateCalcBasedMaskImage();\n\t\t}\n\t\tif (this.isEnabled) {\n\t\t\tthis.enable(this.lyricPlayer.getCurrentTime());\n\t\t}\n\t}\n\n\tprivate generateCalcBasedMaskImage() {\n\t\tfor (const word of this.splittedWords) {\n\t\t\tconst wordEl = word.mainElement;\n\t\t\tif (wordEl) {\n\t\t\t\tword.width = wordEl.clientWidth;\n\t\t\t\tword.height = wordEl.clientHeight;\n\t\t\t\tconst fadeWidth = word.height * this.lyricPlayer.getWordFadeWidth();\n\t\t\t\tconst [maskImage, totalAspect] = generateFadeGradient(\n\t\t\t\t\tfadeWidth / word.width,\n\t\t\t\t);\n\t\t\t\tconst totalAspectStr = `${totalAspect * 100}% 100%`;\n\t\t\t\tif (this.lyricPlayer.supportMaskImage) {\n\t\t\t\t\twordEl.style.maskImage = maskImage;\n\t\t\t\t\twordEl.style.maskRepeat = \"no-repeat\";\n\t\t\t\t\twordEl.style.maskOrigin = \"left\";\n\t\t\t\t\twordEl.style.maskSize = totalAspectStr;\n\t\t\t\t} else {\n\t\t\t\t\twordEl.style.webkitMaskImage = maskImage;\n\t\t\t\t\twordEl.style.webkitMaskRepeat = \"no-repeat\";\n\t\t\t\t\twordEl.style.webkitMaskOrigin = \"left\";\n\t\t\t\t\twordEl.style.webkitMaskSize = totalAspectStr;\n\t\t\t\t}\n\t\t\t\tconst w = word.width + fadeWidth;\n\t\t\t\tconst maskPos = `clamp(${-w}px,calc(${-w}px + (var(--amll-player-time) - ${\n\t\t\t\t\tword.startTime\n\t\t\t\t})*${\n\t\t\t\t\tw / Math.abs(word.endTime - word.startTime)\n\t\t\t\t}px),0px) 0px, left top`;\n\t\t\t\twordEl.style.maskPosition = maskPos;\n\t\t\t\twordEl.style.webkitMaskPosition = maskPos;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate generateWebAnimationBasedMaskImage() {\n\t\t// 因为歌词行有可能比行内单词的结束时间早，有可能导致过渡动画提早停止出现瑕疵\n\t\t// 所以要以单词的结束时间为准\n\t\tconst totalFadeDuration =\n\t\t\tMath.max(\n\t\t\t\tthis.splittedWords.reduce((pv, w) => Math.max(w.endTime, pv), 0),\n\t\t\t\tthis.lyricLine.endTime,\n\t\t\t) - this.lyricLine.startTime;\n\t\tthis.splittedWords.forEach((word, i) => {\n\t\t\tconst wordEl = word.mainElement;\n\t\t\tif (wordEl) {\n\t\t\t\tconst fadeWidth = word.height * this.lyricPlayer.getWordFadeWidth();\n\t\t\t\tconst [maskImage, totalAspect] = generateFadeGradient(\n\t\t\t\t\tfadeWidth / (word.width + word.padding * 2),\n\t\t\t\t);\n\t\t\t\tconst totalAspectStr = `${totalAspect * 100}% 100%`;\n\t\t\t\tif (this.lyricPlayer.supportMaskImage) {\n\t\t\t\t\twordEl.style.maskImage = maskImage;\n\t\t\t\t\twordEl.style.maskRepeat = \"no-repeat\";\n\t\t\t\t\twordEl.style.maskOrigin = \"left\";\n\t\t\t\t\twordEl.style.maskSize = totalAspectStr;\n\t\t\t\t} else {\n\t\t\t\t\twordEl.style.webkitMaskImage = maskImage;\n\t\t\t\t\twordEl.style.webkitMaskRepeat = \"no-repeat\";\n\t\t\t\t\twordEl.style.webkitMaskOrigin = \"left\";\n\t\t\t\t\twordEl.style.webkitMaskSize = totalAspectStr;\n\t\t\t\t}\n\t\t\t\t// 为了尽可能将渐变动画在相连的每个单词间近似衔接起来\n\t\t\t\t// 要综合每个单词的效果时间和间隙生成动画帧数组\n\t\t\t\tconst widthBeforeSelf =\n\t\t\t\t\tthis.splittedWords.slice(0, i).reduce((a, b) => a + b.width, 0) +\n\t\t\t\t\t(this.splittedWords[0] ? fadeWidth : 0);\n\t\t\t\tconst minOffset = -(word.width + word.padding * 2 + fadeWidth);\n\t\t\t\tconst clampOffset = (x: number) => Math.max(minOffset, Math.min(0, x));\n\t\t\t\tlet curPos = -widthBeforeSelf - word.width - word.padding - fadeWidth;\n\t\t\t\tlet timeOffset = 0;\n\t\t\t\tconst frames: Keyframe[] = [];\n\t\t\t\tlet lastPos = curPos;\n\t\t\t\tlet lastTime = 0;\n\t\t\t\tconst pushFrame = () => {\n\t\t\t\t\t// 此处如果添加过渡函数，会导致单词时序不准确，所以不添加\n\t\t\t\t\t// const easing = \"cubic-bezier(.33,.12,.83,.9)\";\n\t\t\t\t\tconst moveOffset = curPos - lastPos;\n\t\t\t\t\tconst time = Math.max(0, Math.min(1, timeOffset));\n\t\t\t\t\tconst duration = time - lastTime;\n\t\t\t\t\tconst d = Math.abs(duration / moveOffset);\n\t\t\t\t\t// 因为有可能会和之前的动画有边界\n\t\t\t\t\tif (curPos > minOffset && lastPos < minOffset) {\n\t\t\t\t\t\tconst staticTime = Math.abs(lastPos - minOffset) * d;\n\t\t\t\t\t\tconst value = `${clampOffset(lastPos)}px 0`;\n\t\t\t\t\t\tconst frame: Keyframe = {\n\t\t\t\t\t\t\toffset: lastTime + staticTime,\n\t\t\t\t\t\t\tmaskPosition: value,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tframes.push(frame);\n\t\t\t\t\t}\n\t\t\t\t\tif (curPos > 0 && lastPos < 0) {\n\t\t\t\t\t\tconst staticTime = Math.abs(lastPos) * d;\n\t\t\t\t\t\tconst value = `${clampOffset(curPos)}px 0`;\n\t\t\t\t\t\tconst frame: Keyframe = {\n\t\t\t\t\t\t\toffset: lastTime + staticTime,\n\t\t\t\t\t\t\tmaskPosition: value,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tframes.push(frame);\n\t\t\t\t\t}\n\t\t\t\t\tconst value = `${clampOffset(curPos)}px 0`;\n\t\t\t\t\tconst frame: Keyframe = {\n\t\t\t\t\t\toffset: time,\n\t\t\t\t\t\tmaskPosition: value,\n\t\t\t\t\t};\n\t\t\t\t\tframes.push(frame);\n\t\t\t\t\tlastPos = curPos;\n\t\t\t\t\tlastTime = time;\n\t\t\t\t};\n\t\t\t\tpushFrame();\n\t\t\t\tlet lastTimeStamp = 0;\n\t\t\t\tthis.splittedWords.forEach((otherWord, j) => {\n\t\t\t\t\t// 停顿\n\t\t\t\t\t{\n\t\t\t\t\t\tconst curTimeStamp = otherWord.startTime - this.lyricLine.startTime;\n\t\t\t\t\t\tconst staticDuration = curTimeStamp - lastTimeStamp;\n\t\t\t\t\t\ttimeOffset += staticDuration / totalFadeDuration;\n\t\t\t\t\t\tif (staticDuration > 0) pushFrame();\n\t\t\t\t\t\tlastTimeStamp = curTimeStamp;\n\t\t\t\t\t}\n\t\t\t\t\t// 移动\n\t\t\t\t\t{\n\t\t\t\t\t\tconst fadeDuration = otherWord.endTime - otherWord.startTime;\n\t\t\t\t\t\ttimeOffset += fadeDuration / totalFadeDuration;\n\t\t\t\t\t\tcurPos += otherWord.width;\n\t\t\t\t\t\tif (j === 0) {\n\t\t\t\t\t\t\tcurPos += fadeWidth * 1.5;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j === this.splittedWords.length - 1) {\n\t\t\t\t\t\t\tcurPos += fadeWidth * 0.5;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (fadeDuration > 0) pushFrame();\n\t\t\t\t\t\tlastTimeStamp += fadeDuration;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tfor (const a of word.maskAnimations) {\n\t\t\t\t\ta.cancel();\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\t// TODO: 如果此处动画帧计算出错，需要一个后备方案\n\t\t\t\t\t// 此处如果添加过渡函数，会导致单词时序不准确，所以不添加\n\t\t\t\t\tconst ani = wordEl.animate(frames, {\n\t\t\t\t\t\tduration: totalFadeDuration || 1,\n\t\t\t\t\t\tid: `fade-word-${word.word}-${i}`,\n\t\t\t\t\t\tfill: \"both\",\n\t\t\t\t\t});\n\t\t\t\t\tani.pause();\n\t\t\t\t\tword.maskAnimations = [ani];\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn(\"应用渐变动画发生错误\", frames, totalFadeDuration, err);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\tgetElement() {\n\t\treturn this.element;\n\t}\n\toverride setTransform(\n\t\ttop: number = this.top,\n\t\tscale: number = this.scale,\n\t\topacity = 1,\n\t\tblur = 0,\n\t\tforce = false,\n\t\tdelay = 0,\n\t) {\n\t\tsuper.setTransform(top, scale, opacity, blur, force, delay);\n\t\tconst beforeInSight = this.isInSight;\n\t\tconst enableSpring = this.lyricPlayer.getEnableSpring();\n\t\tthis.top = top;\n\t\tthis.scale = scale;\n\t\tthis.delay = (delay * 1000) | 0;\n\t\tconst main = this.element.children[0] as HTMLDivElement;\n\t\t// main.style.opacity = `${opacity *\n\t\t// \t(!this.hasFaded ? 1 : this.lyricPlayer._getIsNonDynamic() ? 1 : 0.3)\n\t\t// \t}`;\n\t\tmain.style.opacity = `${opacity}`;\n\t\t// trans.style.opacity = `${subopacity}`;\n\t\t// roman.style.opacity = `${subopacity}`;\n\t\tif (force || !enableSpring) {\n\t\t\tthis.blur = Math.min(32, blur);\n\t\t\t// if (force) this.element.classList.add(styles.tmpDisableTransition);\n\t\t\t// this.lineWebAnimationTransforms.posX.setTargetPosition(left);\n\t\t\t// this.lineWebAnimationTransforms.posY.setTargetPosition(top);\n\t\t\t// this.lineWebAnimationTransforms.scale.setTargetPosition(scale);\n\t\t\tthis.lineTransforms.posY.setPosition(top);\n\t\t\tthis.lineTransforms.scale.setPosition(scale);\n\t\t\tif (!enableSpring) {\n\t\t\t\tconst afterInSight = this.isInSight;\n\t\t\t\tif (beforeInSight || afterInSight) {\n\t\t\t\t\tthis.show();\n\t\t\t\t} else {\n\t\t\t\t\tthis.hide();\n\t\t\t\t}\n\t\t\t} else this.rebuildStyle();\n\t\t\t// if (force)\n\t\t\t// \trequestAnimationFrame(() => {\n\t\t\t// \t\tthis.element.classList.remove(styles.tmpDisableTransition);\n\t\t\t// \t});\n\t\t} else {\n\t\t\t// this.lineWebAnimationTransforms.posX.stop();\n\t\t\t// this.lineWebAnimationTransforms.posY.stop();\n\t\t\t// this.lineWebAnimationTransforms.scale.stop();\n\t\t\tthis.lineTransforms.posY.setTargetPosition(top, delay);\n\t\t\tthis.lineTransforms.scale.setTargetPosition(scale);\n\t\t\tif (this.blur !== Math.min(32, blur)) {\n\t\t\t\tthis.blur = Math.min(32, blur);\n\t\t\t\tconst roundedBlur = blur.toFixed(3);\n\t\t\t\tthis.element.style.filter = `blur(${roundedBlur}px)`;\n\t\t\t}\n\t\t}\n\t}\n\tupdate(delta = 0) {\n\t\tif (!this.lyricPlayer.getEnableSpring()) return;\n\t\tthis.lineTransforms.posY.update(delta);\n\t\tthis.lineTransforms.scale.update(delta);\n\t\tif (this.isInSight) {\n\t\t\tthis.show();\n\t\t} else {\n\t\t\tthis.hide();\n\t\t}\n\t\tif (this.lyricPlayer.getEnableSpring()) {\n\t\t\tthis.element.style.setProperty(\n\t\t\t\t\"--bright-mask-alpha\",\n\t\t\t\t`${\n\t\t\t\t\tMath.max(\n\t\t\t\t\t\t0.0,\n\t\t\t\t\t\tMath.min(\n\t\t\t\t\t\t\t1.0,\n\t\t\t\t\t\t\tthis.lineTransforms.scale.getCurrentPosition() / 100 - 0.97,\n\t\t\t\t\t\t) / 0.03,\n\t\t\t\t\t) *\n\t\t\t\t\t\t0.8 +\n\t\t\t\t\t0.2\n\t\t\t\t}`,\n\t\t\t);\n\t\t\tthis.element.style.setProperty(\n\t\t\t\t\"--dark-mask-alpha\",\n\t\t\t\t`${\n\t\t\t\t\tMath.max(\n\t\t\t\t\t\t0.0,\n\t\t\t\t\t\tMath.min(\n\t\t\t\t\t\t\t1.0,\n\t\t\t\t\t\t\tthis.lineTransforms.scale.getCurrentPosition() / 100 - 0.97,\n\t\t\t\t\t\t) / 0.03,\n\t\t\t\t\t) *\n\t\t\t\t\t\t0.2 +\n\t\t\t\t\t0.2\n\t\t\t\t}`,\n\t\t\t);\n\t\t} else {\n\t\t\tconst computedStyle = window.getComputedStyle(this.element);\n\t\t\tconst transform = computedStyle.transform;\n\n\t\t\t// Extract the scale value from the transform property\n\t\t\tconst scale = getScaleFromTransform(transform);\n\n\t\t\tthis.element.style.setProperty(\n\t\t\t\t\"--bright-mask-alpha\",\n\t\t\t\t`${Math.max(0.0, Math.min(1.0, (scale - 0.97) / 0.03)) * 0.8 + 0.2}`,\n\t\t\t);\n\t\t\tthis.element.style.setProperty(\n\t\t\t\t\"--dark-mask-alpha\",\n\t\t\t\t`${Math.max(0.0, Math.min(1.0, (scale - 0.97) / 0.03)) * 0.2 + 0.2}`,\n\t\t\t);\n\t\t}\n\t}\n\n\t_getDebugTargetPos(): string {\n\t\treturn `[位移: ${this.top}; 缩放: ${this.scale}; 延时: ${this.delay}]`;\n\t}\n\n\tget isInSight() {\n\t\tconst t = this.lineTransforms.posY.getCurrentPosition();\n\t\tconst h = this.lyricPlayer.lyricLinesSize.get(this)?.[1] ?? 0;\n\t\tconst b = t + h;\n\t\tconst pb = this.lyricPlayer.size[1];\n\t\tconst ov = this.lyricPlayer.getOverscanPx();\n\t\treturn !(t > pb + h + ov || b < -h - ov);\n\t}\n\tprivate disposeElements() {\n\t\tfor (const realWord of this.splittedWords) {\n\t\t\tfor (const a of realWord.elementAnimations) {\n\t\t\t\ta.cancel();\n\t\t\t}\n\t\t\tfor (const a of realWord.maskAnimations) {\n\t\t\t\ta.cancel();\n\t\t\t}\n\t\t\tfor (const sub of realWord.subElements) {\n\t\t\t\tsub.remove();\n\t\t\t\tsub.parentNode?.removeChild(sub);\n\t\t\t}\n\t\t\trealWord.elementAnimations = [];\n\t\t\trealWord.maskAnimations = [];\n\t\t\trealWord.subElements = [];\n\t\t\tif (realWord.mainElement?.parentNode) {\n\t\t\t\trealWord.mainElement.parentNode.removeChild(realWord.mainElement);\n\t\t\t}\n\t\t}\n\t\tthis.splittedWords = [];\n\t\tconst main = this.element.children[0] as HTMLDivElement;\n\t\tconst trans = this.element.children[1] as HTMLDivElement;\n\t\tconst roman = this.element.children[2] as HTMLDivElement;\n\t\tif (main) main.innerHTML = \"\";\n\t\tif (trans) trans.innerHTML = \"\";\n\t\tif (roman) roman.innerHTML = \"\";\n\t}\n\toverride dispose(): void {\n\t\tthis.disposeElements();\n\t\tthis.lyricPlayer.resizeObserver.unobserve(this.element);\n\t\tthis.element.remove();\n\t}\n}\n","/**\n * @fileoverview\n * 一个播放歌词的组件\n * @author SteveXMH\n */\n\nimport type { LyricLine } from \"../../interfaces.ts\";\nimport \"../../styles/index.css\";\nimport styles from \"../../styles/lyric-player.module.css\";\nimport { type LyricLineBase, LyricPlayerBase } from \"../base.ts\";\nimport { LyricLineEl, type RawLyricLineMouseEvent } from \"./lyric-line.ts\";\n\n/**\n * 歌词行鼠标相关事件，可以获取到歌词行的索引和歌词行元素\n */\nexport class LyricLineMouseEvent extends MouseEvent {\n\tconstructor(\n\t\t/**\n\t\t * 歌词行索引\n\t\t */\n\t\tpublic readonly lineIndex: number,\n\t\t/**\n\t\t * 歌词行元素\n\t\t */\n\t\tpublic readonly line: LyricLineBase,\n\t\tevent: MouseEvent,\n\t) {\n\t\tsuper(`line-${event.type}`, event);\n\t}\n}\n\nexport type LyricLineMouseEventListener = (evt: LyricLineMouseEvent) => void;\n\n/**\n * 歌词播放组件，本框架的核心组件\n *\n * 尽可能贴切 Apple Music for iPad 的歌词效果设计，且做了力所能及的优化措施\n */\nexport class DomLyricPlayer extends LyricPlayerBase {\n\toverride currentLyricLineObjects: LyricLineEl[] = [];\n\n\toverride onResize(): void {\n\t\tconst computedStyles = getComputedStyle(this.element);\n\t\tthis._baseFontSize = Number.parseFloat(computedStyles.fontSize);\n\t\tthis.rebuildStyle();\n\t}\n\n\treadonly supportPlusLighter = CSS.supports(\"mix-blend-mode\", \"plus-lighter\");\n\treadonly supportMaskImage = CSS.supports(\"mask-image\", \"none\");\n\treadonly innerSize: [number, number] = [0, 0];\n\tprivate readonly onLineClickedHandler = (e: RawLyricLineMouseEvent) => {\n\t\tconst evt = new LyricLineMouseEvent(\n\t\t\tthis.lyricLinesIndexes.get(e.line) ?? -1,\n\t\t\te.line,\n\t\t\te,\n\t\t);\n\t\tif (!this.dispatchEvent(evt)) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\t};\n\t/**\n\t * 是否为非逐词歌词\n\t * @internal\n\t */\n\t_getIsNonDynamic() {\n\t\treturn this.isNonDynamic;\n\t}\n\tprivate _baseFontSize = Number.parseFloat(\n\t\tgetComputedStyle(this.element).fontSize,\n\t);\n\tpublic get baseFontSize() {\n\t\treturn this._baseFontSize;\n\t}\n\tconstructor() {\n\t\tsuper();\n\t\tthis.onResize();\n\t\tthis.element.classList.add(\"amll-lyric-player\", \"dom\");\n\t\tif (this.disableSpring) {\n\t\t\tthis.element.classList.add(styles.disableSpring);\n\t\t}\n\t}\n\n\tprivate rebuildStyle() {\n\t\t// const width = this.innerSize[0];\n\t\t// const height = this.innerSize[1];\n\t\t// this.element.style.setProperty(\"--amll-lp-width\", `${width.toFixed(4)}px`);\n\t\t// this.element.style.setProperty(\n\t\t// \t\"--amll-lp-height\",\n\t\t// \t`${height.toFixed(4)}px`,\n\t\t// );\n\t}\n\n\toverride setWordFadeWidth(value = 0.5) {\n\t\tsuper.setWordFadeWidth(value);\n\t\tfor (const el of this.currentLyricLineObjects) {\n\t\t\tel.updateMaskImageSync();\n\t\t}\n\t}\n\n\t/**\n\t * 设置当前播放歌词，要注意传入后这个数组内的信息不得修改，否则会发生错误\n\t * @param lines 歌词数组\n\t * @param initialTime 初始时间，默认为 0\n\t */\n\toverride setLyricLines(lines: LyricLine[], initialTime = 0) {\n\t\tsuper.setLyricLines(lines, initialTime);\n\t\tif (this.hasDuetLine) {\n\t\t\tthis.element.classList.add(styles.hasDuetLine);\n\t\t} else {\n\t\t\tthis.element.classList.remove(styles.hasDuetLine);\n\t\t}\n\t\tif (!this.supportMaskImage) {\n\t\t\tthis.element.style.setProperty(\"--amll-player-time\", `${initialTime}`);\n\t\t}\n\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.removeMouseEventListener(\"click\", this.onLineClickedHandler);\n\t\t\tline.removeMouseEventListener(\"contextmenu\", this.onLineClickedHandler);\n\t\t\tline.dispose();\n\t\t}\n\n\t\t// 创建新的歌词行元素\n\t\tthis.currentLyricLineObjects = this.processedLines.map((line, i) => {\n\t\t\tconst lineEl = new LyricLineEl(this, line);\n\t\t\tlineEl.addMouseEventListener(\"click\", this.onLineClickedHandler);\n\t\t\tlineEl.addMouseEventListener(\"contextmenu\", this.onLineClickedHandler);\n\t\t\t// 不立即挂载到 DOM，进入视图（含 overscan）后在 LyricLineEl 内部挂载\n\t\t\tthis.lyricLinesIndexes.set(lineEl, i);\n\t\t\t// 仍需建立元素到行对象的映射，供 ResizeObserver 使用\n\t\t\tthis.lyricLineElementMap.set(lineEl.getElement(), lineEl);\n\t\t\treturn lineEl;\n\t\t});\n\n\t\tthis.setLinePosXSpringParams({});\n\t\tthis.setLinePosYSpringParams({});\n\t\tthis.setLineScaleSpringParams({});\n\t\tthis.calcLayout(true);\n\t\t// 触发一次更新以便立即挂载在视区/overscan 内的行元素\n\t\tthis.update(0);\n\t}\n\n\toverride pause() {\n\t\tsuper.pause();\n\t\tthis.element.classList.remove(\"playing\");\n\t\tthis.interludeDots.pause();\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.pause();\n\t\t}\n\t}\n\n\toverride resume() {\n\t\tsuper.resume();\n\t\tthis.element.classList.add(\"playing\");\n\t\tthis.interludeDots.resume();\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.resume();\n\t\t}\n\t}\n\n\toverride update(delta = 0) {\n\t\tif (!this.initialLayoutFinished) return;\n\t\tsuper.update(delta);\n\t\tif (!this.supportMaskImage) {\n\t\t\tthis.element.style.setProperty(\n\t\t\t\t\"--amll-player-time\",\n\t\t\t\t`${this.currentTime}`,\n\t\t\t);\n\t\t}\n\t\tif (!this.isPageVisible) return;\n\t\tconst deltaS = delta / 1000;\n\t\tthis.interludeDots.update(delta);\n\t\tthis.bottomLine.update(deltaS);\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.update(deltaS);\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t\tthis.element.remove();\n\t\tfor (const el of this.currentLyricLineObjects) {\n\t\t\tel.dispose();\n\t\t}\n\t\tthis.bottomLine.dispose();\n\t\tthis.interludeDots.dispose();\n\t}\n}\n","const WHITE_SPACE = /^\\s+/;\nconst LATIN = /^[\\p{L}0-9!\"#$%&’()*+,-./:;<=>?@\\[\\]^_`\\{|\\}~]+/iu;\n\nexport interface TextLayoutResult {\n\ttext: string;\n\tindex: number;\n\tlineIndex: number;\n\twidth: number;\n\theight: number;\n\tx: number;\n}\n\nexport interface TextLayoutConfig {\n\tfontSize: number;\n\tmaxWidth: number;\n\tlineHeight: number;\n\t/**\n\t * 是否统一空格宽度，即不论空白字符有多少个，都只占用一个字符的宽度\n\t */\n\tuniformSpace: boolean;\n}\n\nexport interface TextLayoutFinalState {\n\tx: number;\n\tlineIndex: number;\n}\n\n/**\n * 对指定文本进行布局，返回每个字符的位置信息\n * 目前仅可支持普通拉丁字符和 CJK 字符\n * @param ctx 2D 画板上下文\n * @param text 文本\n * @param config 字体大小\n * @param initialX 初始 X 坐标，对于需要布局多段文本的情况下有所帮助\n */\nexport function* layoutWord(\n\tctx: CanvasRenderingContext2D,\n\ttext: string,\n\tconfig: TextLayoutConfig,\n\tinitialX = 0,\n): Generator<TextLayoutResult, TextLayoutFinalState, void> {\n\tif (import.meta.env.DEV) {\n\t\tif (!ctx) throw new Error(\"ctx is null\");\n\t\tif (!(config.fontSize > 0)) throw new Error(\"fontSize is invalid\");\n\t}\n\n\tlet x = initialX;\n\tlet lineIndex = 0;\n\tlet lastWhitespaceIndex = 0;\n\tlet curLayoutIndex = 0;\n\tlet shouldWhitespace = false;\n\tlet match: RegExpMatchArray | null = null;\n\tconst spaceMetrics = ctx.measureText(\" \");\n\n\twhile (curLayoutIndex < text.length) {\n\t\tconst rest = text.substring(curLayoutIndex);\n\t\tmatch = rest.match(WHITE_SPACE);\n\t\tif (match) {\n\t\t\tshouldWhitespace = true;\n\t\t\tlastWhitespaceIndex = curLayoutIndex;\n\t\t\tcurLayoutIndex += match[0].length;\n\t\t\tcontinue;\n\t\t}\n\t\t// 拉丁文字应尽量保持连续而不在中间换行\n\t\tmatch = rest.match(LATIN);\n\t\tif (match) {\n\t\t\tcurLayoutIndex += match[0].length;\n\t\t\tconst text = match[0];\n\t\t\tconst wholeMetrics = ctx.measureText(text);\n\t\t\tif (x + wholeMetrics.width > config.maxWidth) {\n\t\t\t\t// 在当前行放不下，换行\n\t\t\t\tx = 0;\n\t\t\t\tlineIndex++;\n\t\t\t\tshouldWhitespace = false;\n\t\t\t}\n\t\t\tif (shouldWhitespace) {\n\t\t\t\tshouldWhitespace = false;\n\t\t\t\tyield {\n\t\t\t\t\ttext: \" \",\n\t\t\t\t\tindex: lastWhitespaceIndex,\n\t\t\t\t\tlineIndex,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: config.fontSize,\n\t\t\t\t\tx,\n\t\t\t\t};\n\t\t\t\tx += spaceMetrics.width;\n\t\t\t}\n\t\t\tlet prevChar = \"\";\n\t\t\tlet lastMetrics: TextMetrics | null = null;\n\t\t\tfor (const c of text) {\n\t\t\t\tconst lastMergedMetrics = ctx.measureText(`${prevChar}${c}`);\n\t\t\t\tconst metrics = ctx.measureText(c);\n\t\t\t\tif (prevChar !== \"\") {\n\t\t\t\t\tx = x + lastMergedMetrics.width - metrics.width;\n\t\t\t\t}\n\t\t\t\tif (x + metrics.width > config.maxWidth) {\n\t\t\t\t\tx = 0;\n\t\t\t\t\tlineIndex++;\n\t\t\t\t}\n\t\t\t\tyield {\n\t\t\t\t\ttext: c,\n\t\t\t\t\tindex: curLayoutIndex,\n\t\t\t\t\tlineIndex,\n\t\t\t\t\twidth: metrics.width,\n\t\t\t\t\theight: config.fontSize,\n\t\t\t\t\tx,\n\t\t\t\t};\n\t\t\t\tprevChar = c;\n\t\t\t\tlastMetrics = metrics;\n\t\t\t}\n\t\t\tif (lastMetrics) x += lastMetrics.width;\n\t\t\tcontinue;\n\t\t}\n\t\t// 无需保持连续的字符，直接布局，推进游标\n\t\t{\n\t\t\tif (shouldWhitespace) {\n\t\t\t\tshouldWhitespace = false;\n\t\t\t\tyield {\n\t\t\t\t\ttext: \" \",\n\t\t\t\t\tindex: lastWhitespaceIndex,\n\t\t\t\t\tlineIndex,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: config.fontSize,\n\t\t\t\t\tx,\n\t\t\t\t};\n\t\t\t\tx += spaceMetrics.width;\n\t\t\t}\n\t\t\tconst metrics = ctx.measureText(text[curLayoutIndex]);\n\t\t\tif (x + metrics.width > config.maxWidth) {\n\t\t\t\tx = 0;\n\t\t\t\tlineIndex++;\n\t\t\t}\n\t\t\tyield {\n\t\t\t\ttext: text[curLayoutIndex],\n\t\t\t\tindex: curLayoutIndex,\n\t\t\t\tlineIndex,\n\t\t\t\twidth: metrics.width,\n\t\t\t\theight: config.fontSize,\n\t\t\t\tx,\n\t\t\t};\n\t\t\tx += metrics.width;\n\t\t}\n\n\t\tcurLayoutIndex++;\n\t}\n\n\treturn { x, lineIndex };\n}\n\n/**\n * 对指定文本进行布局，返回每段文字的位置信息\n * 目前仅可支持普通拉丁字符和 CJK 字符\n * @param ctx 2D 画板上下文\n * @param text 文本\n * @param config 字体大小\n * @param initialX 初始 X 坐标，对于需要布局多段文本的情况下有所帮助\n */\nexport function* layoutLine(\n\tctx: CanvasRenderingContext2D,\n\ttext: string,\n\tconfig: TextLayoutConfig,\n\tinitialX = 0,\n): Generator<TextLayoutResult, void, void> {\n\tlet currentLine: TextLayoutResult = {\n\t\ttext: \"\",\n\t\tindex: 0,\n\t\tlineIndex: 0,\n\t\twidth: 0,\n\t\theight: 0,\n\t\tx: 0,\n\t};\n\n\tfor (const word of layoutWord(ctx, text, config, initialX)) {\n\t\tif (word.lineIndex !== currentLine.lineIndex) {\n\t\t\tif (currentLine.text.length) yield currentLine;\n\t\t\tcurrentLine = {\n\t\t\t\t...word,\n\t\t\t};\n\t\t} else {\n\t\t\tcurrentLine.text += word.text;\n\t\t\tcurrentLine.width = word.x + word.width;\n\t\t}\n\t}\n\n\tif (currentLine.text.length) yield currentLine;\n}\n","import type { LyricLine } from \"../../interfaces.ts\";\nimport { chunkAndSplitLyricWords } from \"../../utils/lyric-split-words.ts\";\nimport { LyricLineBase } from \"../base.ts\";\nimport type { CanvasLyricPlayer } from \"./index.ts\";\nimport {\n\ttype TextLayoutConfig,\n\ttype TextLayoutResult,\n\tlayoutLine,\n} from \"./text-layout\";\n\nexport class CanvasLyricLine extends LyricLineBase {\n\tconstructor(\n\t\tprivate player: CanvasLyricPlayer,\n\t\tprivate line: LyricLine = {\n\t\t\twords: [],\n\t\t\ttranslatedLyric: \"\",\n\t\t\tromanLyric: \"\",\n\t\t\tstartTime: 0,\n\t\t\tendTime: 0,\n\t\t\tisBG: false,\n\t\t\tisDuet: false,\n\t\t},\n\t) {\n\t\tsuper();\n\t\tthis.relayout();\n\t}\n\n\toverride getLine(): LyricLine {\n\t\treturn this.line;\n\t}\n\tprivate lineSize: [number, number] = [0, 0];\n\tmeasureSize(): [number, number] {\n\t\tconst maxMainLineIndex = Math.max(\n\t\t\t0,\n\t\t\t...this.layoutWords.flat().map((w) => w.lineIndex + 1),\n\t\t);\n\t\tconst maxTranslatedLineIndex = Math.max(\n\t\t\t0,\n\t\t\t...this.translatedLayoutWords.map((w) => w.lineIndex + 1),\n\t\t);\n\t\tconst maxRomanLineIndex = Math.max(\n\t\t\t0,\n\t\t\t...this.romanLayoutWords.map((w) => w.lineIndex + 1),\n\t\t);\n\t\tconst lineHeight = this.player.baseFontSize;\n\t\tthis.lineSize = [\n\t\t\tthis.player.size[0],\n\t\t\t(maxMainLineIndex + maxTranslatedLineIndex + maxRomanLineIndex) *\n\t\t\t\tlineHeight +\n\t\t\t\tthis.player.size[1] * 0.04,\n\t\t];\n\t\treturn [...this.lineSize];\n\t}\n\n\tprivate layoutWords: TextLayoutResult[][] = [];\n\tprivate translatedLayoutWords: TextLayoutResult[] = [];\n\tprivate romanLayoutWords: TextLayoutResult[] = [];\n\tprivate lineCanvas: HTMLCanvasElement = document.createElement(\"canvas\");\n\t/** @internal */\n\trelayout(): void {\n\t\tconst config: TextLayoutConfig = {\n\t\t\tfontSize: this.player.baseFontSize,\n\t\t\tmaxWidth: this.player.size[0] - 50,\n\t\t\tlineHeight: this.player.baseFontSize,\n\t\t\tuniformSpace: true,\n\t\t};\n\t\tconst ctx = this.player.ctx;\n\t\tthis.player.setFontSize(1);\n\t\tfor (const chunk of chunkAndSplitLyricWords(this.line.words)) {\n\t\t\tif (Array.isArray(chunk)) {\n\t\t\t\tif (chunk.length === 0) continue;\n\t\t\t} else {\n\t\t\t}\n\t\t}\n\t\tthis.layoutWords = [\n\t\t\t[...layoutLine(ctx, this.line.words.map((w) => w.word).join(\"\"), config)],\n\t\t];\n\t\tthis.player.setFontSize(0.5);\n\t\tthis.translatedLayoutWords = [\n\t\t\t...layoutLine(ctx, this.line.translatedLyric, config),\n\t\t];\n\t\tthis.romanLayoutWords = [...layoutLine(ctx, this.line.romanLyric, config)];\n\n\t\t// 在自己的 Canvas 上绘制\n\t\tthis.measureSize();\n\n\t\tthis.lineCanvas.width = this.player.ctx.canvas.width;\n\t\tthis.lineCanvas.height = this.lineSize[1] * devicePixelRatio;\n\n\t\tconst lctx = this.lineCanvas.getContext(\"2d\")!;\n\t\tlctx.globalAlpha = 1;\n\t\tthis.player.setFontSize(1);\n\t\tlctx.font = ctx.font;\n\t\tlctx.scale(devicePixelRatio, devicePixelRatio);\n\t\tlctx.fillStyle = \"white\";\n\t\tlctx.textBaseline = \"top\";\n\t\tlctx.textAlign = \"left\";\n\t\tlctx.font = `${this.player.baseFontSize}px ${this.player.baseFontFamily}`;\n\t\tlet lineIndex = 0;\n\t\tfor (const word of this.layoutWords) {\n\t\t\tfor (const layout of word) {\n\t\t\t\tlctx.fillText(\n\t\t\t\t\tlayout.text,\n\t\t\t\t\tlayout.x,\n\t\t\t\t\tlayout.lineIndex *\n\t\t\t\t\t\tthis.player.baseFontSize *\n\t\t\t\t\t\tthis.player.baseLineHeight,\n\t\t\t\t);\n\t\t\t\tlineIndex = layout.lineIndex;\n\t\t\t}\n\t\t}\n\t\tlctx.translate(0, (lineIndex + 1) * this.player.baseFontSize);\n\t\tthis.player.setFontSize(0.5);\n\t\tlctx.font = ctx.font;\n\t\tlctx.globalAlpha = 0.5;\n\t\tlineIndex = 0;\n\t\tfor (const layout of this.translatedLayoutWords) {\n\t\t\tlctx.fillText(\n\t\t\t\tlayout.text,\n\t\t\t\tlayout.x,\n\t\t\t\tlayout.lineIndex *\n\t\t\t\t\tthis.player.baseFontSize *\n\t\t\t\t\tthis.player.baseLineHeight,\n\t\t\t);\n\t\t\tlineIndex = layout.lineIndex;\n\t\t}\n\t\tlctx.translate(0, (lineIndex + 1) * this.player.baseFontSize);\n\t\tfor (const layout of this.romanLayoutWords) {\n\t\t\tlctx.fillText(\n\t\t\t\tlayout.text,\n\t\t\t\tlayout.x,\n\t\t\t\tlayout.lineIndex *\n\t\t\t\t\tthis.player.baseFontSize *\n\t\t\t\t\tthis.player.baseLineHeight,\n\t\t\t);\n\t\t}\n\t}\n\tprivate enabled = false;\n\toverride enable(): void {\n\t\tthis.enabled = true;\n\t}\n\toverride disable(): void {\n\t\tthis.enabled = false;\n\t}\n\toverride resume(): void {}\n\toverride pause(): void {}\n\toverride setTransform(\n\t\ttop = this.top,\n\t\tscale = this.scale,\n\t\topacity = this.opacity,\n\t\tblur = this.blur,\n\t\tforce = false,\n\t\tdelay = this.delay,\n\t): void {\n\t\tconst targetBlur = Math.min(32, blur);\n\t\t// TODO: 实现模糊效果和不透明度效果的动画化\n\t\tthis.blur = targetBlur;\n\t\tthis.opacity = opacity;\n\t\tif (force) {\n\t\t\tthis.lineTransforms.posY.setPosition(top);\n\t\t\tthis.lineTransforms.scale.setPosition(scale);\n\t\t} else {\n\t\t\tthis.lineTransforms.posY.setTargetPosition(top, delay);\n\t\t\tthis.lineTransforms.scale.setTargetPosition(scale);\n\t\t}\n\t}\n\tget isInSight() {\n\t\tconst t = this.lineTransforms.posY.getCurrentPosition();\n\t\tconst r = this.lineSize[0];\n\t\tconst b = t + this.lineSize[1];\n\t\tconst pb = this.player.size[1];\n\t\treturn !(t > pb || r < 0 || b < 0);\n\t}\n\toverride update(delta?: number): void {\n\t\tthis.lineTransforms.posY.update(delta);\n\t\tthis.lineTransforms.scale.update(delta);\n\t\tif (!this.isInSight) return;\n\t\tconst ctx = this.player.ctx;\n\t\tctx.save();\n\t\tctx.fillStyle = \"white\";\n\t\tctx.filter = `blur(${this.blur}px)`;\n\t\tctx.textRendering = \"geometricPrecision\";\n\t\tctx.globalAlpha = this.opacity;\n\t\tctx.translate(0, this.lineTransforms.posY.getCurrentPosition());\n\t\tctx.scale(1 / devicePixelRatio, 1 / devicePixelRatio);\n\t\tif (this.lineCanvas.width * this.lineCanvas.height > 0)\n\t\t\tctx.drawImage(this.lineCanvas, 0, 0);\n\t\tctx.restore();\n\t}\n}\n","import type { LyricLine } from \"../../interfaces.ts\";\nimport { LyricPlayerBase } from \"../base.ts\";\nimport { CanvasLyricLine } from \"./lyric-line.ts\";\n\nexport class CanvasLyricPlayer extends LyricPlayerBase {\n\tprivate canvasElement = document.createElement(\"canvas\");\n\toverride currentLyricLineObjects: CanvasLyricLine[] = [];\n\t/** @internal */\n\treadonly ctx = this.canvasElement.getContext(\"2d\")!;\n\t/** @internal */\n\tbaseLineHeight = 1;\n\t/** @internal */\n\tbaseFontSize = 30;\n\t/** @internal */\n\tbaseFontFamily = \"sans-serif\";\n\tconstructor() {\n\t\tsuper();\n\t\tthis.element.classList.add(\"amll-lyric-player\", \"dom\");\n\t\tthis.canvasElement.style.width = \"100%\";\n\t\tthis.canvasElement.style.height = \"100%\";\n\t\tthis.canvasElement.style.display = \"block\";\n\t\tthis.canvasElement.style.position = \"absolute\";\n\t\tthis.onResize();\n\t\tthis.update();\n\t\t// TODO: 添加鼠标事件监听\n\t\tthis.element.addEventListener(\"mousemove\", (evt) => {\n\t\t\tevt.preventDefault();\n\t\t});\n\t\tthis.element.addEventListener(\"click\", (evt) => {\n\t\t\tevt.preventDefault();\n\t\t});\n\t\tthis.element.addEventListener(\"contextmenu\", (evt) => {\n\t\t\tevt.preventDefault();\n\t\t});\n\t\tthis.element.appendChild(this.canvasElement);\n\t\tthis.element.appendChild(this.interludeDots.getElement());\n\t\tthis.element.appendChild(this.bottomLine.getElement());\n\t}\n\toverride setLyricLines(lines: LyricLine[], initialTime?: number): void {\n\t\tsuper.setLyricLines(lines, initialTime);\n\n\t\tthis.currentLyricLineObjects = this.processedLines.map(\n\t\t\t(line) => new CanvasLyricLine(this, line),\n\t\t);\n\n\t\tthis.setLinePosYSpringParams({});\n\t\tthis.setLineScaleSpringParams({});\n\t\tthis.calcLayout(true);\n\t}\n\toverride onResize(): void {\n\t\tconst computedStyle = getComputedStyle(this.element);\n\t\tthis.baseFontSize = Number.parseFloat(computedStyle.fontSize) || 30;\n\t\tthis.baseFontFamily = computedStyle.fontFamily;\n\t\tconst realWidth = this.canvasElement.clientWidth;\n\t\tconst realHeight = this.canvasElement.clientHeight;\n\t\tthis.size[0] = realWidth - this.baseFontSize * 2;\n\t\tthis.size[1] = realHeight;\n\t\tthis.canvasElement.width = realWidth * devicePixelRatio;\n\t\tthis.canvasElement.height = realHeight * devicePixelRatio;\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.relayout();\n\t\t}\n\t\tconsole.log(\"CanvasLyricPlayer.onResize\", this.size);\n\t\tthis.calcLayout(true);\n\t}\n\t/**\n\t * @internal\n\t * @param size\n\t */\n\tsetFontSize(emSize: number): void {\n\t\tthis.ctx.font = `${this.baseFontSize * emSize}px ${this.baseFontFamily}`;\n\t}\n\toverride update(delta = 0): void {\n\t\tsuper.update(delta);\n\n\t\tconst ctx = this.ctx;\n\t\tconst width = this.size[0];\n\t\tconst height = this.size[1];\n\t\tctx.resetTransform();\n\t\tctx.scale(devicePixelRatio, devicePixelRatio);\n\t\tctx.clearRect(0, 0, this.canvasElement.width, this.canvasElement.height);\n\t\tctx.fillStyle = \"currentColor\";\n\t\tctx.font = `${this.baseFontSize}px ${this.baseFontFamily}`;\n\t\tctx.textRendering = \"optimizeSpeed\";\n\t\tctx.textAlign = \"left\";\n\n\t\tctx.save();\n\t\tctx.translate(this.baseFontSize, 0);\n\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.update(delta / 1000);\n\t\t}\n\n\t\tctx.restore();\n\n\t\tctx.font = `15px ${this.baseFontFamily}`;\n\t\tctx.fillStyle = \"#FFFFFF55\";\n\t\tctx.textAlign = \"right\";\n\t\tctx.fillText(\"CanvasLyricPlayer 播放器\", width - 16, height - 16);\n\t}\n}\n","// biome-ignore lint/complexity/noBannedTypes: for debounce function\nexport function debounce<T extends Function>(cb: T, wait = 20) {\n\tlet h = 0;\n\t// biome-ignore lint/suspicious/noExplicitAny: function can be any\n\tconst callable = (...args: any) => {\n\t\tclearTimeout(h);\n\t\th = setTimeout(() => cb(...args), wait);\n\t};\n\treturn callable;\n}\n\n// biome-ignore lint/complexity/noBannedTypes: for debounce function\nexport function debounceFrame<T extends Function>(cb: T, frameTime = 1) {\n\tlet h = 0;\n\tlet ft = frameTime;\n\t// biome-ignore lint/suspicious/noExplicitAny: function can be any\n\tconst callable = (...args: any) => {\n\t\tft = frameTime;\n\t\tcancelAnimationFrame(h);\n\t\tconst onCB = () => {\n\t\t\tif (--ft <= 0) {\n\t\t\t\tcb(...args);\n\t\t\t} else {\n\t\t\t\th = requestAnimationFrame(onCB);\n\t\t\t}\n\t\t};\n\t\th = requestAnimationFrame(onCB);\n\t};\n\treturn callable;\n}\n","// 一个异步互斥锁，用于控制并发\n\nexport function mutexifyFunction<\n\tF extends (...args: Args) => Promise<Result>,\n\tArgs extends any[],\n\tResult,\n>(func: F): F {\n\tconst awaitingTasks: {\n\t\tresolve: (value: Result) => void;\n\t\treject: (reason: any) => void;\n\t\targs: Args;\n\t}[] = [];\n\tfunction processNextTask() {\n\t\tconst task = awaitingTasks[0];\n\t\tif (!task) return;\n\t\tfunc(...task.args)\n\t\t\t.then((value) => {\n\t\t\t\ttask.resolve(value);\n\t\t\t})\n\t\t\t.catch((reason) => {\n\t\t\t\ttask.reject(reason);\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tawaitingTasks.shift();\n\t\t\t\tif (awaitingTasks.length > 0) {\n\t\t\t\t\tprocessNextTask();\n\t\t\t\t}\n\t\t\t});\n\t}\n\treturn ((...args: Args) => {\n\t\treturn new Promise<Result>((resolve, reject) => {\n\t\t\tawaitingTasks.push({ resolve, reject, args });\n\t\t\tif (awaitingTasks.length === 1) {\n\t\t\t\tprocessNextTask();\n\t\t\t}\n\t\t});\n\t}) as F;\n}\n\nexport default mutexifyFunction;\n","import bezier from \"bezier-easing\";\nimport type { LyricLine, LyricWord } from \"../../interfaces.ts\";\nimport { chunkAndSplitLyricWords } from \"../../utils/lyric-split-words.ts\";\nimport {\n\tcreateMatrix4,\n\tmatrix4ToCSS,\n\tscaleMatrix4,\n} from \"../../utils/matrix.ts\";\nimport { mutexifyFunction } from \"../../utils/mutex.ts\";\nimport { measure, mutate } from \"../../utils/schedule.ts\";\nimport { LyricLineBase } from \"../base.ts\";\nimport styles from \"./index.module.css\";\nimport type { DomSlimLyricPlayer } from \"./index.ts\";\n\ninterface RealWord extends LyricWord {\n\tmainElement: HTMLSpanElement;\n\tsubElements: HTMLSpanElement[];\n\telementAnimations: Animation[];\n\tmaskAnimations: Animation[];\n\twidth: number;\n\theight: number;\n\tpadding: number;\n\tshouldEmphasize: boolean;\n}\n\nconst ANIMATION_FRAME_QUANTITY = 32;\n\nconst norNum = (min: number, max: number) => (x: number) =>\n\tMath.min(1, Math.max(0, (x - min) / (max - min)));\nconst EMP_EASING_MID = 0.5;\nconst beginNum = norNum(0, EMP_EASING_MID);\nconst endNum = norNum(EMP_EASING_MID, 1);\n\nconst bezIn = bezier(0.2, 0.4, 0.58, 1.0);\nconst bezOut = bezier(0.3, 0.0, 0.58, 1.0);\n\nconst makeEmpEasing = (mid: number) => {\n\treturn (x: number) => (x < mid ? bezIn(beginNum(x)) : 1 - bezOut(endNum(x)));\n};\n\nfunction generateFadeGradient(\n\twidth: number,\n\tpadding = 0,\n\tbright = \"rgba(0,0,0,var(--bright-mask-alpha, 1.0))\",\n\tdark = \"rgba(0,0,0,var(--dark-mask-alpha, 1.0))\",\n): [string, number] {\n\tconst totalAspect = 2 + width + padding;\n\tconst widthInTotal = width / totalAspect;\n\tconst leftPos = (1 - widthInTotal) / 2;\n\treturn [\n\t\t`linear-gradient(to right,${bright} ${leftPos * 100}%,${dark} ${\n\t\t\t(leftPos + widthInTotal) * 100\n\t\t}%)`,\n\t\ttotalAspect,\n\t];\n}\n\nexport class RawLyricLineMouseEvent extends MouseEvent {\n\tconstructor(\n\t\tpublic readonly line: LyricLineEl,\n\t\tevent: MouseEvent,\n\t) {\n\t\tsuper(event.type, event);\n\t}\n}\n\nfunction getScaleFromTransform(transform: string): number {\n\tconst match = transform.match(/matrix\\(([^)]+)\\)/);\n\tif (match) {\n\t\tconst values = match[1].split(\", \");\n\t\tconst scaleX = Number.parseFloat(values[0]);\n\t\tconst scaleY = Number.parseFloat(values[3]);\n\t\treturn (scaleX + scaleY) / 2; // Average of scaleX and scaleY\n\t}\n\treturn 1; // Default scale value if not found\n}\n\ntype MouseEventMap = {\n\t[evt in keyof HTMLElementEventMap]: HTMLElementEventMap[evt] extends MouseEvent\n\t\t? evt\n\t\t: never;\n};\ntype MouseEventTypes = MouseEventMap[keyof MouseEventMap];\ntype MouseEventListener = (\n\tthis: LyricLineEl,\n\tev: RawLyricLineMouseEvent,\n) => void;\n\nexport class LyricLineEl extends LyricLineBase {\n\tprivate element: HTMLElement = document.createElement(\"div\");\n\tprivate splittedWords: RealWord[] = [];\n\t// 由 LyricPlayer 来设置\n\tlineSize: number[] = [0, 0];\n\n\tconstructor(\n\t\tprivate lyricPlayer: DomSlimLyricPlayer,\n\t\tprivate lyricLine: LyricLine = {\n\t\t\twords: [],\n\t\t\ttranslatedLyric: \"\",\n\t\t\tromanLyric: \"\",\n\t\t\tstartTime: 0,\n\t\t\tendTime: 0,\n\t\t\tisBG: false,\n\t\t\tisDuet: false,\n\t\t},\n\t) {\n\t\tsuper();\n\t\tthis._prevParentEl = lyricPlayer.getElement();\n\t\tthis.element.setAttribute(\"class\", styles.lyricLine);\n\t\tif (this.lyricLine.isBG) {\n\t\t\tthis.element.classList.add(styles.lyricBgLine);\n\t\t}\n\t\tif (this.lyricLine.isDuet) {\n\t\t\tthis.element.classList.add(styles.lyricDuetLine);\n\t\t}\n\t\tthis.element.appendChild(document.createElement(\"div\")); // 歌词行\n\t\tthis.element.appendChild(document.createElement(\"div\")); // 翻译行\n\t\tthis.element.appendChild(document.createElement(\"div\")); // 音译行\n\t\tconst main = this.element.children[0] as HTMLDivElement;\n\t\tconst trans = this.element.children[1] as HTMLDivElement;\n\t\tconst roman = this.element.children[2] as HTMLDivElement;\n\t\tmain.setAttribute(\"class\", styles.lyricMainLine);\n\t\ttrans.setAttribute(\"class\", styles.lyricSubLine);\n\t\troman.setAttribute(\"class\", styles.lyricSubLine);\n\t\tthis.rebuildElement();\n\t\tthis.rebuildStyle();\n\t\tthis.markMaskImageDirty(\"Initial construction\");\n\t}\n\tprivate listenersMap = new Map<string, Set<MouseEventListener>>();\n\tprivate readonly onMouseEvent = (e: MouseEvent) => {\n\t\tconst wrapped = new RawLyricLineMouseEvent(this, e);\n\t\tfor (const listener of this.listenersMap.get(e.type) ?? []) {\n\t\t\tlistener.call(this, wrapped);\n\t\t}\n\t\tif (!this.dispatchEvent(wrapped) || wrapped.defaultPrevented) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t\treturn false;\n\t\t}\n\t};\n\n\taddMouseEventListener(\n\t\ttype: MouseEventTypes,\n\t\tcallback: MouseEventListener | null,\n\t\toptions?: boolean | AddEventListenerOptions | undefined,\n\t): void {\n\t\tif (callback) {\n\t\t\tconst listeners = this.listenersMap.get(type) ?? new Set();\n\t\t\tif (listeners.size === 0)\n\t\t\t\tthis.element.addEventListener(type, this.onMouseEvent, options);\n\t\t\tlisteners.add(callback);\n\t\t\tthis.listenersMap.set(type, listeners);\n\t\t}\n\t}\n\n\tremoveMouseEventListener(\n\t\ttype: MouseEventTypes,\n\t\tcallback: MouseEventListener | null,\n\t\toptions?: boolean | EventListenerOptions | undefined,\n\t): void {\n\t\tif (callback) {\n\t\t\tconst listeners = this.listenersMap.get(type);\n\t\t\tif (listeners) {\n\t\t\t\tlisteners.delete(callback);\n\t\t\t\tif (listeners.size === 0)\n\t\t\t\t\tthis.element.removeEventListener(type, this.onMouseEvent, options);\n\t\t\t}\n\t\t}\n\t}\n\n\tareWordsOnSameLine(word1: RealWord, word2: RealWord) {\n\t\tif (word1?.mainElement && word2?.mainElement) {\n\t\t\tconst word1el = word1.mainElement;\n\t\t\tconst word2el = word2.mainElement;\n\n\t\t\tconst rect1 = word1el.getBoundingClientRect();\n\t\t\tconst rect2 = word2el.getBoundingClientRect();\n\n\t\t\t// 检查两个单词的顶部距离是否相等（或者差值很小）\n\t\t\tconst topDifference = Math.abs(rect1.top - rect2.top);\n\n\t\t\t// 如果顶部距离相差很小，可以认为它们在同一行上\n\t\t\treturn topDifference < 10;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate isEnabled = false;\n\tasync enable(maskAnimationTime = this.lyricLine.startTime) {\n\t\tthis.isEnabled = true;\n\t\tthis.element.classList.add(styles.active);\n\t\tawait this.waitMaskImageUpdated();\n\t\tconst main = this.element.children[0] as HTMLDivElement;\n\t\tfor (const word of this.splittedWords) {\n\t\t\tfor (const a of word.elementAnimations) {\n\t\t\t\ta.currentTime = 0;\n\t\t\t\ta.playbackRate = 1;\n\t\t\t\ta.play();\n\t\t\t}\n\t\t\tfor (const a of word.maskAnimations) {\n\t\t\t\ta.currentTime = Math.min(\n\t\t\t\t\tthis.totalDuration,\n\t\t\t\t\tMath.max(0, maskAnimationTime - this.lyricLine.startTime),\n\t\t\t\t);\n\t\t\t\ta.playbackRate = 1;\n\t\t\t\ta.play();\n\t\t\t}\n\t\t}\n\t\tmain.classList.add(styles.active);\n\t}\n\tdisable() {\n\t\tthis.isEnabled = false;\n\t\tthis.element.classList.remove(styles.active);\n\t\tconst main = this.element.children[0] as HTMLDivElement;\n\t\tfor (const word of this.splittedWords) {\n\t\t\tfor (const a of word.elementAnimations) {\n\t\t\t\tif (\n\t\t\t\t\ta.id === \"float-word\" ||\n\t\t\t\t\ta.id.includes(\"emphasize-word-float-only\")\n\t\t\t\t) {\n\t\t\t\t\ta.playbackRate = -1;\n\t\t\t\t\ta.play();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tmain.classList.remove(styles.active);\n\t}\n\tprivate lastWord?: RealWord;\n\tasync resume() {\n\t\tawait this.waitMaskImageUpdated();\n\t\tif (!this.isEnabled) return;\n\t\tfor (const word of this.splittedWords) {\n\t\t\tfor (const a of word.elementAnimations) {\n\t\t\t\tif (\n\t\t\t\t\t!this.lastWord ||\n\t\t\t\t\tthis.splittedWords.indexOf(this.lastWord) <\n\t\t\t\t\t\tthis.splittedWords.indexOf(word)\n\t\t\t\t) {\n\t\t\t\t\ta.play();\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const a of word.maskAnimations) {\n\t\t\t\tif (\n\t\t\t\t\t!this.lastWord ||\n\t\t\t\t\tthis.splittedWords.indexOf(this.lastWord) <\n\t\t\t\t\t\tthis.splittedWords.indexOf(word)\n\t\t\t\t) {\n\t\t\t\t\ta.play();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tasync pause() {\n\t\tawait this.waitMaskImageUpdated();\n\t\tif (!this.isEnabled) return;\n\t\tfor (const word of this.splittedWords) {\n\t\t\tfor (const a of word.elementAnimations) {\n\t\t\t\ta.pause();\n\t\t\t}\n\t\t\tfor (const a of word.maskAnimations) {\n\t\t\t\ta.pause();\n\t\t\t}\n\t\t}\n\t}\n\tsetMaskAnimationState(maskAnimationTime = 0) {\n\t\tconst t = maskAnimationTime - this.lyricLine.startTime;\n\t\tfor (const word of this.splittedWords) {\n\t\t\tfor (const a of word.maskAnimations) {\n\t\t\t\ta.currentTime = Math.min(this.totalDuration, Math.max(0, t));\n\t\t\t\ta.playbackRate = 1;\n\t\t\t\tif (t >= 0 && t < this.totalDuration) a.play();\n\t\t\t\telse a.pause();\n\t\t\t}\n\t\t}\n\t}\n\tprivate measureLockMark = false;\n\tprivate measureLock = mutexifyFunction(\n\t\tasync (callback: () => Promise<void>): Promise<void> => {\n\t\t\tif (this.measureLockMark) return;\n\t\t\tthis.measureLockMark = true;\n\t\t\t// if (this._hide) {\n\t\t\t// \tawait mutate(() => {\n\t\t\t// \t\tthis._prevParentEl.appendChild(this.element);\n\t\t\t// \t\tthis.element.style.display = \"\";\n\t\t\t// \t\tthis.element.style.visibility = \"hidden\";\n\t\t\t// \t});\n\t\t\t// }\n\t\t\tawait callback();\n\t\t\t// if (this._hide) {\n\t\t\t// \tawait mutate(() => {\n\t\t\t// \t\tthis._prevParentEl.removeChild(this.element);\n\t\t\t// \t\tthis.element.style.display = \"none\";\n\t\t\t// \t\tthis.element.style.visibility = \"\";\n\t\t\t// \t});\n\t\t\t// }\n\t\t\tthis.measureLockMark = false;\n\t\t},\n\t);\n\n\tgetLine() {\n\t\treturn this.lyricLine;\n\t}\n\tprivate _prevParentEl: HTMLElement;\n\tprivate lastStyle = \"\";\n\tshow() {\n\t\t// this._hide = false;\n\t\t// if (!this.measureLockMark && !this.element.parentElement) {\n\t\t// \tthis._prevParentEl.appendChild(this.element);\n\t\t// }\n\t\tthis.rebuildStyle();\n\t}\n\thide() {\n\t\t// this._hide = true;\n\t\t// if (!this.measureLockMark && this.element.parentElement) {\n\t\t// \tthis._prevParentEl.removeChild(this.element);\n\t\t// }\n\t}\n\tprivate rebuildStyle() {\n\t\t// let style = \"\";\n\t\t// if (!this.lyricPlayer.getEnableSpring() && this.isInSight) {\n\t\t// \tstyle += `transition-delay:${this.delay}ms;`;\n\t\t// }\n\t\t// style += `filter:blur(${Math.min(32, this.blur)}px);`;\n\t\t// if (style !== this.lastStyle) {\n\t\t// \tthis.lastStyle = style;\n\t\t// \tthis.element.setAttribute(\"style\", style);\n\t\t// }\n\t}\n\trebuildElement() {\n\t\tthis.disposeElements();\n\t\tconst main = this.element.children[0] as HTMLDivElement;\n\t\tconst trans = this.element.children[1] as HTMLDivElement;\n\t\tconst roman = this.element.children[2] as HTMLDivElement;\n\t\t// 如果是非动态歌词，那么就不需要分词了\n\t\tif (this.lyricPlayer._getIsNonDynamic()) {\n\t\t\tmain.innerText = this.lyricLine.words.map((w) => w.word).join(\"\");\n\t\t\ttrans.innerText = this.lyricLine.translatedLyric;\n\t\t\troman.innerText = this.lyricLine.romanLyric;\n\t\t\treturn;\n\t\t}\n\t\tconst chunkedWords = chunkAndSplitLyricWords(this.lyricLine.words);\n\t\tmain.innerHTML = \"\";\n\t\tfor (const chunk of chunkedWords) {\n\t\t\tif (Array.isArray(chunk)) {\n\t\t\t\t// 多个没有空格的单词组合成的一个单词数组\n\t\t\t\tif (chunk.length === 0) continue;\n\t\t\t\tconst merged = chunk.reduce(\n\t\t\t\t\t(a, b) => {\n\t\t\t\t\t\ta.endTime = Math.max(a.endTime, b.endTime);\n\t\t\t\t\t\ta.startTime = Math.min(a.startTime, b.startTime);\n\t\t\t\t\t\ta.word += b.word;\n\t\t\t\t\t\treturn a;\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tword: \"\",\n\t\t\t\t\t\tromanWord: \"\",\n\t\t\t\t\t\tstartTime: Number.POSITIVE_INFINITY,\n\t\t\t\t\t\tendTime: Number.NEGATIVE_INFINITY,\n\t\t\t\t\t\twordType: \"normal\",\n\t\t\t\t\t\tobscene: false,\n\t\t\t\t\t} as LyricWord,\n\t\t\t\t);\n\t\t\t\tconst emp = chunk\n\t\t\t\t\t.map((word) => LyricLineBase.shouldEmphasize(word))\n\t\t\t\t\t.reduce((a, b) => a || b, LyricLineBase.shouldEmphasize(merged));\n\t\t\t\tconst wrapperWordEl = document.createElement(\"span\");\n\t\t\t\twrapperWordEl.classList.add(styles.emphasizeWrapper);\n\t\t\t\tconst characterElements: HTMLElement[] = [];\n\t\t\t\tfor (const word of chunk) {\n\t\t\t\t\tconst mainWordEl = document.createElement(\"span\");\n\t\t\t\t\t// const mainWordFloatAnimation = this.initFloatAnimation(\n\t\t\t\t\t// \tmerged,\n\t\t\t\t\t// \tmainWordEl,\n\t\t\t\t\t// );\n\t\t\t\t\tif (emp) {\n\t\t\t\t\t\tmainWordEl.classList.add(styles.emphasize);\n\t\t\t\t\t\tconst charEls: HTMLSpanElement[] = [];\n\t\t\t\t\t\tfor (const char of word.word.trim()) {\n\t\t\t\t\t\t\tconst charEl = document.createElement(\"span\");\n\t\t\t\t\t\t\tcharEl.innerText = char;\n\t\t\t\t\t\t\tcharEls.push(charEl);\n\t\t\t\t\t\t\tcharacterElements.push(charEl);\n\t\t\t\t\t\t\tmainWordEl.appendChild(charEl);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst realWord: RealWord = {\n\t\t\t\t\t\t\t...word,\n\t\t\t\t\t\t\tmainElement: mainWordEl,\n\t\t\t\t\t\t\tsubElements: charEls,\n\t\t\t\t\t\t\t// elementAnimations: [this.initFloatAnimation(word, mainWordEl)],\n\t\t\t\t\t\t\telementAnimations: [], // this.initFloatAnimation(word, mainWordEl)\n\t\t\t\t\t\t\tmaskAnimations: [],\n\t\t\t\t\t\t\twidth: 0,\n\t\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t\tshouldEmphasize: emp,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.splittedWords.push(realWord);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmainWordEl.innerText = word.word;\n\t\t\t\t\t\tthis.splittedWords.push({\n\t\t\t\t\t\t\t...word,\n\t\t\t\t\t\t\tmainElement: mainWordEl,\n\t\t\t\t\t\t\tsubElements: [],\n\t\t\t\t\t\t\t// elementAnimations: [this.initFloatAnimation(word, mainWordEl)],\n\t\t\t\t\t\t\telementAnimations: [], // this.initFloatAnimation(word, mainWordEl)\n\t\t\t\t\t\t\tmaskAnimations: [],\n\t\t\t\t\t\t\twidth: 0,\n\t\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t\tshouldEmphasize: emp,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\twrapperWordEl.appendChild(mainWordEl);\n\t\t\t\t}\n\t\t\t\tif (emp) {\n\t\t\t\t\tthis.splittedWords[\n\t\t\t\t\t\tthis.splittedWords.length - 1\n\t\t\t\t\t].elementAnimations.push(\n\t\t\t\t\t\t...this.initEmphasizeAnimation(\n\t\t\t\t\t\t\tmerged,\n\t\t\t\t\t\t\tcharacterElements,\n\t\t\t\t\t\t\tmerged.endTime - merged.startTime,\n\t\t\t\t\t\t\tmerged.startTime - this.lyricLine.startTime,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (merged.word.trimStart() !== merged.word) {\n\t\t\t\t\tmain.appendChild(document.createTextNode(\" \"));\n\t\t\t\t}\n\t\t\t\tmain.appendChild(wrapperWordEl);\n\t\t\t\tif (\n\t\t\t\t\tmerged.word.trimEnd() !== merged.word &&\n\t\t\t\t\tLyricLineBase.shouldEmphasize(merged)\n\t\t\t\t) {\n\t\t\t\t\tmain.appendChild(document.createTextNode(\" \"));\n\t\t\t\t}\n\t\t\t} else if (chunk.word.trim().length === 0) {\n\t\t\t\t// 纯空格\n\t\t\t\tmain.appendChild(document.createTextNode(\" \"));\n\t\t\t} else {\n\t\t\t\t// 单个单词\n\t\t\t\tconst emp = LyricLineBase.shouldEmphasize(chunk);\n\t\t\t\tconst mainWordEl = document.createElement(\"span\");\n\t\t\t\tconst realWord: RealWord = {\n\t\t\t\t\t...chunk,\n\t\t\t\t\tmainElement: mainWordEl,\n\t\t\t\t\tsubElements: [],\n\t\t\t\t\t// elementAnimations: [this.initFloatAnimation(chunk, mainWordEl)],\n\t\t\t\t\telementAnimations: [], // this.initFloatAnimation(chunk, mainWordEl)\n\t\t\t\t\tmaskAnimations: [],\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\tshouldEmphasize: emp,\n\t\t\t\t};\n\t\t\t\tif (LyricLineBase.shouldEmphasize(chunk)) {\n\t\t\t\t\tmainWordEl.classList.add(styles.emphasize);\n\t\t\t\t\tconst charEls: HTMLSpanElement[] = [];\n\t\t\t\t\tfor (const char of chunk.word.trim()) {\n\t\t\t\t\t\tconst charEl = document.createElement(\"span\");\n\t\t\t\t\t\tcharEl.innerText = char;\n\t\t\t\t\t\tcharEls.push(charEl);\n\t\t\t\t\t\tmainWordEl.appendChild(charEl);\n\t\t\t\t\t}\n\t\t\t\t\trealWord.subElements = charEls;\n\t\t\t\t\tconst duration = Math.abs(realWord.endTime - realWord.startTime);\n\t\t\t\t\trealWord.elementAnimations.push(\n\t\t\t\t\t\t...this.initEmphasizeAnimation(\n\t\t\t\t\t\t\tchunk,\n\t\t\t\t\t\t\tcharEls,\n\t\t\t\t\t\t\tduration,\n\t\t\t\t\t\t\trealWord.startTime - this.lyricLine.startTime,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t\t// realWord.elementAnimations = this.initEmphasizeAnimation(realWord);\n\t\t\t\t} else {\n\t\t\t\t\tmainWordEl.innerText = chunk.word.trim();\n\t\t\t\t}\n\t\t\t\tif (chunk.word.trimStart() !== chunk.word) {\n\t\t\t\t\tmain.appendChild(document.createTextNode(\" \"));\n\t\t\t\t}\n\t\t\t\tmain.appendChild(mainWordEl);\n\t\t\t\tif (chunk.word.trimEnd() !== chunk.word) {\n\t\t\t\t\tmain.appendChild(document.createTextNode(\" \"));\n\t\t\t\t}\n\t\t\t\tthis.splittedWords.push(realWord);\n\t\t\t}\n\t\t}\n\t\ttrans.innerText = this.lyricLine.translatedLyric;\n\t\troman.innerText = this.lyricLine.romanLyric;\n\t}\n\tprivate initFloatAnimation(word: LyricWord, wordEl: HTMLSpanElement) {\n\t\tconst delay = word.startTime - this.lyricLine.startTime;\n\t\tconst duration = Math.max(1000, word.endTime - word.startTime);\n\t\tlet up = 0.05;\n\t\tif (this.lyricLine.isBG) {\n\t\t\tup *= 2;\n\t\t}\n\t\tconst a = wordEl.animate(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\ttransform: \"translateY(0px)\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttransform: `translateY(${-up}em)`,\n\t\t\t\t},\n\t\t\t],\n\t\t\t{\n\t\t\t\tduration: Number.isFinite(duration) ? duration : 0,\n\t\t\t\tdelay: Number.isFinite(delay) ? delay : 0,\n\t\t\t\tid: \"float-word\",\n\t\t\t\tcomposite: \"add\",\n\t\t\t\tfill: \"both\",\n\t\t\t\teasing: \"ease-out\",\n\t\t\t},\n\t\t);\n\t\ta.pause();\n\t\treturn a;\n\t}\n\t// 按照原 Apple Music 参考，强调效果只应用缩放、轻微左右位移和辉光效果，原主要的悬浮位移效果不变\n\t// 为了避免产生锯齿抖动感，使用 matrix3d 来实现缩放和位移\n\tprivate initEmphasizeAnimation(\n\t\tword: LyricWord,\n\t\tcharacterElements: HTMLElement[],\n\t\tduration: number,\n\t\tdelay: number,\n\t): Animation[] {\n\t\tconst de = Math.max(0, delay);\n\t\tlet du = Math.max(1000, duration);\n\n\t\tlet result: Animation[] = [];\n\n\t\tlet amount = du / 2000;\n\t\tamount = amount > 1 ? Math.sqrt(amount) : amount ** 3;\n\t\tlet blur = du / 3000;\n\t\tblur = blur > 1 ? Math.sqrt(blur) : blur ** 3;\n\t\tamount *= 0.6;\n\t\tblur *= 0.5;\n\t\tif (\n\t\t\tthis.lyricLine.words.length > 0 &&\n\t\t\tword.word.includes(\n\t\t\t\tthis.lyricLine.words[this.lyricLine.words.length - 1].word,\n\t\t\t)\n\t\t) {\n\t\t\tamount *= 1.6;\n\t\t\tblur *= 1.5;\n\t\t\tdu *= 1.2;\n\t\t}\n\t\tamount = Math.min(1.2, amount);\n\t\tblur = Math.min(0.8, blur);\n\n\t\tconst animateDu = Number.isFinite(du) ? du : 0;\n\t\tconst empEasing = makeEmpEasing(EMP_EASING_MID);\n\n\t\tresult = characterElements.flatMap((el, i, arr) => {\n\t\t\tconst wordDe = de + (du / 2.5 / arr.length) * i;\n\t\t\tconst result: Animation[] = [];\n\n\t\t\tconst frames: Keyframe[] = new Array(ANIMATION_FRAME_QUANTITY)\n\t\t\t\t.fill(0)\n\t\t\t\t.map((_, j) => {\n\t\t\t\t\tconst x = (j + 1) / ANIMATION_FRAME_QUANTITY;\n\t\t\t\t\tconst transX = empEasing(x);\n\t\t\t\t\tconst glowLevel = empEasing(x) * blur;\n\n\t\t\t\t\tconst mat = scaleMatrix4(createMatrix4(), 1 + transX * 0.1 * amount);\n\t\t\t\t\tconst offsetX = -transX * 0.03 * amount * (arr.length / 2 - i);\n\t\t\t\t\tconst offsetY = -transX * 0.025 * amount;\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\toffset: x,\n\t\t\t\t\t\ttransform: `${matrix4ToCSS(\n\t\t\t\t\t\t\tmat,\n\t\t\t\t\t\t\t4,\n\t\t\t\t\t\t)} translate(${offsetX}em, ${offsetY}em)`,\n\t\t\t\t\t\ttextShadow: `0 0 ${Math.min(\n\t\t\t\t\t\t\t0.3,\n\t\t\t\t\t\t\tblur * 0.3,\n\t\t\t\t\t\t)}em rgba(255, 255, 255, ${glowLevel})`,\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\tconst glow = el.animate(frames, {\n\t\t\t\tduration: animateDu,\n\t\t\t\tdelay: Number.isFinite(wordDe) ? wordDe : 0,\n\t\t\t\tid: `emphasize-word-${el.innerText}-${i}`,\n\t\t\t\titerations: 1,\n\t\t\t\tcomposite: \"replace\",\n\t\t\t\tfill: \"both\",\n\t\t\t});\n\t\t\tglow.onfinish = () => {\n\t\t\t\tglow.pause();\n\t\t\t};\n\t\t\tglow.pause();\n\t\t\tresult.push(glow);\n\n\t\t\tconst floatFrame: Keyframe[] = new Array(ANIMATION_FRAME_QUANTITY)\n\t\t\t\t.fill(0)\n\t\t\t\t.map((_, j) => {\n\t\t\t\t\tconst x = (j + 1) / ANIMATION_FRAME_QUANTITY;\n\t\t\t\t\tlet y = Math.sin(x * Math.PI);\n\t\t\t\t\t// y = x < 0.5 ? y : Math.max(y, 1.0);\n\t\t\t\t\tif (this.lyricLine.isBG) {\n\t\t\t\t\t\ty *= 2;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\toffset: x,\n\t\t\t\t\t\ttransform: `translateY(${-y * 0.05}em)`,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\tconst float = el.animate(floatFrame, {\n\t\t\t\tduration: animateDu * 1.4,\n\t\t\t\tdelay: Number.isFinite(wordDe) ? wordDe - 400 : 0,\n\t\t\t\tid: \"emphasize-word-float\",\n\t\t\t\titerations: 1,\n\t\t\t\tcomposite: \"add\",\n\t\t\t\tfill: \"both\",\n\t\t\t});\n\t\t\tfloat.onfinish = () => {\n\t\t\t\tfloat.pause();\n\t\t\t};\n\t\t\tfloat.pause();\n\t\t\tresult.push(float);\n\n\t\t\treturn result;\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tprivate get totalDuration() {\n\t\treturn this.lyricLine.endTime - this.lyricLine.startTime;\n\t}\n\tprivate maskImageDirty = false;\n\tprivate markImageDirtyPromiseResolve: Set<() => void> = new Set();\n\tprivate markImageDirtyPromise: Promise<void> = new Promise((resolve) => {\n\t\tthis.markImageDirtyPromiseResolve.add(resolve);\n\t});\n\tmarkMaskImageDirty(_debugReason = \"\"): Promise<void> {\n\t\tthis.maskImageDirty = true;\n\t\tif (!this.element.classList.contains(styles.dirty))\n\t\t\tthis.element.classList.add(styles.dirty);\n\t\t// if (import.meta.env.DEV) {\n\t\t// \tconsole.log(\"Mark mask image dirty: \", _debugReason);\n\t\t// }\n\t\tconst newPromise = Promise.all([\n\t\t\tthis.markImageDirtyPromise,\n\t\t\tnew Promise<void>((resolve) => {\n\t\t\t\tthis.markImageDirtyPromiseResolve.add(resolve);\n\t\t\t}),\n\t\t]).then(() => {});\n\t\tthis.markImageDirtyPromise = newPromise;\n\t\treturn newPromise;\n\t}\n\twaitMaskImageUpdated(): Promise<void> {\n\t\treturn this.markImageDirtyPromise;\n\t}\n\tasync updateMaskImage() {\n\t\tif (\n\t\t\t!this.element.checkVisibility({\n\t\t\t\tcontentVisibilityAuto: true,\n\t\t\t})\n\t\t)\n\t\t\treturn;\n\t\tthis.maskImageDirty = false;\n\t\tawait this.measureLock(async () => {\n\t\t\tawait Promise.all(\n\t\t\t\tthis.splittedWords.map(async (word) => {\n\t\t\t\t\tconst el = word.mainElement;\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tawait measure(() => {\n\t\t\t\t\t\t\tword.padding = Number.parseFloat(\n\t\t\t\t\t\t\t\tgetComputedStyle(el).paddingLeft,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tword.width = el.clientWidth - word.padding * 2;\n\t\t\t\t\t\t\tword.height = el.clientHeight - word.padding * 2;\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tword.width = 0;\n\t\t\t\t\t\tword.height = 0;\n\t\t\t\t\t\tword.padding = 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (word.width * word.height === 0) {\n\t\t\t\t\t\tconsole.warn(\"Word size is zero\");\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tawait mutate(() => {\n\t\t\t\tif (this.lyricPlayer.supportMaskImage) {\n\t\t\t\t\tthis.generateWebAnimationBasedMaskImage();\n\t\t\t\t} else {\n\t\t\t\t\tthis.generateCalcBasedMaskImage();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tfor (const resolve of this.markImageDirtyPromiseResolve) {\n\t\t\tresolve();\n\t\t\tthis.markImageDirtyPromiseResolve.delete(resolve);\n\t\t}\n\t\tawait mutate(() => {\n\t\t\tthis.element.classList.remove(styles.dirty);\n\t\t});\n\t}\n\tprivate generateCalcBasedMaskImage() {\n\t\tfor (const word of this.splittedWords) {\n\t\t\tconst wordEl = word.mainElement;\n\t\t\tif (wordEl) {\n\t\t\t\tword.width = wordEl.clientWidth;\n\t\t\t\tword.height = wordEl.clientHeight;\n\t\t\t\tconst fadeWidth = word.height * this.lyricPlayer.getWordFadeWidth();\n\t\t\t\tconst [maskImage, totalAspect] = generateFadeGradient(\n\t\t\t\t\tfadeWidth / word.width,\n\t\t\t\t);\n\t\t\t\tconst totalAspectStr = `${totalAspect * 100}% 100%`;\n\t\t\t\tif (this.lyricPlayer.supportMaskImage) {\n\t\t\t\t\twordEl.style.maskImage = maskImage;\n\t\t\t\t\twordEl.style.maskRepeat = \"no-repeat\";\n\t\t\t\t\twordEl.style.maskOrigin = \"left\";\n\t\t\t\t\twordEl.style.maskSize = totalAspectStr;\n\t\t\t\t} else {\n\t\t\t\t\twordEl.style.webkitMaskImage = maskImage;\n\t\t\t\t\twordEl.style.webkitMaskRepeat = \"no-repeat\";\n\t\t\t\t\twordEl.style.webkitMaskOrigin = \"left\";\n\t\t\t\t\twordEl.style.webkitMaskSize = totalAspectStr;\n\t\t\t\t}\n\t\t\t\tconst w = word.width + fadeWidth;\n\t\t\t\tconst maskPos = `clamp(${-w}px,calc(${-w}px + (var(--amll-player-time) - ${\n\t\t\t\t\tword.startTime\n\t\t\t\t})*${\n\t\t\t\t\tw / Math.abs(word.endTime - word.startTime)\n\t\t\t\t}px),0px) 0px, left top`;\n\t\t\t\twordEl.style.maskPosition = maskPos;\n\t\t\t\twordEl.style.webkitMaskPosition = maskPos;\n\t\t\t}\n\t\t}\n\t}\n\tprivate generateWebAnimationBasedMaskImage() {\n\t\t// 因为歌词行有可能比行内单词的结束时间早，有可能导致过渡动画提早停止出现瑕疵\n\t\t// 所以要以单词的结束时间为准\n\t\tconst totalFadeDuration =\n\t\t\tMath.max(\n\t\t\t\tthis.splittedWords.reduce((pv, w) => Math.max(w.endTime, pv), 0),\n\t\t\t\tthis.lyricLine.endTime,\n\t\t\t) - this.lyricLine.startTime;\n\t\tthis.splittedWords.forEach((word, i) => {\n\t\t\tconst wordEl = word.mainElement;\n\t\t\tif (wordEl) {\n\t\t\t\tconst fadeWidth = word.height * this.lyricPlayer.getWordFadeWidth();\n\t\t\t\tconst [maskImage, totalAspect] = generateFadeGradient(\n\t\t\t\t\tfadeWidth / (word.width + word.padding * 2),\n\t\t\t\t);\n\t\t\t\tconst totalAspectStr = `${totalAspect * 100}% 100%`;\n\t\t\t\tif (this.lyricPlayer.supportMaskImage) {\n\t\t\t\t\twordEl.style.maskImage = maskImage;\n\t\t\t\t\twordEl.style.maskRepeat = \"no-repeat\";\n\t\t\t\t\twordEl.style.maskOrigin = \"left\";\n\t\t\t\t\twordEl.style.maskSize = totalAspectStr;\n\t\t\t\t} else {\n\t\t\t\t\twordEl.style.webkitMaskImage = maskImage;\n\t\t\t\t\twordEl.style.webkitMaskRepeat = \"no-repeat\";\n\t\t\t\t\twordEl.style.webkitMaskOrigin = \"left\";\n\t\t\t\t\twordEl.style.webkitMaskSize = totalAspectStr;\n\t\t\t\t}\n\t\t\t\t// 为了尽可能将渐变动画在相连的每个单词间近似衔接起来\n\t\t\t\t// 要综合每个单词的效果时间和间隙生成动画帧数组\n\t\t\t\tconst widthBeforeSelf =\n\t\t\t\t\tthis.splittedWords.slice(0, i).reduce((a, b) => a + b.width, 0) +\n\t\t\t\t\t(this.splittedWords[0] ? fadeWidth : 0);\n\t\t\t\tconst minOffset = -(word.width + word.padding * 2 + fadeWidth);\n\t\t\t\tconst clampOffset = (x: number) => Math.max(minOffset, Math.min(0, x));\n\t\t\t\tlet curPos = -widthBeforeSelf - word.width - word.padding - fadeWidth;\n\t\t\t\tlet timeOffset = 0;\n\t\t\t\tconst frames: Keyframe[] = [];\n\t\t\t\tlet lastPos = curPos;\n\t\t\t\tlet lastTime = 0;\n\t\t\t\tconst pushFrame = () => {\n\t\t\t\t\t// 此处如果添加过渡函数，会导致单词时序不准确，所以不添加\n\t\t\t\t\t// const easing = \"cubic-bezier(.33,.12,.83,.9)\";\n\t\t\t\t\tconst moveOffset = curPos - lastPos;\n\t\t\t\t\tconst time = Math.max(0, Math.min(1, timeOffset));\n\t\t\t\t\tconst duration = time - lastTime;\n\t\t\t\t\tconst d = Math.abs(duration / moveOffset);\n\t\t\t\t\t// 因为有可能会和之前的动画有边界\n\t\t\t\t\tif (curPos > minOffset && lastPos < minOffset) {\n\t\t\t\t\t\tconst staticTime = Math.abs(lastPos - minOffset) * d;\n\t\t\t\t\t\tconst value = `${clampOffset(lastPos)}px 0`;\n\t\t\t\t\t\tconst frame: Keyframe = {\n\t\t\t\t\t\t\toffset: lastTime + staticTime,\n\t\t\t\t\t\t\tmaskPosition: value,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tframes.push(frame);\n\t\t\t\t\t}\n\t\t\t\t\tif (curPos > 0 && lastPos < 0) {\n\t\t\t\t\t\tconst staticTime = Math.abs(lastPos) * d;\n\t\t\t\t\t\tconst value = `${clampOffset(curPos)}px 0`;\n\t\t\t\t\t\tconst frame: Keyframe = {\n\t\t\t\t\t\t\toffset: lastTime + staticTime,\n\t\t\t\t\t\t\tmaskPosition: value,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tframes.push(frame);\n\t\t\t\t\t}\n\t\t\t\t\tconst value = `${clampOffset(curPos)}px 0`;\n\t\t\t\t\tconst frame: Keyframe = {\n\t\t\t\t\t\toffset: time,\n\t\t\t\t\t\tmaskPosition: value,\n\t\t\t\t\t};\n\t\t\t\t\tframes.push(frame);\n\t\t\t\t\tlastPos = curPos;\n\t\t\t\t\tlastTime = time;\n\t\t\t\t};\n\t\t\t\tpushFrame();\n\t\t\t\tlet lastTimeStamp = 0;\n\t\t\t\tthis.splittedWords.forEach((otherWord, j) => {\n\t\t\t\t\t// 停顿\n\t\t\t\t\t{\n\t\t\t\t\t\tconst curTimeStamp = otherWord.startTime - this.lyricLine.startTime;\n\t\t\t\t\t\tconst staticDuration = curTimeStamp - lastTimeStamp;\n\t\t\t\t\t\ttimeOffset += staticDuration / totalFadeDuration;\n\t\t\t\t\t\tif (staticDuration > 0) pushFrame();\n\t\t\t\t\t\tlastTimeStamp = curTimeStamp;\n\t\t\t\t\t}\n\t\t\t\t\t// 移动\n\t\t\t\t\t{\n\t\t\t\t\t\tconst fadeDuration = otherWord.endTime - otherWord.startTime;\n\t\t\t\t\t\ttimeOffset += fadeDuration / totalFadeDuration;\n\t\t\t\t\t\tcurPos += otherWord.width;\n\t\t\t\t\t\tif (j === 0) {\n\t\t\t\t\t\t\tcurPos += fadeWidth * 1.5;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j === this.splittedWords.length - 1) {\n\t\t\t\t\t\t\tcurPos += fadeWidth * 0.5;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (fadeDuration > 0) pushFrame();\n\t\t\t\t\t\tlastTimeStamp += fadeDuration;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tfor (const a of word.maskAnimations) {\n\t\t\t\t\ta.cancel();\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\t// TODO: 如果此处动画帧计算出错，需要一个后备方案\n\t\t\t\t\t// 此处如果添加过渡函数，会导致单词时序不准确，所以不添加\n\t\t\t\t\tconst ani = wordEl.animate(frames, {\n\t\t\t\t\t\tduration: totalFadeDuration || 1,\n\t\t\t\t\t\tid: `fade-word-${word.word}-${i}`,\n\t\t\t\t\t\tfill: \"both\",\n\t\t\t\t\t});\n\t\t\t\t\tani.pause();\n\t\t\t\t\tword.maskAnimations = [ani];\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.warn(\"应用渐变动画发生错误\", frames, totalFadeDuration, err);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\tgetElement() {\n\t\treturn this.element;\n\t}\n\toverride setTransform(\n\t\ttop: number = this.top,\n\t\tscale: number = this.scale,\n\t\topacity = 1,\n\t\tblur = 0,\n\t\tforce = false,\n\t\tdelay = 0,\n\t) {\n\t\tsuper.setTransform(top, scale, opacity, blur, force, delay);\n\t\tconst beforeInSight = this.isInSight;\n\t\tconst enableSpring = this.lyricPlayer.getEnableSpring();\n\t\tthis.top = top;\n\t\tthis.scale = scale;\n\t\tthis.delay = (delay * 1000) | 0;\n\t\tconst main = this.element.children[0] as HTMLDivElement;\n\t\t// main.style.opacity = `${opacity *\n\t\t// \t(!this.hasFaded ? 1 : this.lyricPlayer._getIsNonDynamic() ? 1 : 0.3)\n\t\t// \t}`;\n\t\tmain.style.opacity = `${opacity}`;\n\t\t// trans.style.opacity = `${subopacity}`;\n\t\t// roman.style.opacity = `${subopacity}`;\n\t\tif (force || !enableSpring) {\n\t\t\tif (force) this.element.classList.add(styles.tmpDisableTransition);\n\t\t\t// this.lineWebAnimationTransforms.posX.setTargetPosition(left);\n\t\t\t// this.lineWebAnimationTransforms.posY.setTargetPosition(top);\n\t\t\t// this.lineWebAnimationTransforms.scale.setTargetPosition(scale);\n\t\t\tthis.lineTransforms.posY.setPosition(top);\n\t\t\tthis.lineTransforms.scale.setPosition(scale);\n\t\t\tif (!enableSpring) {\n\t\t\t\tconst afterInSight = this.isInSight;\n\t\t\t\tif (beforeInSight || afterInSight) {\n\t\t\t\t\tthis.show();\n\t\t\t\t} else {\n\t\t\t\t\tthis.hide();\n\t\t\t\t}\n\t\t\t} else this.rebuildStyle();\n\t\t\tif (force)\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tthis.element.classList.remove(styles.tmpDisableTransition);\n\t\t\t\t});\n\t\t} else {\n\t\t\t// this.lineWebAnimationTransforms.posX.stop();\n\t\t\t// this.lineWebAnimationTransforms.posY.stop();\n\t\t\t// this.lineWebAnimationTransforms.scale.stop();\n\t\t\tthis.lineTransforms.posY.setTargetPosition(top, delay);\n\t\t\tthis.lineTransforms.scale.setTargetPosition(scale);\n\t\t}\n\t}\n\tupdate(delta = 0) {\n\t\tif (!this.lyricPlayer.getEnableSpring()) return;\n\t\tthis.lineTransforms.posY.update(delta);\n\t\tthis.lineTransforms.scale.update(delta);\n\t\tif (this.isInSight) {\n\t\t\tthis.show();\n\t\t\tif (this.maskImageDirty) {\n\t\t\t\tthis.updateMaskImage();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.hide();\n\t\t}\n\t\tif (this.lyricPlayer.getEnableSpring()) {\n\t\t\tthis.element.style.setProperty(\n\t\t\t\t\"--bright-mask-alpha\",\n\t\t\t\t`${\n\t\t\t\t\tMath.max(\n\t\t\t\t\t\t0.0,\n\t\t\t\t\t\tMath.min(\n\t\t\t\t\t\t\t1.0,\n\t\t\t\t\t\t\tthis.lineTransforms.scale.getCurrentPosition() / 100 - 0.97,\n\t\t\t\t\t\t) / 0.03,\n\t\t\t\t\t) *\n\t\t\t\t\t\t0.8 +\n\t\t\t\t\t0.2\n\t\t\t\t}`,\n\t\t\t);\n\t\t\tthis.element.style.setProperty(\n\t\t\t\t\"--dark-mask-alpha\",\n\t\t\t\t`${\n\t\t\t\t\tMath.max(\n\t\t\t\t\t\t0.0,\n\t\t\t\t\t\tMath.min(\n\t\t\t\t\t\t\t1.0,\n\t\t\t\t\t\t\tthis.lineTransforms.scale.getCurrentPosition() / 100 - 0.97,\n\t\t\t\t\t\t) / 0.03,\n\t\t\t\t\t) *\n\t\t\t\t\t\t0.2 +\n\t\t\t\t\t0.2\n\t\t\t\t}`,\n\t\t\t);\n\t\t} else {\n\t\t\tconst computedStyle = window.getComputedStyle(this.element);\n\t\t\tconst transform = computedStyle.transform;\n\n\t\t\t// Extract the scale value from the transform property\n\t\t\tconst scale = getScaleFromTransform(transform);\n\n\t\t\tthis.element.style.setProperty(\n\t\t\t\t\"--bright-mask-alpha\",\n\t\t\t\t`${Math.max(0.0, Math.min(1.0, (scale - 0.97) / 0.03)) * 0.8 + 0.2}`,\n\t\t\t);\n\t\t\tthis.element.style.setProperty(\n\t\t\t\t\"--dark-mask-alpha\",\n\t\t\t\t`${Math.max(0.0, Math.min(1.0, (scale - 0.97) / 0.03)) * 0.2 + 0.2}`,\n\t\t\t);\n\t\t}\n\t}\n\n\t_getDebugTargetPos(): string {\n\t\treturn `[位移: ${this.top}; 缩放: ${this.scale}; 延时: ${this.delay}]`;\n\t}\n\n\tget isInSight() {\n\t\tconst t = this.lineTransforms.posY.getCurrentPosition();\n\t\tconst h = this.lineSize[1];\n\t\tconst b = t + h;\n\t\tconst pb = this.lyricPlayer.size[1];\n\t\treturn !(t > pb + h || b < -h);\n\t}\n\tprivate disposeElements() {\n\t\tfor (const realWord of this.splittedWords) {\n\t\t\tfor (const a of realWord.elementAnimations) {\n\t\t\t\ta.cancel();\n\t\t\t}\n\t\t\tfor (const a of realWord.maskAnimations) {\n\t\t\t\ta.cancel();\n\t\t\t}\n\t\t\tfor (const sub of realWord.subElements) {\n\t\t\t\tsub.remove();\n\t\t\t\tsub.parentNode?.removeChild(sub);\n\t\t\t}\n\t\t\trealWord.elementAnimations = [];\n\t\t\trealWord.maskAnimations = [];\n\t\t\trealWord.subElements = [];\n\t\t\trealWord.mainElement.remove();\n\t\t\trealWord.mainElement.parentNode?.removeChild(realWord.mainElement);\n\t\t}\n\t\tthis.splittedWords = [];\n\t}\n\toverride dispose(): void {\n\t\tthis.disposeElements();\n\t\tthis.element.remove();\n\t}\n}\n","/**\n * @fileoverview\n * 一个播放歌词的组件，但是进行了部分效果的阉割精简，以尝试改善在低性能设备上的性能问题\n * @author SteveXMH\n */\n\nimport type { LyricLine } from \"../../interfaces.ts\";\nimport \"../../styles/index.css\";\nimport { debounce } from \"../../utils/debounce.ts\";\nimport { LyricPlayerBase } from \"../base.ts\";\nimport { LyricLineMouseEvent } from \"../dom/index.ts\";\nimport styles from \"./index.module.css\";\nimport { LyricLineEl, type RawLyricLineMouseEvent } from \"./lyric-line.ts\";\n\n/**\n * 歌词播放组件，本框架的核心组件\n *\n * 尽可能贴切 Apple Music for iPad 的歌词效果设计，且做了力所能及的优化措施\n */\nexport class DomSlimLyricPlayer extends LyricPlayerBase {\n\toverride currentLyricLineObjects: LyricLineEl[] = [];\n\n\tprivate debounceCalcLayout = debounce(\n\t\t() =>\n\t\t\tthis.calcLayout(true).then(() =>\n\t\t\t\tthis.currentLyricLineObjects.map(async (el, i) => {\n\t\t\t\t\tel.markMaskImageDirty(\"DomLyricPlayer onResize\");\n\t\t\t\t\tawait el.waitMaskImageUpdated();\n\t\t\t\t\tif (this.hotLines.has(i)) {\n\t\t\t\t\t\tel.enable(this.currentTime);\n\t\t\t\t\t\tel.resume();\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t),\n\t\t1000,\n\t);\n\n\toverride onResize(): void {\n\t\tconst computedStyles = getComputedStyle(this.element);\n\t\tthis._baseFontSize = Number.parseFloat(computedStyles.fontSize);\n\t\tconst innerWidth =\n\t\t\tthis.element.clientWidth -\n\t\t\tNumber.parseFloat(computedStyles.paddingLeft) -\n\t\t\tNumber.parseFloat(computedStyles.paddingRight);\n\t\tconst innerHeight =\n\t\t\tthis.element.clientHeight -\n\t\t\tNumber.parseFloat(computedStyles.paddingTop) -\n\t\t\tNumber.parseFloat(computedStyles.paddingBottom);\n\t\tthis.innerSize[0] = innerWidth;\n\t\tthis.innerSize[1] = innerHeight;\n\t\tthis.rebuildStyle();\n\t\t// for (const obj of this.currentLyricLineObjects) {\n\t\t// \tif (!obj.getElement().classList.contains(styles.dirty))\n\t\t// \t\tobj.getElement().classList.add(styles.dirty);\n\t\t// }\n\t\tthis.debounceCalcLayout();\n\t}\n\n\treadonly supportPlusLighter = CSS.supports(\"mix-blend-mode\", \"plus-lighter\");\n\treadonly supportMaskImage = CSS.supports(\"mask-image\", \"none\");\n\treadonly innerSize: [number, number] = [0, 0];\n\tprivate readonly onLineClickedHandler = (e: RawLyricLineMouseEvent) => {\n\t\tconst evt = new LyricLineMouseEvent(\n\t\t\tthis.lyricLinesIndexes.get(e.line) ?? -1,\n\t\t\te.line,\n\t\t\te,\n\t\t);\n\t\tif (!this.dispatchEvent(evt)) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\t};\n\t/**\n\t * 是否为非逐词歌词\n\t * @internal\n\t */\n\t_getIsNonDynamic() {\n\t\treturn this.isNonDynamic;\n\t}\n\tprivate _baseFontSize = Number.parseFloat(\n\t\tgetComputedStyle(this.element).fontSize,\n\t);\n\tpublic get baseFontSize() {\n\t\treturn this._baseFontSize;\n\t}\n\tconstructor() {\n\t\tsuper();\n\t\tthis.onResize();\n\t\tthis.element.classList.add(\"amll-lyric-player\", \"dom-slim\");\n\t\tif (this.disableSpring) {\n\t\t\tthis.element.classList.add(styles.disableSpring);\n\t\t}\n\t}\n\n\tprivate rebuildStyle() {\n\t\tconst width = this.innerSize[0];\n\t\tconst height = this.innerSize[1];\n\t\tthis.element.style.setProperty(\"--amll-lp-width\", `${width.toFixed(4)}px`);\n\t\tthis.element.style.setProperty(\n\t\t\t\"--amll-lp-height\",\n\t\t\t`${height.toFixed(4)}px`,\n\t\t);\n\t}\n\n\toverride setWordFadeWidth(value = 0.5) {\n\t\tsuper.setWordFadeWidth(value);\n\t\tfor (const el of this.currentLyricLineObjects) {\n\t\t\tel.markMaskImageDirty(\"DomLyricPlayer setWordFadeWidth\");\n\t\t}\n\t}\n\n\t/**\n\t * 设置当前播放歌词，要注意传入后这个数组内的信息不得修改，否则会发生错误\n\t * @param lines 歌词数组\n\t * @param initialTime 初始时间，默认为 0\n\t */\n\toverride setLyricLines(lines: LyricLine[], initialTime = 0) {\n\t\tsuper.setLyricLines(lines, initialTime);\n\t\tif (this.hasDuetLine) {\n\t\t\tthis.element.classList.add(styles.hasDuetLine);\n\t\t} else {\n\t\t\tthis.element.classList.remove(styles.hasDuetLine);\n\t\t}\n\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.removeMouseEventListener(\"click\", this.onLineClickedHandler);\n\t\t\tline.removeMouseEventListener(\"contextmenu\", this.onLineClickedHandler);\n\t\t\tline.dispose();\n\t\t}\n\n\t\t// 创建新的歌词行元素\n\t\tthis.currentLyricLineObjects = this.processedLines.map((line, i) => {\n\t\t\tconst lineEl = new LyricLineEl(this, line);\n\t\t\tlineEl.addMouseEventListener(\"click\", this.onLineClickedHandler);\n\t\t\tlineEl.addMouseEventListener(\"contextmenu\", this.onLineClickedHandler);\n\t\t\tthis.element.appendChild(lineEl.getElement());\n\t\t\tthis.lyricLinesIndexes.set(lineEl, i);\n\t\t\tlineEl.markMaskImageDirty(\"DomLyricPlayer setLyricLines\");\n\t\t\treturn lineEl;\n\t\t});\n\n\t\tthis.setLinePosXSpringParams({});\n\t\tthis.setLinePosYSpringParams({});\n\t\tthis.setLineScaleSpringParams({});\n\t\tthis.calcLayout(true).then(() => {\n\t\t\tthis.initialLayoutFinished = true;\n\t\t});\n\t}\n\n\toverride pause() {\n\t\tsuper.pause();\n\t\tthis.interludeDots.pause();\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.pause();\n\t\t}\n\t}\n\n\toverride resume() {\n\t\tsuper.resume();\n\t\tthis.interludeDots.resume();\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.resume();\n\t\t}\n\t}\n\n\toverride update(delta = 0) {\n\t\tif (!this.initialLayoutFinished) return;\n\t\tsuper.update(delta);\n\t\tif (!this.isPageVisible) return;\n\t\tconst deltaS = delta / 1000;\n\t\tthis.interludeDots.update(delta);\n\t\tthis.bottomLine.update(deltaS);\n\t\tfor (const line of this.currentLyricLineObjects) {\n\t\t\tline.update(deltaS);\n\t\t}\n\t}\n\n\toverride async calcLayout(sync?: boolean): Promise<void> {\n\t\tawait super.calcLayout(sync);\n\t\tconst curLine = this.currentLyricLineObjects[this.targetAlignIndex];\n\t\tconst curLineEl = curLine.getElement();\n\t\tconst curLineVisibility = curLineEl.checkVisibility({\n\t\t\tcontentVisibilityAuto: true,\n\t\t});\n\t\tconst playerTop = this.element.getBoundingClientRect().top;\n\t\tif (!curLineVisibility) {\n\t\t\tcurLineEl.scrollIntoView({\n\t\t\t\tblock: \"center\",\n\t\t\t\tbehavior: \"instant\",\n\t\t\t});\n\t\t}\n\t\tconst curLineHeight = curLineEl.clientHeight;\n\t\tconst curLineRect = curLineEl.getBoundingClientRect();\n\t\tlet scrollToPos =\n\t\t\tcurLineRect.top - playerTop - this.size[1] * this.alignPosition;\n\t\tif (curLine) {\n\t\t\tswitch (this.alignAnchor) {\n\t\t\t\tcase \"bottom\":\n\t\t\t\t\tscrollToPos += curLineHeight;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"center\":\n\t\t\t\t\tscrollToPos += curLineHeight / 2;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"top\":\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.element.scrollBy({\n\t\t\ttop: scrollToPos,\n\t\t\tbehavior: \"smooth\",\n\t\t});\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t\tthis.element.remove();\n\t\tfor (const el of this.currentLyricLineObjects) {\n\t\t\tel.dispose();\n\t\t}\n\t\tthis.bottomLine.dispose();\n\t\tthis.interludeDots.dispose();\n\t}\n}\n"],"names":["AbstractBaseRenderer","BaseRenderer","canvas","width","height","scale","speed","EPSILON","IDENTITY_4X4","Mat4","values","v","a","b","rad","axis","fovy","aspect","near","far","left","right","bottom","top","out","a01","a02","a03","a12","a13","a23","a00","a10","a11","a20","a21","a22","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","x","y","z","len","s","t","b12","b20","b21","b22","c","q","w","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","bx","by","bz","bw","ax","ay","az","aw","magnitude","tmpVec3","cx","cy","cz","mat","m11","m12","m13","m21","m22","m23","m31","m32","m33","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","S","out_r","out_t","out_s","sx","sy","sz","o","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","yx","zx","zy","rl","tb","nf","f","fov","upTan","downTan","leftTan","rightTan","xScale","yScale","lr","bt","eye","center","up","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","z0","z1","x0","x1","y0","y1","target","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","a14","a15","b13","b14","b15","Vec3","value","angle","sinTotal","ratioA","ratioB","d","factorTimes2","factor1","factor2","factor3","factor4","inverseFactor","inverseFactorTimesTwo","m","qx","qy","qz","w2","uvx","uvy","uvz","uuvx","uuvy","uuvz","py","pz","px","mag","cosine","Vec4","u","e","g","h","i","j","qw","ix","iy","iz","iw","Vec2","p0","p1","sinC","cosC","loadImage","imageUrl","resolve","reject","img","loadVideo","videoUrl","video","playing","timeupdate","rejected","checkReady","err","loadResourceFromUrl","url","isVideo","loadResourceFromElement","element","blurImage","imageData","radius","quality","pixels","rsum","gsum","bsum","asum","p","p2","yp","yi","yw","wm","hm","rad1x","divx","rad1y","divy","div2","r","vmin","vmax","saturateImage","saturation","gray","brightnessImage","brightness","contrastImage","contrast","ur","vr","vp","preset","conf","CONTROL_POINT_PRESETS","randomRange","min","max","clamp","smoothstep","edge0","edge1","smoothifyControlPoints","iterations","factor","factorIterationModifier","grid","kernel","kernelSum","iter","newGrid","sumX","sumY","sumUR","sumVR","sumUP","sumVP","dj","di","weight","nb","avgX","avgY","avgUR","avgVR","avgUP","avgVP","cur","newX","newY","newUR","newVR","newUP","newVP","noise","fract","smoothNoise","xf","yf","n00","n10","n01","n11","nx0","nx1","computeNoiseGradient","perlinFn","epsilon","n1","n2","n3","n4","dx","dy","generateControlPoints","variationFraction","normalOffset","blendFactor","smoothIters","smoothFactor","smoothModifier","baseX","baseY","isBorder","pertX","pertY","uNorm","vNorm","nx","ny","offsetX","offsetY","distToBorder","meshFragShader","meshVertShader","GLProgram","gl","vertexShaderSource","fragmentShaderSource","label","num","attrs","info","location","type","source","shader","program","errLog","name","value1","value2","Mesh","attrPos","attrColor","attrUV","vertexBuf","indexBuf","enable","vx","vy","idx","data","vertexWidth","vertexHeight","vertexData","indexData","ControlPoint","H","H_T","spUx","spUy","spV","spxAcc","spyAcc","surfacePoint","X","Y","output","meshCoefficients","p00","p01","p10","p11","l","colorCoefficients","cpUx","cpUy","cpUz","cpV","cprAcc","cpgAcc","cpbAcc","cpResult","colorPoint","R","G","B","Map2D","BHPMesh","subDivisions","point","subDivM1","tW","tH","controlPointsWidth","controlPointsHeight","invSubDivM1","invTH","invTW","sX","sY","baseVx","baseVy","vxOffset","pr","pg","pb","uvX","uvY","GLTexture","albumImageData","albumTexture","createOffscreenCanvas","MeshGradientRenderer","state","tickTime","delta","frameDelta","cW","cH","latestMeshState","canBeStatic","deltaFactor","hasActiveStates","deleted","lerpFactor","fps","albumSource","res","remainRetryTimes","error","ctx","imgw","imgh","newMesh","chosenPreset","uPower","vPower","cp","newState","volume","_hasLyric","TimedContainer","Container","PixiRenderer","Application","lastContainer","s1","s2","s3","s4","maxSize","minBorder","maxBorder","c0","ColorMatrixFilter","c1","c2","filter","BlurFilter","BulgePinchFilter","_volume","tex","Texture","container","Sprite","BackgroundRender","renderer","newCanvas","hasLyric","VOID","PRIMITIVE","ARRAY","OBJECT","DATE","REGEXP","MAP","SET","ERROR","BIGINT","env","deserializer","$","_","as","index","unpair","arr","object","key","flags","map","set","message","buffer","deserialize","serialized","EMPTY","toString","keys","typeOf","asString","shouldSkip","TYPE","serializer","strict","json","pair","entry","spread","entries","serialize","lossy","structuredClone$1","any","options","eqSet","xs","ys","isCJK","char","derivative","getVelocity","Spring","currentPosition","curV","solveSpring","targetPosition","params","delay","from","velocity","to","soft","stiffness","damping","mass","angular_frequency","leftover","damping_frequency","dfm","dm","measureTasks","mutateTasks","scheduled","onFlush","tmp","scheduleFlush","measure","callback","task","promise","mutate","BottomLineEl","lyricPlayer","styles","style","force","easeInOutBack","easeOutExpo","InterludeDots","interlude","curStyle","interludeDuration","currentDuration","breatheDuration","globalOpacity","dotsDuration","dot0Opacity","dot1Opacity","dot2Opacity","LyricPlayerBase","shouldRelayout","shouldRebuildPlayerStyle","rect","newSize","oldSize","lineObj","startScrollY","direction","startTouchPosY","startScrollTime","scrollSpeed","scrollId","lastMoveY","lastDragTime","evt","touchScreenY","lastDelta","targetDirection","curTime","scrollDuration","lt","curScrollId","onScrollFrame","dt","allowed","isSeeking","hide","alignAnchor","alignPosition","currentTime","lines","initialTime","line","word","structuredClone","prevLine","nextLine","bgStartTime","bgEndTime","startTime","endTime","time","isSeek","removedHotIds","removedIds","addedIds","lastHotId","nextMainLine","id","sync","curPos","targetAlignIndex","LINE_HEIGHT_FALLBACK","scrollOffset","acc","el","curLine","lineHeight","latestIndex","baseDelay","setDots","hasBuffered","isActive","targetOpacity","blurLevel","SCALE_ASPECT","targetScale","_params","LyricLineBase","_size","opacity","blur","_force","NEWTON_ITERATIONS","NEWTON_MIN_SLOPE","SUBDIVISION_PRECISION","SUBDIVISION_MAX_ITERATIONS","kSplineTableSize","kSampleStepSize","float32ArraySupported","A","aA1","aA2","C","calcBezier","aT","getSlope","binarySubdivide","aX","aA","aB","mX1","mX2","currentX","currentT","newtonRaphsonIterate","aGuessT","currentSlope","LinearEasing","src","mY1","mY2","sampleValues","getTForX","intervalStart","currentSample","lastSample","dist","guessForT","initialSlope","CJKEXP","chunkAndSplitLyricWords","words","resplitedWords","realLength","splited","charPos","wordChunk","wChunk","result","createMatrix4","scaleMatrix4","origin","matrix4ToCSS","fractionDigits","format","n","ANIMATION_FRAME_QUANTITY","norNum","EMP_EASING_MID","beginNum","endNum","bezIn","bezier","bezOut","makeEmpEasing","mid","generateFadeGradient","padding","bright","dark","totalAspect","widthInTotal","leftPos","event","getScaleFromTransform","transform","match","scaleX","scaleY","lyricLine","main","trans","roman","wrapped","RawLyricLineMouseEvent","listener","listeners","word1","word2","word1el","word2el","rect1","rect2","maskAnimationTime","chunkedWords","chunk","merged","emp","wrapperWordEl","characterElements","mainWordEl","charEls","charEl","realWord","wordEl","romanWordEl","duration","de","du","amount","animateDu","empEasing","wordDe","frames","transX","glowLevel","glow","floatFrame","float","fadeWidth","maskImage","totalAspectStr","maskPos","totalFadeDuration","pv","widthBeforeSelf","minOffset","clampOffset","timeOffset","lastPos","lastTime","pushFrame","moveOffset","staticTime","frame","lastTimeStamp","otherWord","curTimeStamp","staticDuration","fadeDuration","ani","beforeInSight","enableSpring","afterInSight","roundedBlur","ov","sub","LyricLineMouseEvent","lineIndex","DomLyricPlayer","computedStyles","lineEl","LyricLineEl","deltaS","WHITE_SPACE","LATIN","layoutWord","text","config","initialX","lastWhitespaceIndex","curLayoutIndex","shouldWhitespace","spaceMetrics","rest","wholeMetrics","prevChar","lastMetrics","lastMergedMetrics","metrics","layoutLine","currentLine","CanvasLyricLine","player","maxMainLineIndex","maxTranslatedLineIndex","maxRomanLineIndex","lctx","layout","targetBlur","CanvasLyricPlayer","computedStyle","realWidth","realHeight","emSize","debounce","cb","wait","args","mutexifyFunction","func","awaitingTasks","processNextTask","reason","_debugReason","newPromise","DomSlimLyricPlayer","innerWidth","innerHeight","curLineEl","curLineVisibility","playerTop","curLineHeight","scrollToPos"],"mappings":"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","x_google_ignoreList":[1,2,3,4,5,15,16,17,18,27]}